<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1 åˆ›å»ºå‹-å·¥å‚æ¨¡å¼ | é¢è¯•æŒ‡å—</title>
    <meta name="description" content="å‰ç«¯é¢è¯•æŒ‡å—ï¼Œå‰ç«¯é¢è¯•é¢˜æ•´ç†ï¼ŒæŒ‰æ¨¡å—åˆ†ç±»æ•´ç†æ€»ç»“ï¼Œæ‰“é€ æœ€å…¨é¢çš„å‰ç«¯é¢è¯•é¢˜">
    <link rel="icon" href="/logo.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
  <meta name="apple-mobile-web-app-status-bar-style">

    <link rel="preload" href="/assets/css/0.styles.9ad7bc48.css" as="style"><link rel="preload" href="/assets/js/app.f60bfc34.js" as="script"><link rel="preload" href="/assets/js/6.7f8a8777.js" as="script"><link rel="preload" href="/assets/js/3.9d86cf58.js" as="script"><link rel="preload" href="/assets/js/73.d56ee920.js" as="script"><link rel="preload" href="/assets/js/11.fb060006.js" as="script"><link rel="prefetch" href="/assets/js/1.9e1b498f.js"><link rel="prefetch" href="/assets/js/10.fbc04ea9.js"><link rel="prefetch" href="/assets/js/100.c06a0f53.js"><link rel="prefetch" href="/assets/js/101.54402ede.js"><link rel="prefetch" href="/assets/js/102.d3860a7d.js"><link rel="prefetch" href="/assets/js/103.51a83ab2.js"><link rel="prefetch" href="/assets/js/104.4107118f.js"><link rel="prefetch" href="/assets/js/105.aada2418.js"><link rel="prefetch" href="/assets/js/106.4ce7d3b7.js"><link rel="prefetch" href="/assets/js/107.ca87a327.js"><link rel="prefetch" href="/assets/js/108.df939701.js"><link rel="prefetch" href="/assets/js/109.9f0c8605.js"><link rel="prefetch" href="/assets/js/110.016c3eb7.js"><link rel="prefetch" href="/assets/js/111.ff5dbcc4.js"><link rel="prefetch" href="/assets/js/112.ab20caec.js"><link rel="prefetch" href="/assets/js/113.6c12e76f.js"><link rel="prefetch" href="/assets/js/114.48e1a019.js"><link rel="prefetch" href="/assets/js/115.f291caf1.js"><link rel="prefetch" href="/assets/js/116.0188d28e.js"><link rel="prefetch" href="/assets/js/117.9b579bae.js"><link rel="prefetch" href="/assets/js/118.89da516f.js"><link rel="prefetch" href="/assets/js/119.c70b5105.js"><link rel="prefetch" href="/assets/js/12.9774db85.js"><link rel="prefetch" href="/assets/js/120.fcf3186f.js"><link rel="prefetch" href="/assets/js/13.ac14541c.js"><link rel="prefetch" href="/assets/js/14.155007f0.js"><link rel="prefetch" href="/assets/js/15.2d9ec2b2.js"><link rel="prefetch" href="/assets/js/16.aec442e8.js"><link rel="prefetch" href="/assets/js/17.59c81a6b.js"><link rel="prefetch" href="/assets/js/18.c38ff446.js"><link rel="prefetch" href="/assets/js/19.8203bd99.js"><link rel="prefetch" href="/assets/js/20.103004c4.js"><link rel="prefetch" href="/assets/js/21.1e6e08c9.js"><link rel="prefetch" href="/assets/js/22.5abbfd40.js"><link rel="prefetch" href="/assets/js/23.4cd5fd4d.js"><link rel="prefetch" href="/assets/js/24.602403ee.js"><link rel="prefetch" href="/assets/js/25.da971f83.js"><link rel="prefetch" href="/assets/js/26.43589785.js"><link rel="prefetch" href="/assets/js/27.6d18f825.js"><link rel="prefetch" href="/assets/js/28.843b905f.js"><link rel="prefetch" href="/assets/js/29.81e33cc0.js"><link rel="prefetch" href="/assets/js/30.7a4491ed.js"><link rel="prefetch" href="/assets/js/31.4275e9d2.js"><link rel="prefetch" href="/assets/js/32.6e6c282b.js"><link rel="prefetch" href="/assets/js/33.35641348.js"><link rel="prefetch" href="/assets/js/34.7737e542.js"><link rel="prefetch" href="/assets/js/35.3d539e4d.js"><link rel="prefetch" href="/assets/js/36.78f70288.js"><link rel="prefetch" href="/assets/js/37.ed0997e2.js"><link rel="prefetch" href="/assets/js/38.6d35141d.js"><link rel="prefetch" href="/assets/js/39.3b4241bb.js"><link rel="prefetch" href="/assets/js/4.cda2fc13.js"><link rel="prefetch" href="/assets/js/40.dd7b6d84.js"><link rel="prefetch" href="/assets/js/41.05fcd6ed.js"><link rel="prefetch" href="/assets/js/42.24fc3ac4.js"><link rel="prefetch" href="/assets/js/43.27b59a40.js"><link rel="prefetch" href="/assets/js/44.ac552dd9.js"><link rel="prefetch" href="/assets/js/45.6b1e07c4.js"><link rel="prefetch" href="/assets/js/46.8bf4b340.js"><link rel="prefetch" href="/assets/js/47.57a13e6c.js"><link rel="prefetch" href="/assets/js/48.8ef881a7.js"><link rel="prefetch" href="/assets/js/49.b76df872.js"><link rel="prefetch" href="/assets/js/5.eb1f29dc.js"><link rel="prefetch" href="/assets/js/50.f04492e5.js"><link rel="prefetch" href="/assets/js/51.e000ebea.js"><link rel="prefetch" href="/assets/js/52.bfbd5e6e.js"><link rel="prefetch" href="/assets/js/53.fc0a60dd.js"><link rel="prefetch" href="/assets/js/54.a798cd42.js"><link rel="prefetch" href="/assets/js/55.5ccb6ae1.js"><link rel="prefetch" href="/assets/js/56.1605b000.js"><link rel="prefetch" href="/assets/js/57.79350f4e.js"><link rel="prefetch" href="/assets/js/58.dcff3859.js"><link rel="prefetch" href="/assets/js/59.a366020b.js"><link rel="prefetch" href="/assets/js/60.2c42a67f.js"><link rel="prefetch" href="/assets/js/61.4d471001.js"><link rel="prefetch" href="/assets/js/62.07f7a685.js"><link rel="prefetch" href="/assets/js/63.3774b497.js"><link rel="prefetch" href="/assets/js/64.d8437f45.js"><link rel="prefetch" href="/assets/js/65.eaf10ccb.js"><link rel="prefetch" href="/assets/js/66.74665605.js"><link rel="prefetch" href="/assets/js/67.072c35ca.js"><link rel="prefetch" href="/assets/js/68.764ab8cb.js"><link rel="prefetch" href="/assets/js/69.6a27592a.js"><link rel="prefetch" href="/assets/js/7.9a5c64fa.js"><link rel="prefetch" href="/assets/js/70.2e7f3527.js"><link rel="prefetch" href="/assets/js/71.c6365fbe.js"><link rel="prefetch" href="/assets/js/72.15cfe1be.js"><link rel="prefetch" href="/assets/js/74.f848ccac.js"><link rel="prefetch" href="/assets/js/75.905f5556.js"><link rel="prefetch" href="/assets/js/76.49d98a04.js"><link rel="prefetch" href="/assets/js/77.4b62003f.js"><link rel="prefetch" href="/assets/js/78.5a4046ff.js"><link rel="prefetch" href="/assets/js/79.eb3ec067.js"><link rel="prefetch" href="/assets/js/8.bccf8145.js"><link rel="prefetch" href="/assets/js/80.c8247597.js"><link rel="prefetch" href="/assets/js/81.69952221.js"><link rel="prefetch" href="/assets/js/82.4439fbe3.js"><link rel="prefetch" href="/assets/js/83.df1321d3.js"><link rel="prefetch" href="/assets/js/84.23d01b47.js"><link rel="prefetch" href="/assets/js/85.c983047a.js"><link rel="prefetch" href="/assets/js/86.29b0f2d4.js"><link rel="prefetch" href="/assets/js/87.12e2e192.js"><link rel="prefetch" href="/assets/js/88.fb19aa58.js"><link rel="prefetch" href="/assets/js/89.ee2be7d8.js"><link rel="prefetch" href="/assets/js/9.ce1180ae.js"><link rel="prefetch" href="/assets/js/90.479f4d9d.js"><link rel="prefetch" href="/assets/js/91.619e0c8d.js"><link rel="prefetch" href="/assets/js/92.ae858703.js"><link rel="prefetch" href="/assets/js/93.f90a7ae1.js"><link rel="prefetch" href="/assets/js/94.8894adb4.js"><link rel="prefetch" href="/assets/js/95.683396f3.js"><link rel="prefetch" href="/assets/js/96.f65dc164.js"><link rel="prefetch" href="/assets/js/97.75bd77e0.js"><link rel="prefetch" href="/assets/js/98.892b530a.js"><link rel="prefetch" href="/assets/js/99.7d033614.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9ad7bc48.css">
  function hasClass(obj, cls) {
	return obj.className.match(new RegExp('(\\s|^)' + cls + '(\\s|$)'));
}

function addClass(obj, cls) {
	if (!this.hasClass(obj, cls)) obj.className += " " + cls;
}

function removeClass(obj, cls) {
	if (hasClass(obj, cls)) {
		var reg = new RegExp('(\\s|^)' + cls + '(\\s|$)');
		obj.className = obj.className.replace(reg, ' ');
	}
}

function toggleClass(obj,cls){
	if(hasClass(obj,cls)){
		removeClass(obj, cls);
	}else{
		addClass(obj, cls);
	}
}
function openSlider() {
	let node = document.querySelector(".theme-container");
	toggleClass(node, 'sidebar-open')
}
</head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button" onclick="openSlider()"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active">   </a>  <div class="links" style="max-width: 1309px; background: rgb(255, 255, 255);"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value="" class="" placeholder=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div><a href="/docs/base.html" class="nav-link">åŸºç¡€ç¯‡
      </a></div></div><div class="nav-item"><div><a href="/docs/simply.html" class="nav-link">âœ¨è¿›é˜¶ç¯‡
      </a></div></div><div class="nav-item"><div><a href="/excellent-docs/1-HTMLæ¨¡å—.html" class="nav-link">ğŸ”¥ç²¾é€‰ç¯‡
      </a></div></div><div class="nav-item"><div><a href="/docs/handwritten.html" class="nav-link">æ‰‹å†™ç¯‡
      </a></div></div><div class="nav-item"><div><a href="/qa/1-å‰ç«¯100é¢˜è‡ªæ£€.html" class="nav-link">è‡ªæ£€ç¯‡
      </a></div></div><div class="nav-item"><div><a href="/docs/questions.html" class="nav-link">é—®é¢˜ç¯‡
      </a></div></div><div class="nav-item"><div><a href="/interview-exp/å‰ç«¯é¢ç»æ±‡æ€».html" class="nav-link">é¢ç»ç¯‡
      </a></div></div><div class="nav-item"><div><a href="/days/æ¯æ—¥ä¸€é¢˜.html" class="nav-link">æ¯æ—¥ä¸€é¢˜
      </a></div></div><div class="nav-item"><div><a href="/docs/design-pattern.html" class="nav-link router-link-exact-active router-link-active" aria-current="page">è®¾è®¡æ¨¡å¼
      </a></div></div><div class="nav-item"><div><a href="/principle-docs/comprehensive/01-è™šæ‹ŸDOMåŸç†åˆ†æ.html" class="nav-link">åŸç†ç¯‡
      </a></div></div><div class="nav-item"><div><a href="/docs/detail-expain.html" class="nav-link">ç»¼åˆ
      </a></div></div><div class="nav-item"><div><a href="/algorithm-interview/note/01-å¿«é€Ÿä¸Šæ‰‹â€”â€”ä»0åˆ°1æŒæ¡ç®—æ³•é¢è¯•éœ€è¦çš„æ•°æ®ç»“æ„ï¼ˆä¸€ï¼‰.html" class="nav-link">ç®—æ³•ç¯‡
      </a></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ‹“å±•é˜…è¯»" class="dropdown-title"><span class="title">æ‹“å±•é˜…è¯»</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display: none;"><li class="dropdown-item"><h4>ä¸“é¢˜</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-base-docs/compute-docs/Linux.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
        å‰ç«¯åŸºç¡€
        <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-mobile-docs/h5-docs/1-å¤§å‚ H5 å¼€å‘æ¦‚è¿°.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
        ç§»åŠ¨ç«¯
        <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-css-inspiration-docs/css-docs/note/01-æµè§ˆå™¨.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
        CSS
        <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-vue-docs/learn-vue-base/base/1-Vue CLI 3 é¡¹ç›®æ„å»ºåŸºç¡€.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
        Vue
        <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-react-docs/react-web-action/01-å‰ç«¯å¼€å‘çš„å››ä¸ªæ—¶ä»£.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
        React
        <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-engineering-docs/docs/npm-script.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
        å‰ç«¯å·¥ç¨‹
        <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-micro-docs/docs/01-å¾®å‰ç«¯çš„è¯ç”Ÿ.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
        å¾®å‰ç«¯
        <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-nodejs-docs/nodejs-docs/base/01-ç¯å¢ƒæ­å»º.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
        NodeæŒ‡å—
        <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-ts-axios-docs/ts-axios/chapter1/" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
        Typesctipt
        <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-algorithm-docs/algorithm/prepare/01-å¦‚ä½•ç³»ç»Ÿé«˜æ•ˆåœ°å­¦ä¹ æ•°æ®ç»“æ„ä¸ç®—æ³•.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
        æ•°æ®ç»“æ„ä¸ç®—æ³•
        <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></a></div></li></ul></li><li class="dropdown-item"><h4>å…¶ä»–</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-blog-docs/blog-docs/javascript/-Ajaxæ€»ç»“ç¯‡.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
        æ—¥å¸¸ç§¯ç´¯
        <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></a></div></li><li class="dropdown-subitem"><div><a href="http://blog.poetries.top/archives/" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
        åšå®¢æ–‡ç« 
        <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></a></div></li><li class="dropdown-subitem"><div><a href="https://blog.poetries.top/css-reference" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
        CSSå¯è§†åŒ–
        <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></a></div></li></ul></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->   <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>ç²¾é€‰æ¨¡å—</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/excellent-docs/1-HTMLæ¨¡å—.html" class="sidebar-link">1 HTMLæ¨¡å—</a></li><li><a href="/excellent-docs/2-CSSæ¨¡å—.html" class="sidebar-link">2 CSSæ¨¡å—</a></li><li><a href="/excellent-docs/3-JSæ¨¡å—.html" class="sidebar-link">3 JSæ¨¡å—</a></li><li><a href="/excellent-docs/4-ES6æ¨¡å—.html" class="sidebar-link">4 ES6æ¨¡å—</a></li><li><a href="/excellent-docs/5-æµè§ˆå™¨æ¨¡å—.html" class="sidebar-link">5 æµè§ˆå™¨æ¨¡å—</a></li><li><a href="/excellent-docs/6-React.html" class="sidebar-link">6 Reactæ¨¡å—</a></li><li><a href="/excellent-docs/7-Vue.html" class="sidebar-link">7 Vueæ¨¡å—</a></li><li><a href="/excellent-docs/8-Nodeæ¨¡å—.html" class="sidebar-link">8 Nodeæ¨¡å—</a></li><li><a href="/excellent-docs/9-å‰ç«¯å·¥ç¨‹æ¨¡å—.html" class="sidebar-link">9 å‰ç«¯å·¥ç¨‹ç›¸å…³</a></li><li><a href="/excellent-docs/10-ç§»åŠ¨å¤šç«¯å¼€å‘.html" class="sidebar-link">10 ç§»åŠ¨å¤šç«¯å¼€å‘</a></li><li><a href="/excellent-docs/11-å°ç¨‹åºæ¨¡å—.html" class="sidebar-link">11 å°ç¨‹åºæ¨¡å—</a></li><li><a href="/excellent-docs/12-å‰ç«¯å®‰å…¨æ¨¡å—.html" class="sidebar-link">12 å‰ç«¯å®‰å…¨æ¨¡å—</a></li><li><a href="/excellent-docs/13-æ€§èƒ½ä¼˜åŒ–æ¨¡å—.html" class="sidebar-link">13 æ€§èƒ½ä¼˜åŒ–ç›¸å…³</a></li><li><a href="/excellent-docs/14-HTTPæ¨¡å—.html" class="sidebar-link">14 HTTPæ¨¡å—</a></li><li><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html" class="active sidebar-link">15 å¸¸ç”¨è®¾è®¡æ¨¡å¼</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_1-åˆ›å»ºå‹-å·¥å‚æ¨¡å¼" class="sidebar-link">1 åˆ›å»ºå‹-å·¥å‚æ¨¡å¼</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_1-1-ç®€å•å·¥å‚æ¨¡å¼" class="sidebar-link">1.1 ç®€å•å·¥å‚æ¨¡å¼</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_1-2-æŠ½è±¡å·¥å‚æ¨¡å¼" class="sidebar-link">1.2 æŠ½è±¡å·¥å‚æ¨¡å¼</a></li></ul></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_2-åˆ›å»ºå‹-å•ä¾‹æ¨¡å¼" class="sidebar-link">2 åˆ›å»ºå‹-å•ä¾‹æ¨¡å¼</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_2-1-å•ä¾‹æ¨¡å¼çš„å®ç°æ€è·¯" class="sidebar-link">2.1 å•ä¾‹æ¨¡å¼çš„å®ç°æ€è·¯</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_2-2-ç”Ÿäº§å®è·µï¼švuexä¸­çš„å•ä¾‹æ¨¡å¼" class="sidebar-link">2.2 ç”Ÿäº§å®è·µï¼šVuexä¸­çš„å•ä¾‹æ¨¡å¼</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_2-3-å•ä¾‹æ¨¡å¼â€”â€”é¢è¯•çœŸé¢˜" class="sidebar-link">2.3 å•ä¾‹æ¨¡å¼â€”â€”é¢è¯•çœŸé¢˜</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_2-4-å®ç°ä¸€ä¸ªå…¨å±€çš„æ¨¡æ€æ¡†" class="sidebar-link">2.4 å®ç°ä¸€ä¸ªå…¨å±€çš„æ¨¡æ€æ¡†</a></li></ul></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_3-ç»“æ„å‹-è£…é¥°å™¨æ¨¡å¼" class="sidebar-link">3 ç»“æ„å‹-è£…é¥°å™¨æ¨¡å¼</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_3-1-è£…é¥°å™¨æ¨¡å¼åˆç›¸è§" class="sidebar-link">3.1 è£…é¥°å™¨æ¨¡å¼åˆç›¸è§</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_3-2-æ·±å…¥è£…é¥°å™¨åŸç†" class="sidebar-link">3.2 æ·±å…¥è£…é¥°å™¨åŸç†</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_3-3-è£…é¥°å™¨è¯­æ³•ç³–èƒŒåçš„æ•…äº‹" class="sidebar-link">3.3 è£…é¥°å™¨è¯­æ³•ç³–èƒŒåçš„æ•…äº‹</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_3-4-å°†â€œå±æ€§æè¿°å¯¹è±¡â€äº¤åˆ°ä½ æ‰‹é‡Œ" class="sidebar-link">3.4 å°†â€œå±æ€§æè¿°å¯¹è±¡â€äº¤åˆ°ä½ æ‰‹é‡Œ</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_3-5-reactä¸­çš„è£…é¥°å™¨ï¼šhoc" class="sidebar-link">3.5 Reactä¸­çš„è£…é¥°å™¨ï¼šHOC</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_3-6-ä½¿ç”¨è£…é¥°å™¨æ”¹å†™-redux-connect" class="sidebar-link">3.6 ä½¿ç”¨è£…é¥°å™¨æ”¹å†™ Redux connect</a></li></ul></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_4-ç»“æ„å‹-é€‚é…å™¨æ¨¡å¼" class="sidebar-link">4 ç»“æ„å‹-é€‚é…å™¨æ¨¡å¼</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_4-1-å…¼å®¹æ¥å£" class="sidebar-link">4.1 å…¼å®¹æ¥å£</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_4-2-ç”Ÿäº§å®è·µï¼šaxiosä¸­çš„é€‚é…å™¨" class="sidebar-link">4.2 ç”Ÿäº§å®è·µï¼šaxiosä¸­çš„é€‚é…å™¨</a></li></ul></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_5-ç»“æ„å‹-ä»£ç†æ¨¡å¼" class="sidebar-link">5 ç»“æ„å‹-ä»£ç†æ¨¡å¼</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_5-1-es6ä¸­çš„proxy" class="sidebar-link">5.1 ES6ä¸­çš„Proxy</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_5-2-â€œå©šä»‹æ‰€â€çš„å®ç°" class="sidebar-link">5.2 â€œå©šä»‹æ‰€â€çš„å®ç°</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_5-3-äº‹ä»¶ä»£ç†" class="sidebar-link">5.3 äº‹ä»¶ä»£ç†</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_5-4-è™šæ‹Ÿä»£ç†" class="sidebar-link">5.4 è™šæ‹Ÿä»£ç†</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_5-5-ç¼“å­˜ä»£ç†" class="sidebar-link">5.5 ç¼“å­˜ä»£ç†</a></li></ul></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_6-è¡Œä¸ºå‹-ç­–ç•¥æ¨¡å¼" class="sidebar-link">6 è¡Œä¸ºå‹-ç­–ç•¥æ¨¡å¼</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_6-1-å…ˆæ¥çœ‹ä¸€ä¸ªçœŸå®åœºæ™¯" class="sidebar-link">6.1 å…ˆæ¥çœ‹ä¸€ä¸ªçœŸå®åœºæ™¯</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_6-2-if-else-ä¾ ï¼Œäººäººå–Šæ‰“" class="sidebar-link">6.2 if-else ä¾ ï¼Œäººäººå–Šæ‰“</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_6-3-é‡æ„è¯¢ä»·é€»è¾‘" class="sidebar-link">6.3 é‡æ„è¯¢ä»·é€»è¾‘</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_6-4-æ€»ç»“" class="sidebar-link">6.4 æ€»ç»“</a></li></ul></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_7-è¡Œä¸ºå‹-çŠ¶æ€æ¨¡å¼" class="sidebar-link">7 è¡Œä¸ºå‹-çŠ¶æ€æ¨¡å¼</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_7-1-ä¸€å°å’–å•¡æœºçš„è¯ç”Ÿ" class="sidebar-link">7.1 ä¸€å°å’–å•¡æœºçš„è¯ç”Ÿ</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_7-2-æ”¹é€ å’–å•¡æœºçš„çŠ¶æ€åˆ‡æ¢æœºåˆ¶" class="sidebar-link">7.2 æ”¹é€ å’–å•¡æœºçš„çŠ¶æ€åˆ‡æ¢æœºåˆ¶</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_7-3-å¼€æ”¾å°é—­" class="sidebar-link">7.3 å¼€æ”¾å°é—­</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_7-4-è¿›ä¸€æ­¥æ”¹é€ " class="sidebar-link">7.4 è¿›ä¸€æ­¥æ”¹é€ </a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_7-5-çŠ¶æ€æ¨¡å¼å¤ç›˜" class="sidebar-link">7.5 çŠ¶æ€æ¨¡å¼å¤ç›˜</a></li></ul></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_8-è¡Œä¸ºå‹-è§‚å¯Ÿè€…æ¨¡å¼" class="sidebar-link">8 è¡Œä¸ºå‹-è§‚å¯Ÿè€…æ¨¡å¼</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_8-1-ç”Ÿæ´»ä¸­çš„è§‚å¯Ÿè€…æ¨¡å¼" class="sidebar-link">8.1 ç”Ÿæ´»ä¸­çš„è§‚å¯Ÿè€…æ¨¡å¼</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_8-2-åœ¨å®è·µä¸­ç†è§£å®šä¹‰" class="sidebar-link">8.2 åœ¨å®è·µä¸­ç†è§£å®šä¹‰</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_8-3-vueæ•°æ®åŒå‘ç»‘å®šï¼ˆå“åº”å¼ç³»ç»Ÿï¼‰çš„å®ç°åŸç†" class="sidebar-link">8.3 Vueæ•°æ®åŒå‘ç»‘å®šï¼ˆå“åº”å¼ç³»ç»Ÿï¼‰çš„å®ç°åŸç†</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_8-4-å®ç°ä¸€ä¸ªevent-bus-event-emitter" class="sidebar-link">8.4 å®ç°ä¸€ä¸ªEvent Bus / Event Emitter</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_8-5-è§‚å¯Ÿè€…æ¨¡å¼ä¸å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="sidebar-link">8.5 è§‚å¯Ÿè€…æ¨¡å¼ä¸å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</a></li></ul></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_9-è¡Œä¸ºå‹-è¿­ä»£å™¨æ¨¡å¼" class="sidebar-link">9 è¡Œä¸ºå‹-è¿­ä»£å™¨æ¨¡å¼</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_9-1-â€œå…¬å…ƒå‰â€çš„è¿­ä»£å™¨æ¨¡å¼" class="sidebar-link">9.1 â€œå…¬å…ƒå‰â€çš„è¿­ä»£å™¨æ¨¡å¼</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_9-2-es6å¯¹è¿­ä»£å™¨çš„å®ç°" class="sidebar-link">9.2 ES6å¯¹è¿­ä»£å™¨çš„å®ç°</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_9-3-å®ç°ä¸€ä¸ªè¿­ä»£å™¨ç”Ÿæˆå‡½æ•°" class="sidebar-link">9.3 å®ç°ä¸€ä¸ªè¿­ä»£å™¨ç”Ÿæˆå‡½æ•°</a></li></ul></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_10-ä¸­ä»‹è€…æ¨¡å¼" class="sidebar-link">10 ä¸­ä»‹è€…æ¨¡å¼</a></li><li class="sidebar-sub-header"><a href="/excellent-docs/15-è®¾è®¡æ¨¡å¼.html#_11-äº«å…ƒæ¨¡å¼" class="sidebar-link">11 äº«å…ƒæ¨¡å¼</a></li></ul></li><li><a href="/excellent-docs/16-æ¡†æ¶é€šè¯†.html" class="sidebar-link">16 æ¡†æ¶é€šè¯†</a></li><li><a href="/excellent-docs/17-æ’åºç®—æ³•.html" class="sidebar-link">17 æ’åºç®—æ³•</a></li><li><a href="/excellent-docs/18-è®¡ç®—æœºé€šè¯†.html" class="sidebar-link">18 è®¡ç®—æœºé€šè¯†</a></li></ul></section></li></ul> </aside> <main class="page"> <div id="container" class="theme-default-content"><div class="content__default"><h2 id="_1-åˆ›å»ºå‹-å·¥å‚æ¨¡å¼"><a href="#_1-åˆ›å»ºå‹-å·¥å‚æ¨¡å¼" class="header-anchor">#</a> 1 åˆ›å»ºå‹-å·¥å‚æ¨¡å¼</h2> <h3 id="_1-1-ç®€å•å·¥å‚æ¨¡å¼"><a href="#_1-1-ç®€å•å·¥å‚æ¨¡å¼" class="header-anchor">#</a> 1.1 ç®€å•å·¥å‚æ¨¡å¼</h3> <blockquote><p>å…¶å®å°±æ˜¯<strong>å°†åˆ›å»ºå¯¹è±¡çš„è¿‡ç¨‹å•ç‹¬å°è£…</strong>ï¼ŒåŒæ—¶å®ƒçš„åº”ç”¨åœºæ™¯ä¹Ÿéå¸¸å®¹æ˜“è¯†åˆ«ï¼šæœ‰æ„é€ å‡½æ•°çš„åœ°æ–¹ï¼Œæˆ‘ä»¬å°±åº”è¯¥æƒ³åˆ°ç®€å•å·¥å‚ï¼›åœ¨å†™äº†å¤§é‡æ„é€ å‡½æ•°ã€è°ƒç”¨äº†å¤§é‡çš„ newã€è‡ªè§‰éå¸¸ä¸çˆ½çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±åº”è¯¥æ€è€ƒæ˜¯ä¸æ˜¯å¯ä»¥æå‡ºå·¥å‚æ¨¡å¼é‡æ„æˆ‘ä»¬çš„ä»£ç äº†</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ç»™ä¸åŒå·¥ç§åˆ†é…èŒè´£è¯´æ˜</span>
<span class="token keyword">function</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> career<span class="token punctuation">,</span> work</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>career <span class="token operator">=</span> career<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>work <span class="token operator">=</span> work<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Factory</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> career</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> work<span class="token punctuation">;</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>career<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">'coder'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            work <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'å†™ä»£ç '</span><span class="token punctuation">,</span> <span class="token string">'å†™ç³»åˆ†'</span><span class="token punctuation">,</span> <span class="token string">'ä¿®bug'</span><span class="token punctuation">]</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">case</span> <span class="token string">'product-manager'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            work <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'è®¢ä¼šè®®å®¤'</span><span class="token punctuation">,</span> <span class="token string">'å†™PRD'</span><span class="token punctuation">,</span> <span class="token string">'å‚¬æ›´'</span><span class="token punctuation">]</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">case</span> <span class="token string">'boss'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            work <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'å–èŒ¶'</span><span class="token punctuation">,</span> <span class="token string">'çœ‹æŠ¥'</span><span class="token punctuation">,</span> <span class="token string">'è§å®¢æˆ·'</span><span class="token punctuation">]</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> career<span class="token punctuation">,</span> work<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> wang <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Factory</span><span class="token punctuation">(</span><span class="token string">'wang'</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">'boss'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> sun <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Factory</span><span class="token punctuation">(</span><span class="token string">'sun'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">'coder'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> li <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Factory</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">'product-manager'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>wang<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sun<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>li<span class="token punctuation">)</span>
</code></pre></div><h3 id="_1-2-æŠ½è±¡å·¥å‚æ¨¡å¼"><a href="#_1-2-æŠ½è±¡å·¥å‚æ¨¡å¼" class="header-anchor">#</a> 1.2 æŠ½è±¡å·¥å‚æ¨¡å¼</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å®šä¹‰æ“ä½œç³»ç»Ÿè¿™ç±»äº§å“çš„æŠ½è±¡äº§å“ç±»</span>
<span class="token keyword">class</span> <span class="token class-name">OS</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">new</span><span class="token punctuation">.</span>target <span class="token operator">===</span> <span class="token constant">OS</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'ä¸èƒ½å®ä¾‹åŒ–æŠ½è±¡ç±»'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// å®šä¹‰å…·ä½“æ“ä½œç³»ç»Ÿçš„å…·ä½“äº§å“ç±»</span>
<span class="token keyword">class</span> <span class="token class-name">AndroidOS</span> <span class="token keyword">extends</span> <span class="token class-name">OS</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">controlHardware</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æˆ‘ä¼šç”¨å®‰å“çš„æ–¹å¼å»æ“ä½œç¡¬ä»¶'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">AppleOS</span> <span class="token keyword">extends</span> <span class="token class-name">OS</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">controlHardware</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æˆ‘ä¼šç”¨è‹¹æœçš„æ–¹å¼å»æ“ä½œç¡¬ä»¶'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// å®šä¹‰æ‰‹æœºç¡¬ä»¶è¿™ç±»äº§å“çš„æŠ½è±¡äº§å“ç±»</span>
<span class="token keyword">class</span> <span class="token class-name">Hardware</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">new</span><span class="token punctuation">.</span>target <span class="token operator">===</span> Hardware<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'ä¸èƒ½å®ä¾‹åŒ–æŠ½è±¡ç±»'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// æ‰‹æœºç¡¬ä»¶çš„å…±æ€§æ–¹æ³•ï¼Œè¿™é‡Œæå–äº†â€œæ ¹æ®å‘½ä»¤è¿è½¬â€è¿™ä¸ªå…±æ€§</span>
    <span class="token function">operateByOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'æŠ½è±¡äº§å“æ–¹æ³•ä¸å…è®¸ç›´æ¥è°ƒç”¨ï¼Œä½ éœ€è¦å°†æˆ‘é‡å†™ï¼'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// å®šä¹‰å…·ä½“ç¡¬ä»¶çš„å…·ä½“äº§å“ç±»</span>
<span class="token keyword">class</span> <span class="token class-name">QualcommHardware</span> <span class="token keyword">extends</span> <span class="token class-name">Hardware</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">operateByOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æˆ‘ä¼šç”¨é«˜é€šçš„æ–¹å¼å»è¿è½¬'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">MiWare</span> <span class="token keyword">extends</span> <span class="token class-name">Hardware</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">operateByOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æˆ‘ä¼šç”¨å°ç±³çš„æ–¹å¼å»è¿è½¬'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">MobilePhoneFactory</span> <span class="token punctuation">{</span>
    <span class="token comment">// æä¾›æ“ä½œç³»ç»Ÿçš„æ¥å£</span>
    <span class="token function">createOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;æŠ½è±¡å·¥å‚æ–¹æ³•ä¸å…è®¸ç›´æ¥è°ƒç”¨ï¼Œä½ éœ€è¦å°†æˆ‘é‡å†™ï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// æä¾›ç¡¬ä»¶çš„æ¥å£</span>
    <span class="token function">createHardware</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;æŠ½è±¡å·¥å‚æ–¹æ³•ä¸å…è®¸ç›´æ¥è°ƒç”¨ï¼Œä½ éœ€è¦å°†æˆ‘é‡å†™ï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// å…·ä½“å·¥å‚ç»§æ‰¿è‡ªæŠ½è±¡å·¥å‚</span>
<span class="token keyword">class</span> <span class="token class-name">FakeStarFactory</span> <span class="token keyword">extends</span> <span class="token class-name">MobilePhoneFactory</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token function">createOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// æä¾›å®‰å“ç³»ç»Ÿå®ä¾‹</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">AndroidOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token function">createHardware</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// æä¾›é«˜é€šç¡¬ä»¶å®ä¾‹</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">QualcommHardware</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// è¿™æ˜¯æˆ‘çš„æ‰‹æœº</span>
<span class="token keyword">const</span> myPhone <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FakeStarFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// è®©å®ƒæ‹¥æœ‰æ“ä½œç³»ç»Ÿ</span>
<span class="token keyword">const</span> myOS <span class="token operator">=</span> myPhone<span class="token punctuation">.</span><span class="token function">createOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// è®©å®ƒæ‹¥æœ‰ç¡¬ä»¶</span>
<span class="token keyword">const</span> myHardWare <span class="token operator">=</span> myPhone<span class="token punctuation">.</span><span class="token function">createHardware</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// å¯åŠ¨æ“ä½œç³»ç»Ÿ(è¾“å‡ºâ€˜æˆ‘ä¼šç”¨å®‰å“çš„æ–¹å¼å»æ“ä½œç¡¬ä»¶â€™)</span>
myOS<span class="token punctuation">.</span><span class="token function">controlHardware</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// å”¤é†’ç¡¬ä»¶(è¾“å‡ºâ€˜æˆ‘ä¼šç”¨é«˜é€šçš„æ–¹å¼å»è¿è½¬â€™)</span>
myHardWare<span class="token punctuation">.</span><span class="token function">operateByOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>æŠ½è±¡å·¥å‚å’Œç®€å•å·¥å‚çš„æ€è·¯ï¼Œæ€è€ƒä¸€ä¸‹ï¼šå®ƒä»¬ä¹‹é—´æœ‰å“ªäº›å¼‚åŒï¼Ÿ</strong></p> <ul><li>å®ƒä»¬çš„å…±åŒç‚¹ï¼Œåœ¨äºéƒ½<strong>å°è¯•å»åˆ†ç¦»ä¸€ä¸ªç³»ç»Ÿä¸­å˜ä¸ä¸å˜çš„éƒ¨åˆ†</strong>ã€‚</li> <li>å®ƒä»¬çš„ä¸åŒåœ¨äº<strong>åœºæ™¯çš„å¤æ‚åº¦</strong>ã€‚</li></ul> <blockquote><p>åœ¨ç®€å•å·¥å‚çš„ä½¿ç”¨åœºæ™¯é‡Œï¼Œå¤„ç†çš„å¯¹è±¡æ˜¯ç±»ï¼Œå¹¶ä¸”æ˜¯ä¸€äº›éå¸¸å¥½å¯¹ä»˜çš„ç±»â€”â€”å®ƒä»¬çš„å…±æ€§å®¹æ˜“æŠ½ç¦»ï¼ŒåŒæ—¶å› ä¸ºé€»è¾‘æœ¬èº«æ¯”è¾ƒç®€å•ï¼Œæ•…è€Œä¸è‹›æ±‚ä»£ç å¯æ‰©å±•æ€§ã€‚æŠ½è±¡å·¥å‚æœ¬è´¨ä¸Šå¤„ç†çš„å…¶å®ä¹Ÿæ˜¯ç±»ï¼Œä½†æ˜¯æ˜¯ä¸€å¸®éå¸¸æ£˜æ‰‹ã€ç¹æ‚çš„ç±»ï¼Œè¿™äº›ç±»ä¸­ä¸ä»…èƒ½åˆ’åˆ†å‡ºé—¨æ´¾ï¼Œè¿˜èƒ½åˆ’åˆ†å‡ºç­‰çº§ï¼ŒåŒæ—¶å­˜åœ¨ç€åƒå˜ä¸‡åŒ–çš„æ‰©å±•å¯èƒ½æ€§â€”â€”è¿™ä½¿å¾—æˆ‘ä»¬å¿…é¡»å¯¹<strong>å…±æ€§</strong>ä½œæ›´ç‰¹åˆ«çš„å¤„ç†ã€ä½¿ç”¨æŠ½è±¡ç±»å»é™ä½æ‰©å±•çš„æˆæœ¬ï¼ŒåŒæ—¶éœ€è¦å¯¹ç±»çš„æ€§è´¨ä½œåˆ’åˆ†</p></blockquote> <h2 id="_2-åˆ›å»ºå‹-å•ä¾‹æ¨¡å¼"><a href="#_2-åˆ›å»ºå‹-å•ä¾‹æ¨¡å¼" class="header-anchor">#</a> 2 åˆ›å»ºå‹-å•ä¾‹æ¨¡å¼</h2> <blockquote><p><strong>ä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹</strong>ï¼Œè¿™æ ·çš„æ¨¡å¼å°±å«åšå•ä¾‹æ¨¡å¼ã€‚</p></blockquote> <h3 id="_2-1-å•ä¾‹æ¨¡å¼çš„å®ç°æ€è·¯"><a href="#_2-1-å•ä¾‹æ¨¡å¼çš„å®ç°æ€è·¯" class="header-anchor">#</a> 2.1 å•ä¾‹æ¨¡å¼çš„å®ç°æ€è·¯</h3> <ul><li>å•ä¾‹æ¨¡å¼æƒ³è¦åšåˆ°çš„æ˜¯ï¼Œ<strong>ä¸ç®¡æˆ‘ä»¬å°è¯•å»åˆ›å»ºå¤šå°‘æ¬¡ï¼Œå®ƒéƒ½åªç»™ä½ è¿”å›ç¬¬ä¸€æ¬¡æ‰€åˆ›å»ºçš„é‚£å”¯ä¸€çš„ä¸€ä¸ªå®ä¾‹</strong>ã€‚</li> <li>è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œå°±éœ€è¦æ„é€ å‡½æ•°<strong>å…·å¤‡åˆ¤æ–­è‡ªå·±æ˜¯å¦å·²ç»åˆ›å»ºè¿‡ä¸€ä¸ªå®ä¾‹</strong>çš„èƒ½åŠ›ã€‚æˆ‘ä»¬ç°åœ¨æŠŠè¿™æ®µåˆ¤æ–­é€»è¾‘å†™æˆä¸€ä¸ªé™æ€æ–¹æ³•(å…¶å®ä¹Ÿå¯ä»¥ç›´æ¥å†™å…¥æ„é€ å‡½æ•°çš„å‡½æ•°ä½“é‡Œï¼‰ï¼š</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å®šä¹‰ï¼šä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹ã€‚</span>
<span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>instance <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>instance<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>instance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> singleton <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> a <span class="token operator">=</span> singleton<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> b <span class="token operator">=</span> singleton<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a <span class="token operator">===</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">SingleDog</span> <span class="token punctuation">{</span>
    <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æˆ‘æ˜¯ä¸€ä¸ªå•ä¾‹å¯¹è±¡'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">static</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// åˆ¤æ–­æ˜¯å¦å·²ç»newè¿‡1ä¸ªå®ä¾‹</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>SingleDog<span class="token punctuation">.</span>instance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// è‹¥è¿™ä¸ªå”¯ä¸€çš„å®ä¾‹ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå…ˆåˆ›å»ºå®ƒ</span>
            SingleDog<span class="token punctuation">.</span>instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingleDog</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// å¦‚æœè¿™ä¸ªå”¯ä¸€çš„å®ä¾‹å·²ç»å­˜åœ¨ï¼Œåˆ™ç›´æ¥è¿”å›</span>
        <span class="token keyword">return</span> SingleDog<span class="token punctuation">.</span>instance
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> s1 <span class="token operator">=</span> SingleDog<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> s2 <span class="token operator">=</span> SingleDog<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// true</span>
s1 <span class="token operator">===</span> s2
</code></pre></div><p>é™¤äº†æ¥¼ä¸Šè¿™ç§å®ç°æ–¹å¼ä¹‹å¤–ï¼Œ<code>getInstance</code>çš„é€»è¾‘è¿˜å¯ä»¥ç”¨<strong>é—­åŒ…</strong>æ¥å®ç°ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>SingleDog<span class="token punctuation">.</span>getInstance <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å®šä¹‰è‡ªç”±å˜é‡instanceï¼Œæ¨¡æ‹Ÿç§æœ‰å˜é‡</span>
    <span class="token keyword">let</span> instance <span class="token operator">=</span> <span class="token keyword">null</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// åˆ¤æ–­è‡ªç”±å˜é‡æ˜¯å¦ä¸ºnull</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>instance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// å¦‚æœä¸ºnullåˆ™newå‡ºå”¯ä¸€å®ä¾‹</span>
            instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingleDog</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> instance
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div><blockquote><p>å¯ä»¥çœ‹å‡ºï¼Œåœ¨<code>getInstance</code>æ–¹æ³•çš„åˆ¤æ–­å’Œæ‹¦æˆªä¸‹ï¼Œæˆ‘ä»¬ä¸ç®¡è°ƒç”¨å¤šå°‘æ¬¡ï¼Œ<code>SingleDog</code>éƒ½åªä¼šç»™æˆ‘ä»¬è¿”å›ä¸€ä¸ªå®ä¾‹ï¼Œ<code>s1</code>å’Œ<code>s2</code>ç°åœ¨éƒ½æŒ‡å‘è¿™ä¸ªå”¯ä¸€çš„å®ä¾‹</p></blockquote> <h3 id="_2-2-ç”Ÿäº§å®è·µï¼švuexä¸­çš„å•ä¾‹æ¨¡å¼"><a href="#_2-2-ç”Ÿäº§å®è·µï¼švuexä¸­çš„å•ä¾‹æ¨¡å¼" class="header-anchor">#</a> 2.2 ç”Ÿäº§å®è·µï¼šVuexä¸­çš„å•ä¾‹æ¨¡å¼</h3> <blockquote><p><code>Redux</code> å’Œ <code>Vuex</code>ï¼Œå®ƒä»¬éƒ½å®ç°äº†ä¸€ä¸ªå…¨å±€çš„ <code>Store</code> ç”¨äºå­˜å‚¨åº”ç”¨çš„æ‰€æœ‰çŠ¶æ€ã€‚è¿™ä¸ª <code>Store</code> çš„å®ç°ï¼Œæ­£æ˜¯å•ä¾‹æ¨¡å¼çš„å…¸å‹åº”ç”¨</p></blockquote> <p><strong>1. ç†è§£ Vuex ä¸­çš„ Store</strong></p> <blockquote><p><code>Vuex</code> ä½¿ç”¨å•ä¸€çŠ¶æ€æ ‘ï¼Œç”¨ä¸€ä¸ªå¯¹è±¡å°±åŒ…å«äº†å…¨éƒ¨çš„åº”ç”¨å±‚çº§çŠ¶æ€ã€‚è‡³æ­¤å®ƒä¾¿ä½œä¸ºä¸€ä¸ªâ€œå”¯ä¸€æ•°æ®æº (SSOT)â€è€Œå­˜åœ¨ã€‚è¿™ä¹Ÿæ„å‘³ç€ï¼Œæ¯ä¸ªåº”ç”¨å°†ä»…ä»…åŒ…å«ä¸€ä¸ª store å®ä¾‹ã€‚å•ä¸€çŠ¶æ€æ ‘è®©æˆ‘ä»¬èƒ½å¤Ÿç›´æ¥åœ°å®šä½ä»»ä¸€ç‰¹å®šçš„çŠ¶æ€ç‰‡æ®µï¼Œåœ¨è°ƒè¯•çš„è¿‡ç¨‹ä¸­ä¹Ÿèƒ½è½»æ˜“åœ°å–å¾—æ•´ä¸ªå½“å‰åº”ç”¨çŠ¶æ€çš„å¿«ç…§ã€‚ â€”â€”Vuexå®˜æ–¹æ–‡æ¡£</p></blockquote> <p>å½“ç»„ä»¶éå¸¸å¤šã€ç»„ä»¶é—´å…³ç³»å¤æ‚ã€ä¸”åµŒå¥—å±‚çº§å¾ˆæ·±çš„æ—¶å€™ï¼Œè¿™ç§åŸå§‹çš„é€šä¿¡æ–¹å¼ä¼šä½¿æˆ‘ä»¬çš„é€»è¾‘å˜å¾—å¤æ‚éš¾ä»¥ç»´æŠ¤ã€‚è¿™æ—¶æœ€å¥½çš„åšæ³•æ˜¯å°†å…±äº«çš„æ•°æ®æŠ½å‡ºæ¥ã€æ”¾åœ¨å…¨å±€ï¼Œä¾›ç»„ä»¶ä»¬æŒ‰ç…§ä¸€å®šçš„çš„è§„åˆ™å»å­˜å–æ•°æ®ï¼Œä¿è¯çŠ¶æ€ä»¥ä¸€ç§å¯é¢„æµ‹çš„æ–¹å¼å‘ç”Ÿå˜åŒ–ã€‚äºæ˜¯ä¾¿æœ‰äº† Vuexï¼Œè¿™ä¸ªç”¨æ¥å­˜æ”¾å…±äº«æ•°æ®çš„å”¯ä¸€æ•°æ®æºï¼Œå°±æ˜¯ Storeã€‚</p> <p><strong>2. Vuexå¦‚ä½•ç¡®ä¿Storeçš„å”¯ä¸€æ€§</strong></p> <p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å¦‚ä½•åœ¨é¡¹ç›®ä¸­å¼•å…¥ <code>Vuex</code>ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å®‰è£…vuexæ’ä»¶</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Vuex<span class="token punctuation">)</span>

<span class="token comment">// å°†storeæ³¨å…¥åˆ°Vueå®ä¾‹ä¸­</span>
<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    el<span class="token punctuation">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
    store
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>é€šè¿‡è°ƒç”¨<code>Vue.use()</code>æ–¹æ³•ï¼Œæˆ‘ä»¬å®‰è£…äº† <code>Vuex</code> æ’ä»¶ã€‚<code>Vuex</code> æ’ä»¶æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒåœ¨å†…éƒ¨å®ç°äº†ä¸€ä¸ª <code>install</code> æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šåœ¨æ’ä»¶å®‰è£…æ—¶è¢«è°ƒç”¨ï¼Œä»è€ŒæŠŠ <code>Store</code> æ³¨å…¥åˆ°<code>Vue</code>å®ä¾‹é‡Œå»ã€‚ä¹Ÿå°±æ˜¯è¯´æ¯ <code>install</code> ä¸€æ¬¡ï¼Œéƒ½ä¼šå°è¯•ç»™ <code>Vue</code> å®ä¾‹æ³¨å…¥ä¸€ä¸ª <code>Store</code></p></blockquote> <p>åœ¨<code>install</code>æ–¹æ³•é‡Œï¼Œæœ‰ä¸€æ®µé€»è¾‘å’Œæˆ‘ä»¬æ¥¼ä¸Šçš„ <code>getInstance</code> éå¸¸ç›¸ä¼¼çš„é€»è¾‘ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> Vue <span class="token comment">// è¿™ä¸ªVueçš„ä½œç”¨å’Œæ¥¼ä¸Šçš„instanceä½œç”¨ä¸€æ ·</span>
<span class="token operator">...</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">install</span> <span class="token punctuation">(</span><span class="token parameter">_Vue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// åˆ¤æ–­ä¼ å…¥çš„Vueå®ä¾‹å¯¹è±¡æ˜¯å¦å·²ç»è¢«installè¿‡Vuexæ’ä»¶ï¼ˆæ˜¯å¦æœ‰äº†å”¯ä¸€çš„stateï¼‰</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>Vue <span class="token operator">&amp;&amp;</span> _Vue <span class="token operator">===</span> Vue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>
        <span class="token string">'[vuex] already installed. Vue.use(Vuex) should be called only once.'</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// è‹¥æ²¡æœ‰ï¼Œåˆ™ä¸ºè¿™ä¸ªVueå®ä¾‹å¯¹è±¡installä¸€ä¸ªå”¯ä¸€çš„Vuex</span>
  Vue <span class="token operator">=</span> _Vue
  <span class="token comment">// å°†Vuexçš„åˆå§‹åŒ–é€»è¾‘å†™è¿›Vueçš„é’©å­å‡½æ•°é‡Œ</span>
  <span class="token function">applyMixin</span><span class="token punctuation">(</span>Vue<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>æ¥¼ä¸Šä¾¿æ˜¯ <code>Vuex</code> æºç ä¸­å•ä¾‹æ¨¡å¼çš„å®ç°åŠæ³•äº†ï¼Œå¥—è·¯å¯ä»¥è¯´å’Œæˆ‘ä»¬çš„<code>getInstance</code>å¦‚å‡ºä¸€è¾™ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥ä¿è¯ä¸€ä¸ª <code>Vue</code> å®ä¾‹ï¼ˆå³ä¸€ä¸ª Vue åº”ç”¨ï¼‰åªä¼šè¢« <code>install</code> ä¸€æ¬¡ <code>Vuex</code> æ’ä»¶ï¼Œæ‰€ä»¥æ¯ä¸ª Vue å®ä¾‹åªä¼šæ‹¥æœ‰ä¸€ä¸ªå…¨å±€çš„ <code>Store</code></p></blockquote> <p><strong>3. æ€è€ƒæ—¶é—´</strong></p> <blockquote><p>æ€è€ƒä¸€ä¸‹ï¼šå¦‚æœæˆ‘åœ¨ <code>install</code> é‡Œæ²¡æœ‰å®ç°å•ä¾‹æ¨¡å¼ï¼Œä¼šå¸¦æ¥ä»€ä¹ˆæ ·çš„éº»çƒ¦ï¼Ÿ</p></blockquote> <p>æˆ‘ä»¬é€šè¿‡ä¸Šé¢çš„æºç è§£æå¯ä»¥çœ‹å‡ºï¼Œæ¯æ¬¡ <code>install</code> éƒ½ä¼šä¸ºVueå®ä¾‹åˆå§‹åŒ–ä¸€ä¸ª <code>Store</code>ã€‚å‡å¦‚ <code>install</code> é‡Œæ²¡æœ‰å•ä¾‹æ¨¡å¼çš„é€»è¾‘ï¼Œé‚£æˆ‘ä»¬å¦‚æœåœ¨ä¸€ä¸ªåº”ç”¨é‡Œä¸å°å¿ƒå¤šæ¬¡å®‰è£…äº†æ’ä»¶ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// åœ¨ä¸»æ–‡ä»¶é‡Œå®‰è£…Vuex</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Vuex<span class="token punctuation">)</span>

<span class="token operator">...</span><span class="token punctuation">(</span>ä¸­é—´æ·»åŠ <span class="token operator">/</span>ä¿®æ”¹äº†ä¸€äº›storeçš„æ•°æ®<span class="token punctuation">)</span>

<span class="token comment">// åœ¨åç»­çš„é€»è¾‘é‡Œä¸å°å¿ƒåˆå®‰è£…äº†ä¸€æ¬¡</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Vuex<span class="token punctuation">)</span>
</code></pre></div><p>å¤±å»äº†å•ä¾‹åˆ¤æ–­èƒ½åŠ›çš„ <code>install</code> æ–¹æ³•ï¼Œä¼šä¸ºå½“å‰çš„Vueå®ä¾‹é‡æ–°æ³¨å…¥ä¸€ä¸ªæ–°çš„ <code>Store</code>ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ ä¸­é—´çš„é‚£äº›æ•°æ®æ“ä½œå…¨éƒ½æ²¡äº†ï¼Œä¸€åˆ‡å½’ 0ã€‚å› æ­¤ï¼Œå•ä¾‹æ¨¡å¼åœ¨æ­¤å¤„æ˜¯éå¸¸å¿…è¦çš„ã€‚</p> <p>é™¤äº†è¯´åœ¨ <code>Vuex</code> ä¸­å¤§å±•èº«æ‰‹ï¼Œæˆ‘ä»¬åœ¨ <code>Redux</code>ã€<code>jQuery</code> ç­‰è®¸å¤šä¼˜ç§€çš„å‰ç«¯åº“é‡Œä¹Ÿéƒ½èƒ½çœ‹åˆ°å•ä¾‹æ¨¡å¼çš„èº«å½±</p> <h3 id="_2-3-å•ä¾‹æ¨¡å¼â€”â€”é¢è¯•çœŸé¢˜"><a href="#_2-3-å•ä¾‹æ¨¡å¼â€”â€”é¢è¯•çœŸé¢˜" class="header-anchor">#</a> 2.3 å•ä¾‹æ¨¡å¼â€”â€”é¢è¯•çœŸé¢˜</h3> <blockquote><p>å®ç°ä¸€ä¸ª <code>Storage</code></p></blockquote> <p><strong>1. æè¿°</strong></p> <blockquote><p>å®ç°<code>Storage</code>ï¼Œä½¿å¾—è¯¥å¯¹è±¡ä¸ºå•ä¾‹ï¼ŒåŸºäº <code>localStorage</code> è¿›è¡Œå°è£…ã€‚å®ç°æ–¹æ³• <code>setItem(key,value)</code> å’Œ <code>getItem(key)</code></p></blockquote> <p><strong>2. æ€è·¯</strong></p> <blockquote><p>å…·ä½“å®ç°ä¸Šï¼ŒæŠŠåˆ¤æ–­é€»è¾‘å†™å…¥é™æ€æ–¹æ³•æˆ–è€…æ„é€ å‡½æ•°é‡Œéƒ½æ²¡å…³ç³»ï¼Œæœ€å¥½èƒ½æŠŠé—­åŒ…çš„ç‰ˆæœ¬ä¹Ÿå†™å‡ºæ¥</p></blockquote> <p><strong>3. å®ç°ï¼šé™æ€æ–¹æ³•ç‰ˆ</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å®šä¹‰Storage</span>
<span class="token keyword">class</span> <span class="token class-name">Storage</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// åˆ¤æ–­æ˜¯å¦å·²ç»newè¿‡1ä¸ªå®ä¾‹</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Storage<span class="token punctuation">.</span>instance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// è‹¥è¿™ä¸ªå”¯ä¸€çš„å®ä¾‹ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå…ˆåˆ›å»ºå®ƒ</span>
            Storage<span class="token punctuation">.</span>instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Storage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// å¦‚æœè¿™ä¸ªå”¯ä¸€çš„å®ä¾‹å·²ç»å­˜åœ¨ï¼Œåˆ™ç›´æ¥è¿”å›</span>
        <span class="token keyword">return</span> Storage<span class="token punctuation">.</span>instance
    <span class="token punctuation">}</span>
    <span class="token function">getItem</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">setItem</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> storage1 <span class="token operator">=</span> Storage<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> storage2 <span class="token operator">=</span> Storage<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

storage1<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'æé›·'</span><span class="token punctuation">)</span>
<span class="token comment">// æé›·</span>
storage1<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span>
<span class="token comment">// ä¹Ÿæ˜¯æé›·</span>
storage2<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span>

<span class="token comment">// è¿”å›true</span>
storage1 <span class="token operator">===</span> storage2

</code></pre></div><p><strong>4. å®ç°ï¼š é—­åŒ…ç‰ˆ</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å…ˆå®ç°ä¸€ä¸ªåŸºç¡€çš„StorageBaseç±»ï¼ŒæŠŠgetItemå’ŒsetItemæ–¹æ³•æ”¾åœ¨å®ƒçš„åŸå‹é“¾ä¸Š</span>
<span class="token keyword">function</span> <span class="token function">StorageBase</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">StorageBase</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getItem</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token class-name">StorageBase</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">setItem</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// ä»¥é—­åŒ…çš„å½¢å¼åˆ›å»ºä¸€ä¸ªå¼•ç”¨è‡ªç”±å˜é‡çš„æ„é€ å‡½æ•°</span>
<span class="token keyword">const</span> Storage <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> instance <span class="token operator">=</span> <span class="token keyword">null</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// åˆ¤æ–­è‡ªç”±å˜é‡æ˜¯å¦ä¸ºnull</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>instance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// å¦‚æœä¸ºnullåˆ™newå‡ºå”¯ä¸€å®ä¾‹</span>
            instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StorageBase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> instance
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// è¿™é‡Œå…¶å®ä¸ç”¨ new Storage çš„å½¢å¼è°ƒç”¨ï¼Œç›´æ¥ Storage() ä¹Ÿä¼šæœ‰ä¸€æ ·çš„æ•ˆæœ </span>
<span class="token keyword">const</span> storage1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Storage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> storage2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Storage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

storage1<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'æé›·'</span><span class="token punctuation">)</span>
<span class="token comment">// æé›·</span>
storage1<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span>
<span class="token comment">// ä¹Ÿæ˜¯æé›·</span>
storage2<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span>

<span class="token comment">// è¿”å›true</span>
storage1 <span class="token operator">===</span> storage2
</code></pre></div><h3 id="_2-4-å®ç°ä¸€ä¸ªå…¨å±€çš„æ¨¡æ€æ¡†"><a href="#_2-4-å®ç°ä¸€ä¸ªå…¨å±€çš„æ¨¡æ€æ¡†" class="header-anchor">#</a> 2.4 å®ç°ä¸€ä¸ªå…¨å±€çš„æ¨¡æ€æ¡†</h3> <blockquote><p>å®ç°ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„Modalå¼¹æ¡†</p></blockquote> <p><strong>æ€è·¯</strong></p> <p>è¿™é“é¢˜æ¯”è¾ƒç»å…¸ï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰è®²å•ä¾‹æ¨¡å¼çš„æ–‡ç« éƒ½ä¼šä»¥æ­¤ä¸ºä¾‹ï¼ŒåŒæ—¶å®ƒä¹Ÿæ˜¯æ—©æœŸå•ä¾‹æ¨¡å¼åœ¨å‰ç«¯é¢†åŸŸçš„æœ€é›†ä¸­ä½“ç°ã€‚</p> <blockquote><p>ä¸‡å˜ä¸ç¦»å…¶è¸ªï¼Œè®°ä½<code>getInstance</code>æ–¹æ³•ã€è®°ä½<code>instance</code>å˜é‡ã€è®°ä½é—­åŒ…å’Œé™æ€æ–¹æ³•ï¼Œè¿™ä¸ªé¢˜é™¤äº†è¦å¤šå†™ç‚¹ HTML å’Œ <code>CSS</code> ä¹‹å¤–ï¼Œå¯¹å¤§å®¶æ¥è¯´å®Œå…¨ä¸æˆé—®é¢˜ã€‚</p></blockquote> <p><strong>å®ç°</strong></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>å•ä¾‹æ¨¡å¼å¼¹æ¡†<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
    <span class="token selector">#modal</span> <span class="token punctuation">{</span>
        <span class="token property">height</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
        <span class="token property">width</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
        <span class="token property">line-height</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
        <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
        <span class="token property">left</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
        <span class="token property">top</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
        <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate</span><span class="token punctuation">(</span>-50%<span class="token punctuation">,</span> -50%<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token property">border</span><span class="token punctuation">:</span> 1px solid black<span class="token punctuation">;</span>
        <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>open<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>æ‰“å¼€å¼¹æ¡†<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>close<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>å…³é—­å¼¹æ¡†<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token comment">// æ ¸å¿ƒé€»è¾‘ï¼Œè¿™é‡Œé‡‡ç”¨äº†é—­åŒ…æ€è·¯æ¥å®ç°å•ä¾‹æ¨¡å¼</span>
    <span class="token keyword">const</span> Modal <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    	<span class="token keyword">let</span> modal <span class="token operator">=</span> <span class="token keyword">null</span>
    	<span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>modal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            	modal <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
            	modal<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'æˆ‘æ˜¯ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„Modal'</span>
            	modal<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token string">'modal'</span>
            	modal<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span>
            	document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>modal<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> modal
    	<span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment">// ç‚¹å‡»æ‰“å¼€æŒ‰é’®å±•ç¤ºæ¨¡æ€æ¡†</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'open'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// æœªç‚¹å‡»åˆ™ä¸åˆ›å»ºmodalå®ä¾‹ï¼Œé¿å…ä¸å¿…è¦çš„å†…å­˜å ç”¨;æ­¤å¤„ä¸ç”¨ new Modal çš„å½¢å¼è°ƒç”¨ä¹Ÿå¯ä»¥ï¼Œå’Œ Storage åŒç†</span>
    	<span class="token keyword">const</span> modal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Modal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    	modal<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'block'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// ç‚¹å‡»å…³é—­æŒ‰é’®éšè—æ¨¡æ€æ¡†</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    	<span class="token keyword">const</span> modal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Modal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    	<span class="token keyword">if</span><span class="token punctuation">(</span>modal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    	    modal<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span>
    	<span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>æ˜¯ä¸æ˜¯å‘ç°åˆæ˜¯ç†Ÿæ‚‰çš„å¥—è·¯ï¼Ÿåˆå¯ä»¥é»˜å†™äº†ï¼Ÿï¼ˆES6 ç‰ˆæœ¬çš„å®ç°å¤§å®¶è‡ªå·±å°è¯•é»˜å†™ä¸€ä¸‹ï¼Œç›¸ä¿¡å¯¹ç°åœ¨çš„ä½ æ¥è¯´å·²ç»éå¸¸ç®€å•äº†ï¼‰ã€‚</p> <p>è¿™å°±æ˜¯å•ä¾‹æ¨¡å¼é¢è¯•é¢˜çš„ç‰¹ç‚¹ï¼Œå‡†ç¡®åœ°è¯´ï¼Œæ˜¯æ‰€æœ‰è®¾è®¡æ¨¡å¼ç›¸å…³é¢è¯•é¢˜çš„ç‰¹ç‚¹â€”â€”ç‰¢è®°æ ¸å¿ƒæ€è·¯ï¼Œå°±èƒ½ä¸¾ä¸€åä¸‰ã€‚æ‰€ä»¥è¯´è®¾è®¡æ¨¡å¼çš„å­¦ä¹ æ˜¯å…¸å‹çš„ä¸€åˆ†è€•è€˜ä¸€åˆ†æ”¶è·ï¼Œæ€§ä»·æ¯”æé«˜ã€‚</p> <h2 id="_3-ç»“æ„å‹-è£…é¥°å™¨æ¨¡å¼"><a href="#_3-ç»“æ„å‹-è£…é¥°å™¨æ¨¡å¼" class="header-anchor">#</a> 3 ç»“æ„å‹-è£…é¥°å™¨æ¨¡å¼</h2> <blockquote><p>è£…é¥°å™¨æ¨¡å¼ï¼Œåˆåè£…é¥°è€…æ¨¡å¼ã€‚å®ƒçš„å®šä¹‰æ˜¯â€œåœ¨ä¸æ”¹å˜åŸå¯¹è±¡çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡å¯¹å…¶è¿›è¡ŒåŒ…è£…æ‹“å±•ï¼Œä½¿åŸæœ‰å¯¹è±¡å¯ä»¥æ»¡è¶³ç”¨æˆ·çš„æ›´å¤æ‚éœ€æ±‚â€ã€‚</p></blockquote> <h3 id="_3-1-è£…é¥°å™¨æ¨¡å¼åˆç›¸è§"><a href="#_3-1-è£…é¥°å™¨æ¨¡å¼åˆç›¸è§" class="header-anchor">#</a> 3.1 è£…é¥°å™¨æ¨¡å¼åˆç›¸è§</h3> <blockquote><p>ä¸ºäº†ä¸è¢«å·²æœ‰çš„ä¸šåŠ¡é€»è¾‘å¹²æ‰°ï¼Œå½“åŠ¡ä¹‹æ€¥å°±æ˜¯å°†æ—§é€»è¾‘ä¸æ–°é€»è¾‘åˆ†ç¦»ï¼Œ<strong>æŠŠæ—§é€»è¾‘æŠ½å‡ºå»</strong>ï¼š</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å°†å±•ç¤ºModalçš„é€»è¾‘å•ç‹¬å°è£…</span>
<span class="token keyword">function</span> <span class="token function">openModal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> modal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Modal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    modal<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'block'</span>
<span class="token punctuation">}</span>

</code></pre></div><p>ç¼–å†™æ–°é€»è¾‘ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// æŒ‰é’®æ–‡æ¡ˆä¿®æ”¹é€»è¾‘</span>
<span class="token keyword">function</span> <span class="token function">changeButtonText</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'open'</span><span class="token punctuation">)</span>
    btn<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token string">'å¿«å»ç™»å½•'</span>
<span class="token punctuation">}</span>

<span class="token comment">// æŒ‰é’®ç½®ç°é€»è¾‘</span>
<span class="token keyword">function</span> <span class="token function">disableButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> btn <span class="token operator">=</span>  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'open'</span><span class="token punctuation">)</span>
    btn<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;disabled&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// æ–°ç‰ˆæœ¬åŠŸèƒ½é€»è¾‘æ•´åˆ</span>
<span class="token keyword">function</span> <span class="token function">changeButtonStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">changeButtonText</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">disableButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><p>ç„¶åæŠŠä¸‰ä¸ªæ“ä½œé€ä¸ªæ·»åŠ openæŒ‰é’®çš„ç›‘å¬å‡½æ•°é‡Œï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'open'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">openModal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">changeButtonStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><p>å¦‚æ­¤ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å®ç°äº†â€œåªæ·»åŠ ï¼Œä¸ä¿®æ”¹â€çš„è£…é¥°å™¨æ¨¡å¼ï¼Œä½¿ç”¨changeButtonStatusçš„é€»è¾‘è£…é¥°äº†æ—§çš„æŒ‰é’®ç‚¹å‡»é€»è¾‘ã€‚ä»¥ä¸Šæ˜¯ES5ä¸­çš„å®ç°ï¼ŒES6ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä»¥ä¸€ç§æ›´åŠ é¢å‘å¯¹è±¡åŒ–çš„æ–¹å¼å»å†™ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å®šä¹‰æ‰“å¼€æŒ‰é’®</span>
<span class="token keyword">class</span> <span class="token class-name">OpenButton</span> <span class="token punctuation">{</span>
    <span class="token comment">// ç‚¹å‡»åå±•ç¤ºå¼¹æ¡†ï¼ˆæ—§é€»è¾‘ï¼‰</span>
    <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> modal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Modal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    	modal<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'block'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// å®šä¹‰æŒ‰é’®å¯¹åº”çš„è£…é¥°å™¨</span>
<span class="token keyword">class</span> <span class="token class-name">Decorator</span> <span class="token punctuation">{</span>
    <span class="token comment">// å°†æŒ‰é’®å®ä¾‹ä¼ å…¥</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">open_button</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>open_button <span class="token operator">=</span> open_button
    <span class="token punctuation">}</span>

    <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>open_button<span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// â€œåŒ…è£…â€äº†ä¸€å±‚æ–°é€»è¾‘</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">changeButtonStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token function">changeButtonStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">changeButtonText</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">disableButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token function">disableButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> btn <span class="token operator">=</span>  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'open'</span><span class="token punctuation">)</span>
        btn<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;disabled&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token function">changeButtonText</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'open'</span><span class="token punctuation">)</span>
        btn<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token string">'å¿«å»ç™»å½•'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> openButton <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OpenButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> decorator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Decorator</span><span class="token punctuation">(</span>openButton<span class="token punctuation">)</span>

document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'open'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// openButton.onClick()</span>
    <span class="token comment">// æ­¤å¤„å¯ä»¥åˆ†åˆ«å°è¯•ä¸¤ä¸ªå®ä¾‹çš„onClickæ–¹æ³•ï¼ŒéªŒè¯è£…é¥°å™¨æ˜¯å¦ç”Ÿæ•ˆ</span>
    decorator<span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><blockquote><p>å¤§å®¶è¿™é‡Œéœ€è¦ç‰¹åˆ«å…³æ³¨ä¸€ä¸‹ ES6 è¿™ä¸ªç‰ˆæœ¬çš„å®ç°ï¼Œè¿™é‡Œæˆ‘ä»¬æŠŠæŒ‰é’®å®ä¾‹ä¼ ç»™äº† Decoratorï¼Œä»¥ä¾¿äºåç»­ Decorator å¯ä»¥å¯¹å®ƒä¸ºæ‰€æ¬²ä¸ºè¿›è¡Œé€»è¾‘çš„æ‹“å±•ã€‚åœ¨ ES7 ä¸­ï¼Œ<code>Decorator</code> ä½œä¸ºä¸€ç§è¯­æ³•è¢«ç›´æ¥æ”¯æŒäº†ï¼Œå®ƒçš„ä¹¦å†™ä¼šå˜å¾—æ›´åŠ ç®€å•ï¼Œä½†èƒŒåçš„åŸç†å…¶å®ä¸æ­¤å¤§åŒå°å¼‚</p></blockquote> <h3 id="_3-2-æ·±å…¥è£…é¥°å™¨åŸç†"><a href="#_3-2-æ·±å…¥è£…é¥°å™¨åŸç†" class="header-anchor">#</a> 3.2 æ·±å…¥è£…é¥°å™¨åŸç†</h3> <p>åœ¨ ES7 ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åƒå†™ python ä¸€æ ·é€šè¿‡ä¸€ä¸ª<code>@</code>è¯­æ³•ç³–è½»æ¾åœ°ç»™ä¸€ä¸ªç±»è£…ä¸Šè£…é¥°å™¨ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// è£…é¥°å™¨å‡½æ•°ï¼Œå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç›®æ ‡ç±»</span>
<span class="token keyword">function</span> <span class="token function">classDecorator</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    target<span class="token punctuation">.</span>hasDecorator <span class="token operator">=</span> <span class="token boolean">true</span>
  	<span class="token keyword">return</span> target
<span class="token punctuation">}</span>

<span class="token comment">// å°†è£…é¥°å™¨â€œå®‰è£…â€åˆ°Buttonç±»ä¸Š</span>
@classDecorator
<span class="token keyword">class</span> <span class="token class-name">Button</span> <span class="token punctuation">{</span>
    <span class="token comment">// Buttonç±»çš„ç›¸å…³é€»è¾‘</span>
<span class="token punctuation">}</span>

<span class="token comment">// éªŒè¯è£…é¥°å™¨æ˜¯å¦ç”Ÿæ•ˆ</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Button æ˜¯å¦è¢«è£…é¥°äº†ï¼š'</span><span class="token punctuation">,</span> Button<span class="token punctuation">.</span>hasDecorator<span class="token punctuation">)</span>
</code></pre></div><p>ä¹Ÿå¯ä»¥ç”¨åŒæ ·çš„è¯­æ³•ç³–å»è£…é¥°ç±»é‡Œé¢çš„æ–¹æ³•ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å…·ä½“çš„å‚æ•°æ„ä¹‰ï¼Œåœ¨ä¸‹ä¸ªå°èŠ‚ï¼Œè¿™é‡Œå¤§å®¶å…ˆæ„ŸçŸ¥ä¸€ä¸‹æ“ä½œ</span>
<span class="token keyword">function</span> <span class="token function">funcDecorator</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> name<span class="token punctuation">,</span> descriptor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> originalMethod <span class="token operator">=</span> descriptor<span class="token punctuation">.</span>value
  descriptor<span class="token punctuation">.</span><span class="token function-variable function">value</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æˆ‘æ˜¯Funcçš„è£…é¥°å™¨é€»è¾‘'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token function">originalMethod</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> descriptor
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Button</span> <span class="token punctuation">{</span>
    @funcDecorator
    <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æˆ‘æ˜¯Funcçš„åŸæœ‰é€»è¾‘'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// éªŒè¯è£…é¥°å™¨æ˜¯å¦ç”Ÿæ•ˆ</span>
<span class="token keyword">const</span> button <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
button<span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_3-3-è£…é¥°å™¨è¯­æ³•ç³–èƒŒåçš„æ•…äº‹"><a href="#_3-3-è£…é¥°å™¨è¯­æ³•ç³–èƒŒåçš„æ•…äº‹" class="header-anchor">#</a> 3.3 è£…é¥°å™¨è¯­æ³•ç³–èƒŒåçš„æ•…äº‹</h3> <blockquote><p>æ‰€è°“è¯­æ³•ç³–ï¼Œå¾€å¾€æ„å‘³ç€â€œç¾å¥½çš„è¡¨è±¡â€ã€‚æ­£å¦‚ <code>class</code> è¯­æ³•ç³–èƒŒåæ˜¯å¤§å®¶æ—©å·²ååˆ†ç†Ÿæ‚‰çš„ ES5 æ„é€ å‡½æ•°ä¸€æ ·ï¼Œè£…é¥°å™¨è¯­æ³•ç³–èƒŒåä¹Ÿæ˜¯æˆ‘ä»¬çš„è€æœ‹å‹ï¼Œä¸ä¿¡æˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹<code>@decorator</code>éƒ½å¸®æˆ‘ä»¬åšäº†äº›ä»€ä¹ˆï¼š</p></blockquote> <blockquote><p>ä¸Šä¸€èŠ‚æˆ‘ä»¬ä½¿ç”¨ <code>ES6</code> å®ç°è£…é¥°å™¨æ¨¡å¼æ—¶æ›¾ç»å°†æŒ‰é’®å®ä¾‹ä¼ ç»™äº† <code>Decorator</code>ï¼Œä»¥ä¾¿äºåç»­ <code>Decorator</code> å¯ä»¥å¯¹å®ƒè¿›è¡Œé€»è¾‘çš„æ‹“å±•ã€‚è¿™ä¹Ÿæ­£æ˜¯è£…é¥°å™¨çš„æœ€æœ€åŸºæœ¬æ“ä½œâ€”â€”å®šä¹‰è£…é¥°å™¨å‡½æ•°ï¼Œå°†è¢«è£…é¥°è€…â€œäº¤ç»™â€è£…é¥°å™¨ã€‚è¿™ä¹Ÿæ­£æ˜¯è£…é¥°å™¨è¯­æ³•ç³–é¦–å…ˆå¸®æˆ‘ä»¬åšæ‰çš„å·¥ä½œ â€”â€” å‡½æ•°ä¼ å‚&amp;è°ƒç”¨ã€‚</p></blockquote> <p><strong>1. ç±»è£…é¥°å™¨çš„å‚æ•°</strong></p> <p>å½“æˆ‘ä»¬ç»™ä¸€ä¸ªç±»æ·»åŠ è£…é¥°å™¨æ—¶ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">classDecorator</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    target<span class="token punctuation">.</span>hasDecorator <span class="token operator">=</span> <span class="token boolean">true</span>
  	<span class="token keyword">return</span> target
<span class="token punctuation">}</span>

<span class="token comment">// å°†è£…é¥°å™¨â€œå®‰è£…â€åˆ°Buttonç±»ä¸Š</span>
@classDecorator
<span class="token keyword">class</span> <span class="token class-name">Button</span> <span class="token punctuation">{</span>
    <span class="token comment">// Buttonç±»çš„ç›¸å…³é€»è¾‘</span>
<span class="token punctuation">}</span>

</code></pre></div><p>æ­¤å¤„çš„ <code>target</code> å°±æ˜¯è¢«è£…é¥°çš„ç±»æœ¬èº«ã€‚</p> <p><strong>2. æ–¹æ³•è£…é¥°å™¨çš„å‚æ•°</strong></p> <p>è€Œå½“æˆ‘ä»¬ç»™ä¸€ä¸ªæ–¹æ³•æ·»åŠ è£…é¥°å™¨æ—¶ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">funcDecorator</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> name<span class="token punctuation">,</span> descriptor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> originalMethod <span class="token operator">=</span> descriptor<span class="token punctuation">.</span>value
    descriptor<span class="token punctuation">.</span><span class="token function-variable function">value</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æˆ‘æ˜¯Funcçš„è£…é¥°å™¨é€»è¾‘'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token function">originalMethod</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> descriptor
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Button</span> <span class="token punctuation">{</span>
    @funcDecorator
    <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æˆ‘æ˜¯Funcçš„åŸæœ‰é€»è¾‘'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ­¤å¤„çš„ <code>target</code> å˜æˆäº†<code>Button.prototype</code>ï¼Œå³ç±»çš„åŸå‹å¯¹è±¡ã€‚è¿™æ˜¯å› ä¸º <code>onClick</code> æ–¹æ³•æ€»æ˜¯è¦ä¾é™„å…¶å®ä¾‹å­˜åœ¨çš„ï¼Œä¿®é¥° <code>onClik</code> å…¶å®æ˜¯ä¿®é¥°å®ƒçš„å®ä¾‹ã€‚ä½†æˆ‘ä»¬çš„è£…é¥°å™¨å‡½æ•°æ‰§è¡Œçš„æ—¶å€™ï¼Œ<code>Button</code> å®ä¾‹è¿˜<strong>å¹¶ä¸å­˜åœ¨</strong>ã€‚ä¸ºäº†ç¡®ä¿å®ä¾‹ç”Ÿæˆåå¯ä»¥é¡ºåˆ©è°ƒç”¨è¢«è£…é¥°å¥½çš„æ–¹æ³•ï¼Œè£…é¥°å™¨åªèƒ½å»ä¿®é¥° <code>Button</code> ç±»çš„åŸå‹å¯¹è±¡ã€‚</p> <p><strong>3. è£…é¥°å™¨å‡½æ•°è°ƒç”¨çš„æ—¶æœº</strong></p> <blockquote><p>è£…é¥°å™¨å‡½æ•°æ‰§è¡Œçš„æ—¶å€™ï¼Œ<code>Button</code> å®ä¾‹è¿˜å¹¶ä¸å­˜åœ¨ã€‚è¿™æ˜¯å› ä¸ºå®ä¾‹æ˜¯åœ¨æˆ‘ä»¬çš„ä»£ç <strong>è¿è¡Œæ—¶</strong>åŠ¨æ€ç”Ÿæˆçš„ï¼Œè€Œè£…é¥°å™¨å‡½æ•°åˆ™æ˜¯åœ¨<strong>ç¼–è¯‘é˜¶æ®µ</strong>å°±æ‰§è¡Œäº†ã€‚æ‰€ä»¥è¯´è£…é¥°å™¨å‡½æ•°çœŸæ­£èƒ½è§¦åŠåˆ°çš„ï¼Œå°±åªæœ‰ç±»è¿™ä¸ªå±‚é¢ä¸Šçš„å¯¹è±¡</p></blockquote> <h3 id="_3-4-å°†â€œå±æ€§æè¿°å¯¹è±¡â€äº¤åˆ°ä½ æ‰‹é‡Œ"><a href="#_3-4-å°†â€œå±æ€§æè¿°å¯¹è±¡â€äº¤åˆ°ä½ æ‰‹é‡Œ" class="header-anchor">#</a> 3.4 å°†â€œå±æ€§æè¿°å¯¹è±¡â€äº¤åˆ°ä½ æ‰‹é‡Œ</h3> <blockquote><p>åœ¨ç¼–å†™ç±»è£…é¥°å™¨æ—¶ï¼Œæˆ‘ä»¬ä¸€èˆ¬è·å–ä¸€ä¸ª<code>target</code>å‚æ•°å°±è¶³å¤Ÿäº†ã€‚ä½†åœ¨ç¼–å†™æ–¹æ³•è£…é¥°å™¨æ—¶ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦è‡³å°‘ä¸‰ä¸ªå‚æ•°ï¼š</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">funcDecorator</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> name<span class="token punctuation">,</span> descriptor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> originalMethod <span class="token operator">=</span> descriptor<span class="token punctuation">.</span>value
  descriptor<span class="token punctuation">.</span><span class="token function-variable function">value</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æˆ‘æ˜¯Funcçš„è£…é¥°å™¨é€»è¾‘'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token function">originalMethod</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> descriptor
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>ç¬¬ä¸€ä¸ªå‚æ•°çš„æ„ä¹‰ï¼Œå‰æ–‡å·²ç»è§£é‡Šè¿‡ã€‚ç¬¬äºŒä¸ªå‚ æ•°nameï¼Œæ˜¯æˆ‘ä»¬ä¿®é¥°çš„ç›®æ ‡å±æ€§å±æ€§åï¼Œä¹Ÿæ²¡å•¥å¥½è®²çš„ã€‚å…³é”®å°±åœ¨è¿™ä¸ª d<code>escriptor</code> èº«ä¸Šï¼Œå®ƒä¹Ÿæ˜¯æˆ‘ä»¬ä½¿ç”¨é¢‘ç‡æœ€é«˜çš„ä¸€ä¸ªå‚æ•°ï¼Œå®ƒçš„çœŸé¢ç›®å°±æ˜¯â€œå±æ€§æè¿°å¯¹è±¡â€ï¼ˆ<code>attributes object</code>ï¼‰ã€‚è¿™ä¸ªåå­—å¤§å®¶å¯èƒ½ä¸ç†Ÿæ‚‰ï¼Œä½†<code>Object.defineProperty</code>æ–¹æ³•æˆ‘æƒ³å¤§å®¶å¤šå°‘éƒ½ç”¨è¿‡ï¼Œå®ƒçš„è°ƒç”¨æ–¹å¼æ˜¯è¿™æ ·çš„ï¼š</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> prop<span class="token punctuation">,</span> descriptor<span class="token punctuation">)</span>
</code></pre></div><blockquote><p>æ­¤å¤„çš„<code>descriptor</code>å’Œè£…é¥°å™¨å‡½æ•°é‡Œçš„ <code>descriptor</code> æ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Œå®ƒæ˜¯ <code>JavaScript</code> æä¾›çš„ä¸€ä¸ªå†…éƒ¨æ•°æ®ç»“æ„ã€ä¸€ä¸ªå¯¹è±¡ï¼Œä¸“é—¨ç”¨æ¥æè¿°å¯¹è±¡çš„å±æ€§ã€‚å®ƒç”±å„ç§å„æ ·çš„å±æ€§æè¿°ç¬¦ç»„æˆï¼Œè¿™äº›æè¿°ç¬¦åˆåˆ†ä¸ºæ•°æ®æè¿°ç¬¦å’Œå­˜å–æè¿°ç¬¦ï¼š</p></blockquote> <ul><li>æ•°æ®æè¿°ç¬¦ï¼š
<ul><li>åŒ…æ‹¬ <code>value</code>ï¼ˆå­˜æ”¾å±æ€§å€¼ï¼Œé»˜è®¤ä¸ºé»˜è®¤ä¸º <code>undefined</code>ï¼‰</li> <li><code>writable</code>ï¼ˆè¡¨ç¤ºå±æ€§å€¼æ˜¯å¦å¯æ”¹å˜ï¼Œé»˜è®¤ä¸ºtrueï¼‰</li> <li><code>enumerable</code>ï¼ˆè¡¨ç¤ºå±æ€§æ˜¯å¦å¯æšä¸¾ï¼Œé»˜è®¤ä¸º <code>true</code>ï¼‰</li> <li><code>configurable</code>ï¼ˆå±æ€§æ˜¯å¦å¯é…ç½®ï¼Œé»˜è®¤ä¸º<code>true</code>ï¼‰ã€‚</li></ul></li> <li>å­˜å–æè¿°ç¬¦ï¼š
<ul><li>åŒ…æ‹¬ <code>get</code> æ–¹æ³•ï¼ˆè®¿é—®å±æ€§æ—¶è°ƒç”¨çš„æ–¹æ³•ï¼Œé»˜è®¤ä¸º <code>undefined</code>ï¼‰</li> <li><code>set</code>ï¼ˆè®¾ç½®å±æ€§æ—¶è°ƒç”¨çš„æ–¹æ³•ï¼Œé»˜è®¤ä¸º <code>undefined</code> ï¼‰</li></ul></li></ul> <blockquote><p>å¾ˆæ˜æ˜¾ï¼Œæ‹¿åˆ°äº† <code>descriptor</code>ï¼Œå°±ç›¸å½“äºæ‹¿åˆ°äº†ç›®æ ‡æ–¹æ³•çš„æ§åˆ¶æƒã€‚é€šè¿‡ä¿®æ”¹ <code>descriptor</code>ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹ç›®æ ‡æ–¹æ³•ä¸ºæ‰€æ¬²ä¸ºçš„é€»è¾‘è¿›è¡Œæ‹“å±•äº†~</p></blockquote> <blockquote><p>åœ¨ä¸Šæ–‡çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ <code>descriptor</code> è·å–åˆ°äº†åŸå‡½æ•°çš„å‡½æ•°ä½“ï¼ˆ<code>originalMethod</code>ï¼‰ï¼ŒæŠŠåŸå‡½æ•°æ¨è¿Ÿåˆ°äº†æ–°é€»è¾‘ï¼ˆconsoleï¼‰çš„åé¢å»æ‰§è¡Œã€‚è¿™ç§åšæ³•å’Œæˆ‘ä»¬ä¸Šä¸€èŠ‚åœ¨ES5ä¸­å®ç°è£…é¥°å™¨æ¨¡å¼æ—¶åšçš„äº‹æƒ…ä¸€æ¨¡ä¸€æ ·ï¼Œæ‰€ä»¥è¯´è£…é¥°å™¨å°±æ˜¯è¿™ä¹ˆå›äº‹å„¿ï¼Œæ¢æ±¤ä¸æ¢è¯~</p></blockquote> <h3 id="_3-5-reactä¸­çš„è£…é¥°å™¨ï¼šhoc"><a href="#_3-5-reactä¸­çš„è£…é¥°å™¨ï¼šhoc" class="header-anchor">#</a> 3.5 Reactä¸­çš„è£…é¥°å™¨ï¼šHOC</h3> <blockquote><p>é«˜é˜¶ç»„ä»¶å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¸”è¯¥å‡½æ•°æ¥å—ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶ã€‚</p></blockquote> <p>HOC (Higher Order Component) å³é«˜é˜¶ç»„ä»¶ã€‚å®ƒæ˜¯è£…é¥°å™¨æ¨¡å¼åœ¨ React ä¸­çš„å®è·µï¼ŒåŒæ—¶ä¹Ÿæ˜¯ React åº”ç”¨ä¸­éå¸¸é‡è¦çš„ä¸€éƒ¨åˆ†ã€‚é€šè¿‡ç¼–å†™é«˜é˜¶ç»„ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å……åˆ†å¤ç”¨ç°æœ‰é€»è¾‘ï¼Œæé«˜ç¼–ç æ•ˆç‡å’Œä»£ç çš„å¥å£®æ€§ã€‚</p> <p>æˆ‘ä»¬ç°åœ¨ç¼–å†™ä¸€ä¸ªé«˜é˜¶ç»„ä»¶ï¼Œå®ƒçš„ä½œç”¨æ˜¯æŠŠä¼ å…¥çš„ç»„ä»¶<strong>ä¸¢è¿›ä¸€ä¸ªæœ‰çº¢è‰²è¾¹æ¡†çš„å®¹å™¨é‡Œ</strong>ï¼ˆæ‹“å±•å…¶æ ·å¼ï¼‰ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token keyword">const</span> <span class="token function-variable function">BorderHoc</span> <span class="token operator">=</span> <span class="token parameter">WrappedComponent</span> <span class="token operator">=&gt;</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> Component <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> border<span class="token punctuation">:</span> <span class="token string">'solid 1px red'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>WrappedComponent <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> borderHoc
</code></pre></div><p>ç”¨å®ƒæ¥è£…é¥°ç›®æ ‡ç»„ä»¶</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> BorderHoc <span class="token keyword">from</span> <span class="token string">'./BorderHoc'</span>

<span class="token comment">// ç”¨BorderHocè£…é¥°ç›®æ ‡ç»„ä»¶</span>
@BorderHoc
<span class="token keyword">class</span> <span class="token class-name">TargetComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ç›®æ ‡ç»„ä»¶å…·ä½“çš„ä¸šåŠ¡é€»è¾‘</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// exportå‡ºå»çš„å…¶å®æ˜¯ä¸€ä¸ªè¢«åŒ…è£¹åçš„ç»„ä»¶</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> TargetComponent
</code></pre></div><blockquote><p>å¯ä»¥çœ‹å‡ºï¼Œé«˜é˜¶ç»„ä»¶ä»å®ç°å±‚é¢æ¥çœ‹å…¶å®å°±æ˜¯ä¸Šæ–‡æˆ‘ä»¬æåˆ°çš„ç±»è£…é¥°å™¨ã€‚åœ¨é«˜é˜¶ç»„ä»¶çš„è¾…åŠ©ä¸‹ï¼Œæˆ‘ä»¬ä¸å¿…å› ä¸ºä¸€ä¸ªå°å°çš„æ‹“å±•è€Œå¤§è´¹å‘¨æŠ˜åœ°ç¼–å†™æ–°ç»„ä»¶æˆ–è€…æŠŠä¸€ä¸ªæ–°é€»è¾‘é‡å†™ <code>N</code> å¤šæ¬¡ï¼Œåªéœ€è¦è½»è½» <code>@</code> ä¸€ä¸‹è£…é¥°å™¨å³å¯ã€‚</p></blockquote> <h3 id="_3-6-ä½¿ç”¨è£…é¥°å™¨æ”¹å†™-redux-connect"><a href="#_3-6-ä½¿ç”¨è£…é¥°å™¨æ”¹å†™-redux-connect" class="header-anchor">#</a> 3.6 ä½¿ç”¨è£…é¥°å™¨æ”¹å†™ Redux connect</h3> <blockquote><p>Redux æ˜¯çƒ­é—¨çš„çŠ¶æ€ç®¡ç†å·¥å…·ã€‚åœ¨ React ä¸­ï¼Œå½“æˆ‘ä»¬æƒ³è¦å¼•å…¥ Redux æ—¶ï¼Œé€šå¸¸éœ€è¦è°ƒç”¨ connect æ–¹æ³•æ¥æŠŠçŠ¶æ€å’Œç»„ä»¶ç»‘åœ¨ä¸€èµ·ï¼š</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> connect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> bindActionCreators <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'redux'</span>
<span class="token keyword">import</span> action <span class="token keyword">from</span> <span class="token string">'./action.js'</span>

<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Appçš„ä¸šåŠ¡é€»è¾‘</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">mapStateToProps</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// å‡è®¾Appçš„çŠ¶æ€å¯¹åº”çŠ¶æ€æ ‘ä¸Šçš„appèŠ‚ç‚¹</span>
  <span class="token keyword">return</span> state<span class="token punctuation">.</span>app
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">mapDispatchToProps</span><span class="token punctuation">(</span><span class="token parameter">dispatch</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// è¿™æ®µçœ‹ä¸æ‡‚ä¹Ÿæ²¡å…³ç³»ï¼Œä¸‹é¢ä¼šæœ‰è§£é‡Šã€‚é‡ç‚¹ç†è§£connectçš„è°ƒç”¨å³å¯</span>
  <span class="token keyword">return</span> <span class="token function">bindActionCreators</span><span class="token punctuation">(</span>action<span class="token punctuation">,</span> dispatch<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// æŠŠAppç»„ä»¶ä¸Reduxç»‘åœ¨ä¸€èµ·</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">,</span> mapDispatchToProps<span class="token punctuation">)</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>

</code></pre></div><p>è¿™é‡Œç»™æ²¡ç”¨è¿‡ redux çš„åŒå­¦è§£é‡Šä¸€ä¸‹ connect çš„ä¸¤ä¸ªå…¥å‚ï¼š<code>mapStateToProps</code> æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå¯ä»¥å»ºç«‹ç»„ä»¶å’ŒçŠ¶æ€ä¹‹é—´çš„æ˜ å°„å…³ç³»ï¼›<code>mapDispatchToProps</code>ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒç”¨äºå»ºç«‹ç»„ä»¶å’Œ<code>store.dispatch</code>çš„å…³ç³»ï¼Œä½¿ç»„ä»¶å…·å¤‡é€šè¿‡ dispatch æ¥æ´¾å‘çŠ¶æ€çš„èƒ½åŠ›ã€‚</p> <blockquote><p>æ€»è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬è°ƒç”¨ connect å¯ä»¥è¿”å›ä¸€ä¸ª<strong>å…·æœ‰è£…é¥°ä½œç”¨çš„å‡½æ•°</strong>ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥æ¥æ”¶ä¸€ ä¸ªReact ç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œä½¿è¿™ä¸ªç›®æ ‡ç»„ä»¶å’Œ Redux ç»“åˆã€å…·å¤‡ Redux æä¾›çš„æ•°æ®å’Œèƒ½åŠ›ã€‚æ—¢ç„¶æœ‰è£…é¥°ä½œç”¨ï¼Œæ—¢ç„¶æ˜¯<strong>èƒ½åŠ›çš„æ‹“å±•</strong>ï¼Œé‚£ä¹ˆå°±ä¸€å®šèƒ½ç”¨è£…é¥°å™¨æ¥æ”¹å†™ï¼š</p></blockquote> <p>æŠŠ <code>connect</code> æŠ½å‡ºæ¥ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> connect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> bindActionCreators <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'redux'</span>
<span class="token keyword">import</span> action <span class="token keyword">from</span> <span class="token string">'./action.js'</span>

<span class="token keyword">function</span> <span class="token function">mapStateToProps</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> state<span class="token punctuation">.</span>app
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">mapDispatchToProps</span><span class="token punctuation">(</span><span class="token parameter">dispatch</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">bindActionCreators</span><span class="token punctuation">(</span>action<span class="token punctuation">,</span> dispatch<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// å°†connectè°ƒç”¨åçš„ç»“æœä½œä¸ºä¸€ä¸ªè£…é¥°å™¨å¯¼å‡º</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">,</span> mapDispatchToProps<span class="token punctuation">)</span>
</code></pre></div><p>åœ¨ç»„ä»¶æ–‡ä»¶é‡Œå¼•å…¥<code>connect</code>ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> connect <span class="token keyword">from</span> <span class="token string">'./connect.js'</span>

@connect
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Appçš„ä¸šåŠ¡é€»è¾‘</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬çš„ä»£ç ç»“æ„æ˜¯ä¸æ˜¯æ¸…æ™°äº†å¾ˆå¤š</p> <blockquote><p>æ¨èä¸€ä¸ªéå¸¸èµçš„è£…é¥°æ¨¡å¼åº“ â€”â€” <a href="https://github.com/jayphelps/core-decorators" target="_blank" rel="noopener noreferrer">core-decorators<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚core-decorators å¸®æˆ‘ä»¬å®ç°å¥½äº†ä¸€äº›ä½¿ç”¨é¢‘ç‡è¾ƒé«˜çš„è£…é¥°å™¨ï¼Œæ¯”å¦‚<code>@readonly</code>(ä½¿ç›®æ ‡å±æ€§åªè¯»)ã€<code>@deprecate</code>(åœ¨æ§åˆ¶å°è¾“å‡ºè­¦å‘Šï¼Œæç¤ºç”¨æˆ·æŸä¸ªæŒ‡å®šçš„æ–¹æ³•å·²è¢«åºŸé™¤)ç­‰</p></blockquote> <h2 id="_4-ç»“æ„å‹-é€‚é…å™¨æ¨¡å¼"><a href="#_4-ç»“æ„å‹-é€‚é…å™¨æ¨¡å¼" class="header-anchor">#</a> 4 ç»“æ„å‹-é€‚é…å™¨æ¨¡å¼</h2> <h3 id="_4-1-å…¼å®¹æ¥å£"><a href="#_4-1-å…¼å®¹æ¥å£" class="header-anchor">#</a> 4.1 å…¼å®¹æ¥å£</h3> <blockquote><p>å¤§å®¶çŸ¥é“æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªéå¸¸å¥½ç”¨å¼‚æ­¥æ–¹æ¡ˆå«<code>fetch</code>ï¼Œå®ƒçš„å†™æ³•æ¯”<code>ajax</code>ä¼˜é›…å¾ˆå¤šã€‚å› æ­¤åœ¨ä¸è€ƒè™‘å…¼å®¹æ€§çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ›´æ„¿æ„ä½¿ç”¨<code>fetch</code>ã€è€Œä¸æ˜¯ä½¿ç”¨ajaxæ¥å‘èµ·å¼‚æ­¥è¯·æ±‚ã€‚æé›·æ˜¯æ‹œ<code>fetch</code>æ•™çš„å¿ å®ä¿¡å¾’ï¼Œä¸ºäº†èƒ½æ›´å¥½åœ°ä½¿ç”¨<code>fetch</code>ï¼Œä»–å°è£…äº†ä¸€ä¸ªåŸºäº<code>fetch</code>çš„<code>http</code>æ–¹æ³•åº“ï¼š</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">HttpUtils</span> <span class="token punctuation">{</span>
  <span class="token comment">// getæ–¹æ³•</span>
  <span class="token keyword">static</span> <span class="token keyword">get</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// è°ƒç”¨fetch</span>
      <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">resolve</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// postæ–¹æ³•ï¼Œdataä»¥objectå½¢å¼ä¼ å…¥</span>
  <span class="token keyword">static</span> <span class="token function">post</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// è°ƒç”¨fetch</span>
      <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        method<span class="token punctuation">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>
        headers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          Accept<span class="token punctuation">:</span> <span class="token string">'application/json'</span><span class="token punctuation">,</span>
          <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'application/x-www-form-urlencoded'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// å°†objectç±»å‹çš„æ•°æ®æ ¼å¼åŒ–ä¸ºåˆæ³•çš„bodyå‚æ•°</span>
        body<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">changeData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">resolve</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// bodyè¯·æ±‚ä½“çš„æ ¼å¼åŒ–æ–¹æ³•</span>
  <span class="token keyword">static</span> <span class="token function">changeData</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> prop<span class="token punctuation">,</span>
      str <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>prop <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>prop<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        str <span class="token operator">+=</span> prop <span class="token operator">+</span> <span class="token string">'='</span> <span class="token operator">+</span> obj<span class="token punctuation">[</span>prop<span class="token punctuation">]</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        str <span class="token operator">+=</span> <span class="token string">'&amp;'</span> <span class="token operator">+</span> prop <span class="token operator">+</span> <span class="token string">'='</span> <span class="token operator">+</span> obj<span class="token punctuation">[</span>prop<span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
      i<span class="token operator">++</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> str
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>å½“æˆ‘æƒ³ä½¿ç”¨ <code>fetch</code> å‘èµ·è¯·æ±‚æ—¶ï¼Œåªéœ€è¦è¿™æ ·è½»æ¾åœ°è°ƒç”¨ï¼Œè€Œä¸å¿…å†æ“å¿ƒç¹ççš„æ•°æ®é…ç½®å’Œæ•°æ®æ ¼å¼åŒ–ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å®šä¹‰ç›®æ ‡urlåœ°å€</span>
<span class="token keyword">const</span> <span class="token constant">URL</span> <span class="token operator">=</span> <span class="token string">&quot;xxxxx&quot;</span>
<span class="token comment">// å®šä¹‰postå…¥å‚</span>
<span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>

<span class="token comment">// å‘èµ·postè¯·æ±‚</span>
 <span class="token keyword">const</span> postResponse <span class="token operator">=</span> <span class="token keyword">await</span> HttpUtils<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token constant">URL</span><span class="token punctuation">,</span>params<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

 <span class="token comment">// å‘èµ·getè¯·æ±‚</span>
 <span class="token keyword">const</span> getResponse <span class="token operator">=</span> <span class="token keyword">await</span> HttpUtils<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token constant">URL</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>çœŸæ˜¯ä¸ªå¥½ç”¨çš„æ–¹æ³•åº“ï¼è€æ¿çœ‹äº†æé›·çš„ <code>HttpUtils</code> åº“ï¼Œå–œä¸Šçœ‰æ¢¢â€”â€”åŸæ¥è€æ¿ä¹Ÿæ˜¯ä¸ªæ‹œ fetch æ•™ã€‚è€æ¿è¯´æé›·ï¼Œå’±ä»¬å…¬å¸ä»¥åè¦åšæ½®æµå…¬å¸äº†ï¼Œå†™ä»£ç ä¸å†è€ƒè™‘å…¼å®¹æ€§ï¼Œæˆ‘å¸Œæœ›ä½ èƒ½<strong>æŠŠå…¬å¸æ‰€æœ‰çš„ä¸šåŠ¡çš„ç½‘ç»œè¯·æ±‚éƒ½è¿ç§»åˆ°ä½ è¿™ä¸ª HttpUtils ä¸Šæ¥</strong>ï¼Œè¿™æ ·ä»¥åä½ åªç”¨ç»´æŠ¤è¿™ä¸€ä¸ªåº“äº†ï¼Œä¹Ÿæ–¹ä¾¿ã€‚æé›·ä¸€å¬ï¼Œæ‚²ä»ä¸­æ¥â€”â€”ä»–æ˜¯è¯¥å…¬å¸çš„ç¬¬ 99 ä»£å‘˜å·¥ï¼Œå¯¹è¿œå¤æ—¶æœŸçš„ä¸šåŠ¡ä¸€æ— æ‰€çŸ¥ã€‚è€Œè¯¥å…¬å¸ç¬¬1ä»£å‘˜å·¥å°è£…çš„ç½‘ç»œè¯·æ±‚åº“ï¼Œæ˜¯åŸºäº <code>XMLHttpRequest</code> çš„ï¼Œå·®ä¸å¤šé•¿è¿™æ ·ï¼š</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Ajax</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> success<span class="token punctuation">,</span> failed</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// åˆ›å»ºajaxå¯¹è±¡</span>
    <span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>XMLHttpRequest<span class="token punctuation">)</span><span class="token punctuation">{</span>
        xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ActiveXObject</span><span class="token punctuation">(</span><span class="token string">'Microsoft.XMLHTTP'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

   <span class="token operator">...</span><span class="token punctuation">(</span>æ­¤å¤„çœç•¥ä¸€ç³»åˆ—çš„ä¸šåŠ¡é€»è¾‘ç»†èŠ‚<span class="token punctuation">)</span>

   <span class="token keyword">var</span> type <span class="token operator">=</span> type<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// è¯†åˆ«è¯·æ±‚ç±»å‹</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token string">'GET'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">{</span>
          xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> url <span class="token operator">+</span> <span class="token string">'?'</span> <span class="token operator">+</span> data<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//å¦‚æœæœ‰æ•°æ®å°±æ‹¼æ¥</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// å‘é€getè¯·æ±‚</span>
        xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'POST'</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¦‚æœéœ€è¦åƒ html è¡¨å•é‚£æ · POST æ•°æ®ï¼Œä½¿ç”¨ setRequestHeader() æ¥æ·»åŠ  http å¤´ã€‚</span>
        xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;application/x-www-form-urlencoded&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å‘é€postè¯·æ±‚</span>
        xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// å¤„ç†è¿”å›æ•°æ®</span>
    xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token function">success</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>failed<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token function">failed</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>å®ç°é€»è¾‘æˆ‘ä»¬ç®€å•æè¿°äº†ä¸€ä¸‹ï¼Œè¿™ä¸ªä¸æ˜¯é‡ç‚¹ï¼Œé‡ç‚¹æ˜¯å®ƒæ˜¯è¿™æ ·è°ƒç”¨çš„ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å‘é€getè¯·æ±‚</span>
<span class="token function">Ajax</span><span class="token punctuation">(</span><span class="token string">'get'</span><span class="token punctuation">,</span> urlåœ°å€<span class="token punctuation">,</span> postå…¥å‚<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// æˆåŠŸçš„å›è°ƒé€»è¾‘</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// å¤±è´¥çš„å›è°ƒé€»è¾‘</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>æé›·ä½›äº† â€”â€” ä¸ä»…æ¥å£åä¸åŒï¼Œå…¥å‚æ–¹å¼ä¹Ÿä¸ä¸€æ ·ï¼Œè¿™æ‰‹åŠ¨æ”¹è¦æ”¹åˆ°ä½•å¹´ä½•æ—¥å‘¢ï¼Ÿ</p> <blockquote><p>è¿˜å¥½æé›·å­¦è¿‡è®¾è®¡æ¨¡å¼ï¼Œä»–ç«‹åˆ»è”æƒ³åˆ°äº†ä¸“é—¨ä¸ºæˆ‘ä»¬<strong>æŠ¹å¹³å·®å¼‚</strong>çš„é€‚é…å™¨æ¨¡å¼ã€‚è¦æŠŠè€ä»£ç è¿ç§»åˆ°æ–°æ¥å£ï¼Œä¸ä¸€å®šè¦æŒ¨ä¸ªå„¿å»ä¿®æ”¹æ¯ä¸€æ¬¡çš„æ¥å£è°ƒç”¨â€”â€”æ­£å¦‚æˆ‘ä»¬æƒ³ç”¨ iPhoneX + æ—§è€³æœºå¬æ­Œï¼Œä¸å¿…æŒ¨ä¸ªå„¿å»æ”¹é€ è€³æœºä¸€æ ·ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨å¼•å…¥æ¥å£æ—¶è¿›è¡Œ<strong>ä¸€æ¬¡é€‚é…</strong>ï¼Œä¾¿å¯è½»æ¾åœ° cover æ‰ä¸šåŠ¡é‡Œå¯èƒ½ä¼šæœ‰çš„<strong>å¤šæ¬¡è°ƒç”¨</strong>ï¼ˆå…·ä½“çš„è§£æåœ¨æ³¨é‡Šé‡Œï¼‰ï¼š</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Ajaxé€‚é…å™¨å‡½æ•°ï¼Œå…¥å‚ä¸æ—§æ¥å£ä¿æŒä¸€è‡´</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">AjaxAdapter</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> success<span class="token punctuation">,</span> failed</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> type <span class="token operator">=</span> type<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> result
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
         <span class="token comment">// å®é™…çš„è¯·æ±‚å…¨éƒ¨ç”±æ–°æ¥å£å‘èµ·</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">'GET'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            result <span class="token operator">=</span> <span class="token keyword">await</span> HttpUtils<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">'POST'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            result <span class="token operator">=</span> <span class="token keyword">await</span> HttpUtils<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// å‡è®¾è¯·æ±‚æˆåŠŸå¯¹åº”çš„çŠ¶æ€ç æ˜¯1</span>
        result<span class="token punctuation">.</span>statusCode <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> success <span class="token operator">?</span> <span class="token function">success</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">failed</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>statusCode<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ•æ‰ç½‘ç»œé”™è¯¯</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>failed<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">failed</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>statusCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// ç”¨é€‚é…å™¨é€‚é…æ—§çš„Ajaxæ–¹æ³•</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">Ajax</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> success<span class="token punctuation">,</span> failed</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">AjaxAdapter</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> success<span class="token punctuation">,</span> failed<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>å¦‚æ­¤ä¸€æ¥ï¼Œæˆ‘ä»¬åªéœ€è¦ç¼–å†™ä¸€ä¸ªé€‚é…å™¨å‡½æ•°<code>AjaxAdapter</code>ï¼Œå¹¶ç”¨é€‚é…å™¨å»æ‰¿æ¥æ—§æ¥å£çš„å‚æ•°ï¼Œå°±å¯ä»¥å®ç°æ–°æ—§æ¥å£çš„æ— ç¼è¡”æ¥äº†~</p></blockquote> <h3 id="_4-2-ç”Ÿäº§å®è·µï¼šaxiosä¸­çš„é€‚é…å™¨"><a href="#_4-2-ç”Ÿäº§å®è·µï¼šaxiosä¸­çš„é€‚é…å™¨" class="header-anchor">#</a> 4.2 ç”Ÿäº§å®è·µï¼šaxiosä¸­çš„é€‚é…å™¨</h3> <blockquote><p>æ•°æœˆä¹‹åï¼Œæé›·çš„è€æ¿å‘ç°äº†ç½‘ç»œè¯·æ±‚ç¥åº“axiosï¼Œäºæ˜¯å›¢é˜Ÿçš„æ–¹æ¡ˆåˆæ•´ä¸ªè¿ç§»åˆ°äº†<code>axios</code>â€”â€”å¯¹äºå¿ƒä¸­æœ‰é€‚é…å™¨çš„æé›·æ¥è¯´ï¼Œè¿™ç°åœ¨å·²ç»æ ¹æœ¬ä¸æ˜¯ä¸ªäº‹å„¿ã€‚ä¸è¿‡æœ¬å°èŠ‚æˆ‘ä»¬è¦èŠçš„å¯ä¸å†æ˜¯â€œå¦‚ä½•ä½¿ç°æœ‰æ¥å£å…¼å®¹axiosâ€äº†ã€‚æ­¤å¤„å¼•å‡ºaxiosï¼Œä¸€æ˜¯å› ä¸ºå¤§å®¶å¯¹å®ƒè¶³å¤Ÿç†Ÿæ‚‰ï¼ˆä¸ç†Ÿæ‚‰çš„åŒå­¦ï¼Œç‚¹<a href="https://github.com/axios/axios" target="_blank" rel="noopener noreferrer">è¿™é‡Œ<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>å¯ä»¥å¿«é€Ÿç†Ÿæ‚‰ä¸€ä¸‹~ï¼‰ï¼ŒäºŒæ˜¯å› ä¸ºaxiosæœ¬èº«å°±ç”¨åˆ°äº†æˆ‘ä»¬çš„<strong>é€‚é…å™¨æ¨¡å¼</strong>ï¼Œå®ƒçš„å…¼å®¹æ–¹æ¡ˆå€¼å¾—æˆ‘ä»¬å­¦ä¹ å’Œå€Ÿé‰´ã€‚</p></blockquote> <p>åœ¨ä½¿ç”¨<code>axios</code>æ—¶ï¼Œä½œä¸ºç”¨æˆ·æˆ‘ä»¬åªéœ€è¦æŒæ¡ä»¥ä¸‹é¢ä¸‰ä¸ªæœ€å¸¸ç”¨çš„æ¥å£ä¸ºä»£è¡¨çš„ä¸€å¥—<code>api</code>ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Make a request for a user with a given ID</span>
axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/user?ID=12345'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// handle success</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// handle error</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// always executed</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/user'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    firstName<span class="token punctuation">:</span> <span class="token string">'Fred'</span><span class="token punctuation">,</span>
    lastName<span class="token punctuation">:</span> <span class="token string">'Flintstone'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  method<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
  url<span class="token punctuation">:</span> <span class="token string">'/user/12345'</span><span class="token punctuation">,</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    firstName<span class="token punctuation">:</span> <span class="token string">'Fred'</span><span class="token punctuation">,</span>
    lastName<span class="token punctuation">:</span> <span class="token string">'Flintstone'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><ul><li>ä¾¿å¯è½»æ¾åœ°å‘èµ·å„ç§å§¿åŠ¿çš„ç½‘ç»œè¯·æ±‚ï¼Œè€Œä¸ç”¨å»å…³å¿ƒåº•å±‚çš„å®ç°ç»†èŠ‚ã€‚</li> <li>é™¤äº†ç®€æ˜ä¼˜é›…çš„apiä¹‹å¤–ï¼Œaxios å¼ºå¤§çš„åœ°æ–¹è¿˜åœ¨äºï¼Œå®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªå±€é™äºæµè§ˆå™¨ç«¯çš„åº“ã€‚åœ¨Nodeç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬å°è¯•è°ƒç”¨ä¸Šé¢çš„ apiï¼Œä¼šå‘ç°å®ƒç…§æ ·å¥½ä½¿ â€”â€” axios å®Œç¾åœ°<strong>æŠ¹å¹³äº†ä¸¤ç§ç¯å¢ƒä¸‹apiçš„è°ƒç”¨å·®å¼‚</strong>ï¼Œé çš„æ­£æ˜¯å¯¹é€‚é…å™¨æ¨¡å¼çš„çµæ´»è¿ç”¨ã€‚</li></ul> <blockquote><p>åœ¨ <a href="https://github.com/axios/axios/blob/master/lib/core/Axios.js" target="_blank" rel="noopener noreferrer">axios çš„æ ¸å¿ƒé€»è¾‘<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°å®é™…ä¸Šæ´¾å‘è¯·æ±‚çš„æ˜¯ <a href="https://github.com/axios/axios/blob/master/lib/core/dispatchRequest.js" target="_blank" rel="noopener noreferrer">dispatchRequest æ–¹æ³•<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚è¯¥æ–¹æ³•å†…éƒ¨å…¶å®ä¸»è¦åšäº†ä¸¤ä»¶äº‹ï¼š</p></blockquote> <ol><li>æ•°æ®è½¬æ¢ï¼Œè½¬æ¢è¯·æ±‚ä½“/å“åº”ä½“ï¼Œå¯ä»¥ç†è§£ä¸ºæ•°æ®å±‚é¢çš„é€‚é…ï¼›</li> <li>è°ƒç”¨é€‚é…å™¨ã€‚</li></ol> <blockquote><p>è°ƒç”¨é€‚é…å™¨çš„é€»è¾‘å¦‚ä¸‹ï¼š</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// è‹¥ç”¨æˆ·æœªæ‰‹åŠ¨é…ç½®é€‚é…å™¨ï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„é€‚é…å™¨</span>
<span class="token keyword">var</span> adapter <span class="token operator">=</span> config<span class="token punctuation">.</span>adapter <span class="token operator">||</span> defaults<span class="token punctuation">.</span>adapter<span class="token punctuation">;</span>

  <span class="token comment">// dispatchRequestæ–¹æ³•çš„æœ«å°¾è°ƒç”¨çš„æ˜¯é€‚é…å™¨æ–¹æ³•</span>
  <span class="token keyword">return</span> <span class="token function">adapter</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">onAdapterResolution</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è¯·æ±‚æˆåŠŸçš„å›è°ƒ</span>
    <span class="token function">throwIfCancellationRequested</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// è½¬æ¢å“åº”ä½“</span>
    response<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token function">transformData</span><span class="token punctuation">(</span>
      response<span class="token punctuation">.</span>data<span class="token punctuation">,</span>
      response<span class="token punctuation">.</span>headers<span class="token punctuation">,</span>
      config<span class="token punctuation">.</span>transformResponse
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> response<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token function">onAdapterRejection</span><span class="token punctuation">(</span><span class="token parameter">reason</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è¯·æ±‚å¤±è´¥çš„å›è°ƒ</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isCancel</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">throwIfCancellationRequested</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// è½¬æ¢å“åº”ä½“</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>reason <span class="token operator">&amp;&amp;</span> reason<span class="token punctuation">.</span>response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        reason<span class="token punctuation">.</span>response<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token function">transformData</span><span class="token punctuation">(</span>
          reason<span class="token punctuation">.</span>response<span class="token punctuation">.</span>data<span class="token punctuation">,</span>
          reason<span class="token punctuation">.</span>response<span class="token punctuation">.</span>headers<span class="token punctuation">,</span>
          config<span class="token punctuation">.</span>transformResponse
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>å¤§å®¶æ³¨æ„æ³¨é‡Šçš„ç¬¬ä¸€è¡Œï¼Œâ€œè‹¥ç”¨æˆ·æœªæ‰‹åŠ¨é…ç½®é€‚é…å™¨ï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„é€‚é…å™¨â€ã€‚æ‰‹åŠ¨é…ç½®é€‚é…å™¨å…è®¸æˆ‘ä»¬è‡ªå®šä¹‰å¤„ç†è¯·æ±‚ï¼Œä¸»è¦ç›®çš„æ˜¯ä¸ºäº†ä½¿æµ‹è¯•æ›´è½»æ¾ã€‚</p> <blockquote><p>å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨é»˜è®¤é€‚é…å™¨çš„é¢‘ç‡æ›´é«˜ã€‚é»˜è®¤é€‚é…å™¨åœ¨<a href="https://github.com/axios/axios/blob/master/lib/defaults.js" target="_blank" rel="noopener noreferrer"><code>axios/lib/default.js</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>é‡Œæ˜¯é€šè¿‡<code>getDefaultAdapter</code>æ–¹æ³•æ¥è·å–çš„ï¼š</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getDefaultAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> adapter<span class="token punctuation">;</span>
  <span class="token comment">// åˆ¤æ–­å½“å‰æ˜¯å¦æ˜¯nodeç¯å¢ƒ</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> process <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">&amp;&amp;</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>process<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'[object process]'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¦‚æœæ˜¯nodeç¯å¢ƒï¼Œè°ƒç”¨nodeä¸“å±çš„httpé€‚é…å™¨</span>
    adapter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./adapters/http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> XMLHttpRequest <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¦‚æœæ˜¯æµè§ˆå™¨ç¯å¢ƒï¼Œè°ƒç”¨åŸºäºxhrçš„é€‚é…å™¨</span>
    adapter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./adapters/xhr'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> adapter<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æˆ‘ä»¬å†æ¥çœ‹çœ‹ <code>Node</code> çš„ <code>http</code> é€‚é…å™¨å’Œ <code>xhr</code> é€‚é…å™¨å¤§æ¦‚é•¿å•¥æ ·ï¼š</p> <blockquote><p><code>http</code> é€‚é…å™¨ï¼š</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">httpAdapter</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">dispatchHttpRequest</span><span class="token punctuation">(</span><span class="token parameter">resolvePromise<span class="token punctuation">,</span> rejectPromise</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å…·ä½“é€»è¾‘</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><blockquote><p>xhr é€‚é…å™¨ï¼š</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">xhrAdapter</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">dispatchXhrRequest</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å…·ä½“é€»è¾‘</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>å…·ä½“é€»è¾‘å•¥æ ·ï¼Œå’±ä»¬ç›®å‰å…ˆä¸å…³å¿ƒï¼Œæœ‰å…´è¶£çš„åŒå­¦ï¼Œå¯ä»¥ç‹ ç‹ åœ°ç‚¹<a href="https://github.com/axios/axios/tree/master/lib/adapters" target="_blank" rel="noopener noreferrer">è¿™é‡Œ<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>é˜…è¯»æºç ã€‚å’±ä»¬ç°åœ¨å°±æ³¨æ„ä¸¤ä¸ªäº‹å„¿ï¼š</p></blockquote> <ul><li>ä¸¤ä¸ªé€‚é…å™¨çš„å…¥å‚éƒ½æ˜¯ <code>config</code>ï¼›</li> <li>ä¸¤ä¸ªé€‚é…å™¨çš„å‡ºå‚éƒ½æ˜¯ä¸€ä¸ª <code>Promise</code>ã€‚</li></ul> <blockquote><p>Tipsï¼šè¦æ˜¯ä»”ç»†è¯»äº†æºç ï¼Œä¼šå‘ç°ä¸¤ä¸ªé€‚é…å™¨ä¸­çš„ P<code>romise</code> çš„å†…éƒ¨ç»“æ„ä¹Ÿæ˜¯å¦‚å‡ºä¸€è¾™ã€‚</p></blockquote> <p>è¿™ä¹ˆä¸€æ¥ï¼Œé€šè¿‡ <code>axios</code> å‘èµ·è·¨å¹³å°çš„ç½‘ç»œè¯·æ±‚ï¼Œä¸ä»…è°ƒç”¨çš„æ¥å£åæ˜¯åŒä¸€ä¸ªï¼Œè¿å…¥å‚ã€å‡ºå‚çš„æ ¼å¼éƒ½åªéœ€è¦æŒæ¡åŒä¸€å¥—ã€‚è¿™å¯¼è‡´å®ƒçš„å­¦ä¹ æˆæœ¬éå¸¸ä½ï¼Œå¼€å‘è€…çœ‹äº†æ–‡æ¡£å°±èƒ½ä¸Šæ‰‹ï¼›åŒæ—¶å› ä¸ºè¶³å¤Ÿç®€å•ï¼Œåœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ä¹Ÿä¸å®¹æ˜“å‡ºé”™ï¼Œå¸¦æ¥äº†æä½³çš„ç”¨æˆ·ä½“éªŒï¼Œ<code>axios</code> ä¹Ÿå› æ­¤è¶Šæ¥è¶Šæµè¡Œã€‚</p> <p>è¿™æ­£æ˜¯ä¸€ä¸ªå¥½çš„é€‚é…å™¨çš„è‡ªæˆ‘ä¿®å…»â€”â€”æŠŠå˜åŒ–ç•™ç»™è‡ªå·±ï¼ŒæŠŠç»Ÿä¸€ç•™ç»™ç”¨æˆ·ã€‚åœ¨æ­¤å¤„ï¼Œæ‰€æœ‰å…³äº <code>http</code> æ¨¡å—ã€å…³äº <code>xhr</code> çš„å®ç°ç»†èŠ‚ï¼Œå…¨éƒ¨è¢« <code>Adapter</code> å°è£…è¿›äº†è‡ªå·±å¤æ‚çš„åº•å±‚é€»è¾‘é‡Œï¼Œæš´éœ²ç»™ç”¨æˆ·çš„éƒ½æ˜¯ååˆ†ç®€å•çš„ç»Ÿä¸€çš„ä¸œè¥¿â€”â€”ç»Ÿä¸€çš„æ¥å£ï¼Œç»Ÿä¸€çš„å…¥å‚ï¼Œç»Ÿä¸€çš„å‡ºå‚ï¼Œç»Ÿä¸€çš„è§„åˆ™ã€‚ç”¨èµ·æ¥å°±æ˜¯ä¸€ä¸ªå­— â€”â€” çˆ½ï¼</p> <h2 id="_5-ç»“æ„å‹-ä»£ç†æ¨¡å¼"><a href="#_5-ç»“æ„å‹-ä»£ç†æ¨¡å¼" class="header-anchor">#</a> 5 ç»“æ„å‹-ä»£ç†æ¨¡å¼</h2> <blockquote><p>ä»£ç†æ¨¡å¼ï¼Œå¼å¦‚å…¶åâ€”â€”åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå‡ºäºç§ç§è€ƒè™‘/é™åˆ¶ï¼Œä¸€ä¸ªå¯¹è±¡<strong>ä¸èƒ½ç›´æ¥è®¿é—®</strong>å¦ä¸€ä¸ªå¯¹è±¡ï¼Œéœ€è¦ä¸€ä¸ª<strong>ç¬¬ä¸‰è€…</strong>ï¼ˆä»£ç†ï¼‰ç‰µçº¿æ­æ¡¥ä»è€Œé—´æ¥è¾¾åˆ°è®¿é—®ç›®çš„ï¼Œè¿™æ ·çš„æ¨¡å¼å°±æ˜¯ä»£ç†æ¨¡å¼ã€‚</p></blockquote> <p>ä»£ç†æ¨¡å¼éå¸¸å¥½ç†è§£ï¼Œå› ä¸ºä½ å¯èƒ½å¤©å¤©éƒ½åœ¨ç”¨ï¼Œåªæ˜¯æ²¡æœ‰åˆ»æ„æŒ–æ˜è¿‡å®ƒèƒŒåçš„ç„æœºâ€”â€”æ¯”å¦‚å¤§å®¶è€³ç†Ÿèƒ½è¯¦çš„<strong>ç§‘å­¦ä¸Šç½‘</strong>ï¼Œå°±æ˜¯ä»£ç†æ¨¡å¼çš„å…¸å‹æ¡ˆä¾‹ã€‚</p> <h3 id="_5-1-es6ä¸­çš„proxy"><a href="#_5-1-es6ä¸­çš„proxy" class="header-anchor">#</a> 5.1 ES6ä¸­çš„Proxy</h3> <p>åœ¨ ES6 ä¸­ï¼Œæä¾›äº†ä¸“é—¨ä»¥ä»£ç†è§’è‰²å‡ºç°çš„ä»£ç†å™¨ â€”â€” <code>Proxy</code>ã€‚å®ƒçš„åŸºæœ¬ç”¨æ³•å¦‚ä¸‹ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
</code></pre></div><p>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æˆ‘ä»¬çš„ç›®æ ‡å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ä¸Šæ–‡ä¸­çš„â€œæœªçŸ¥å¦¹å­â€ã€‚<code>handler</code> ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨æ¥å®šä¹‰<strong>ä»£ç†çš„è¡Œä¸º</strong>ï¼Œç›¸å½“äºä¸Šæ–‡ä¸­çš„â€œå©šä»‹æ‰€â€ã€‚å½“æˆ‘ä»¬é€šè¿‡ <code>proxy</code> å»è®¿é—®ç›®æ ‡å¯¹è±¡çš„æ—¶å€™ï¼Œ<code>handler</code>ä¼šå¯¹æˆ‘ä»¬çš„è¡Œä¸ºä½œä¸€å±‚æ‹¦æˆªï¼Œæˆ‘ä»¬çš„æ¯æ¬¡è®¿é—®éƒ½éœ€è¦ç»è¿‡ <code>handler</code> è¿™ä¸ªç¬¬ä¸‰æ–¹ã€‚</p> <h3 id="_5-2-â€œå©šä»‹æ‰€â€çš„å®ç°"><a href="#_5-2-â€œå©šä»‹æ‰€â€çš„å®ç°" class="header-anchor">#</a> 5.2 â€œå©šä»‹æ‰€â€çš„å®ç°</h3> <p>æœªçŸ¥å¦¹å­çš„ä¸ªäººä¿¡æ¯ï¼Œåˆšé—®äº†ä¸‹æˆ‘ä»¬å·²ç»æ³¨å†Œäº† VIP çš„åŒäº‹å“¥ï¼Œå¤§è‡´å¦‚ä¸‹ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// æœªçŸ¥å¦¹å­</span>
<span class="token keyword">const</span> girl <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// å§“å</span>
  name<span class="token punctuation">:</span> <span class="token string">'å°ç¾'</span><span class="token punctuation">,</span>
  <span class="token comment">// è‡ªæˆ‘ä»‹ç»</span>
  aboutMe<span class="token punctuation">:</span> <span class="token string">'...'</span>ï¼ˆå¤§å®¶è‡ªè¡Œè„‘è¡¥å§ï¼‰
  <span class="token comment">// å¹´é¾„</span>
  age<span class="token punctuation">:</span> <span class="token number">24</span><span class="token punctuation">,</span>
  <span class="token comment">// èŒä¸š</span>
  career<span class="token punctuation">:</span> <span class="token string">'teacher'</span><span class="token punctuation">,</span>
  <span class="token comment">// å‡å¤´åƒ</span>
  fakeAvatar<span class="token punctuation">:</span> <span class="token string">'xxxx'</span><span class="token punctuation">(</span>æ–°å£ç»“è¡£çš„å›¾ç‰‡åœ°å€ï¼‰
  <span class="token comment">// çœŸå®å¤´åƒ</span>
  avatar<span class="token punctuation">:</span> <span class="token string">'xxxx'</span><span class="token punctuation">(</span>è‡ªå·±çš„ç…§ç‰‡åœ°å€<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token comment">// æ‰‹æœºå·</span>
  phone<span class="token punctuation">:</span> <span class="token number">123456</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å©šä»‹æ‰€æ”¶åˆ°äº†å°ç¾çš„ä¿¡æ¯ï¼Œå¼€å§‹è¥ä¸šã€‚å¤§å®¶æƒ³ï¼Œè¿™ä¸ªå§“åã€è‡ªæˆ‘ä»‹ç»ã€å‡å¤´åƒï¼Œè¿™äº›ä¿¡æ¯å¤§å·®ä¸å·®ï¼Œæ›å…‰ä¸€ä¸‹æ²¡é—®é¢˜ã€‚ä½†æ˜¯äººå®¶å¦¹å­çš„å¹´é¾„ã€èŒä¸šã€çœŸå®å¤´åƒã€æ‰‹æœºå·ç ï¼Œæ˜¯ä¸æ˜¯å±äºéå¸¸ç§å¯†çš„ä¿¡æ¯äº†ï¼Ÿè¦æƒ³ get è¿™äº›ä¿¡æ¯ï¼Œå¹³å°è¦è€ƒéªŒä¸€ä¸‹ä½ çš„è¯šæ„äº† â€”â€” é¦–å…ˆï¼Œä½ æ˜¯ä¸æ˜¯å·²ç»é€šè¿‡äº†å®åå®¡æ ¸ï¼Ÿå¦‚æœé€šè¿‡å®åå®¡æ ¸ï¼Œé‚£ä¹ˆä½ å¯ä»¥æŸ¥çœ‹ä¸€äº›ç›¸å¯¹ç§å¯†çš„ä¿¡æ¯ï¼ˆå¹´é¾„ã€èŒä¸šï¼‰ã€‚ç„¶åï¼Œä½ æ˜¯ä¸æ˜¯ VIP ï¼Ÿåªæœ‰ VIP å¯ä»¥æŸ¥çœ‹çœŸå®ç…§ç‰‡å’Œè”ç³»æ–¹å¼ã€‚æ»¡è¶³äº†è¿™ä¸¤ä¸ªåˆ¤å®šæ¡ä»¶ï¼Œä½ æ‰å¯ä»¥é¡ºåˆ©è®¿é—®åˆ°åˆ«äººçš„å…¨éƒ¨ç§äººä¿¡æ¯ï¼Œä¸ç„¶ï¼Œå°±åŠé€€ä½ æé†’ä½ å»å®Œæˆè®¤è¯å’ŒVIPè´­ä¹°å†æ¥ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// æ™®é€šç§å¯†ä¿¡æ¯</span>
<span class="token keyword">const</span> baseInfo <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'career'</span><span class="token punctuation">]</span>
<span class="token comment">// æœ€ç§å¯†ä¿¡æ¯</span>
<span class="token keyword">const</span> privateInfo <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'avatar'</span><span class="token punctuation">,</span> <span class="token string">'phone'</span><span class="token punctuation">]</span>

<span class="token comment">// ç”¨æˆ·ï¼ˆåŒäº‹Aï¼‰å¯¹è±¡å®ä¾‹</span>
<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span><span class="token punctuation">(</span>ä¸€äº›å¿…è¦çš„ä¸ªäººä¿¡æ¯<span class="token punctuation">)</span>
  isValidated<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  isVIP<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// å©šä»‹æ‰€ç™»åœºäº†</span>
<span class="token keyword">const</span> lovers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>girl<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">get</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">girl<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>baseInfo<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token operator">!==</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>user<span class="token punctuation">.</span>isValidated<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'æ‚¨è¿˜æ²¡æœ‰å®ŒæˆéªŒè¯å“¦'</span><span class="token punctuation">)</span>
          <span class="token keyword">return</span>
      <span class="token punctuation">}</span>

      <span class="token comment">//...(æ­¤å¤„çœç•¥å…¶å®ƒæœ‰çš„æ²¡çš„å„ç§æ ¡éªŒé€»è¾‘)</span>

      <span class="token comment">// æ­¤å¤„æˆ‘ä»¬è®¤ä¸ºåªæœ‰éªŒè¯è¿‡çš„ç”¨æˆ·æ‰å¯ä»¥è´­ä¹°VIP</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>isValidated <span class="token operator">&amp;&amp;</span> privateInfo<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>user<span class="token punctuation">.</span>isVIP<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'åªæœ‰VIPæ‰å¯ä»¥æŸ¥çœ‹è¯¥ä¿¡æ¯å“¦'</span><span class="token punctuation">)</span>
          <span class="token keyword">return</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><blockquote><p>ä»¥ä¸Šä¸»è¦æ˜¯ <code>getter</code> å±‚é¢çš„æ‹¦æˆªã€‚å‡è®¾æˆ‘ä»¬è¿˜å…è®¸ä¼šå‘˜é—´äº’é€ç¤¼ç‰©ï¼Œæ¯ä¸ªä¼šå‘˜å¯ä»¥å‘ŠçŸ¥å©šä»‹æ‰€è‡ªå·±æ„¿æ„æ¥å—çš„ç¤¼ç‰©çš„ä»·æ ¼ä¸‹é™ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½œ <code>setter</code> å±‚é¢çš„æ‹¦æˆªã€‚ï¼š</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// è§„å®šç¤¼ç‰©çš„æ•°æ®ç»“æ„ç”±typeå’Œvalueç»„æˆ</span>
<span class="token keyword">const</span> present <span class="token operator">=</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token string">'å·§å…‹åŠ›'</span><span class="token punctuation">,</span>
    value<span class="token punctuation">:</span> <span class="token number">60</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// ä¸ºç”¨æˆ·å¢å¼€presentså­—æ®µå­˜å‚¨ç¤¼ç‰©</span>
<span class="token keyword">const</span> girl <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// å§“å</span>
  name<span class="token punctuation">:</span> <span class="token string">'å°ç¾'</span><span class="token punctuation">,</span>
  <span class="token comment">// è‡ªæˆ‘ä»‹ç»</span>
  aboutMe<span class="token punctuation">:</span> <span class="token string">'...'</span>ï¼ˆå¤§å®¶è‡ªè¡Œè„‘è¡¥å§ï¼‰
  <span class="token comment">// å¹´é¾„</span>
  age<span class="token punctuation">:</span> <span class="token number">24</span><span class="token punctuation">,</span>
  <span class="token comment">// èŒä¸š</span>
  career<span class="token punctuation">:</span> <span class="token string">'teacher'</span><span class="token punctuation">,</span>
  <span class="token comment">// å‡å¤´åƒ</span>
  fakeAvatar<span class="token punctuation">:</span> <span class="token string">'xxxx'</span><span class="token punctuation">(</span>æ–°å£ç»“è¡£çš„å›¾ç‰‡åœ°å€ï¼‰
  <span class="token comment">// çœŸå®å¤´åƒ</span>
  avatar<span class="token punctuation">:</span> <span class="token string">'xxxx'</span><span class="token punctuation">(</span>è‡ªå·±çš„ç…§ç‰‡åœ°å€<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token comment">// æ‰‹æœºå·</span>
  phone<span class="token punctuation">:</span> <span class="token number">123456</span><span class="token punctuation">,</span>
  <span class="token comment">// ç¤¼ç‰©æ•°ç»„</span>
  presents<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// æ‹’æ”¶50å—ä»¥ä¸‹çš„ç¤¼ç‰©</span>
  bottomValue<span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
  <span class="token comment">// è®°å½•æœ€è¿‘ä¸€æ¬¡æ”¶åˆ°çš„ç¤¼ç‰©</span>
  lastPresent<span class="token punctuation">:</span> present<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// å©šä»‹æ‰€æ¨å‡ºäº†å°ç¤¼ç‰©åŠŸèƒ½</span>
<span class="token keyword">const</span> lovers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>girl<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">get</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">girl<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>baseInfo<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token operator">!==</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>user<span class="token punctuation">.</span>isValidated<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'æ‚¨è¿˜æ²¡æœ‰å®ŒæˆéªŒè¯å“¦'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//...(æ­¤å¤„çœç•¥å…¶å®ƒæœ‰çš„æ²¡çš„å„ç§æ ¡éªŒé€»è¾‘)</span>

    <span class="token comment">// æ­¤å¤„æˆ‘ä»¬è®¤ä¸ºåªæœ‰éªŒè¯è¿‡çš„ç”¨æˆ·æ‰å¯ä»¥è´­ä¹°VIP</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>isValidated <span class="token operator">&amp;&amp;</span> privateInfo<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>user<span class="token punctuation">.</span>isVIP<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'åªæœ‰VIPæ‰å¯ä»¥æŸ¥çœ‹è¯¥ä¿¡æ¯å“¦'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">set</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">girl<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æœ€è¿‘ä¸€æ¬¡é€æ¥çš„ç¤¼ç‰©ä¼šå°è¯•èµ‹å€¼ç»™lastPresentå­—æ®µ</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">'lastPresent'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>val<span class="token punctuation">.</span>value <span class="token operator">&lt;</span> girl<span class="token punctuation">.</span>bottomValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'sorryï¼Œæ‚¨çš„ç¤¼ç‰©è¢«æ‹’æ”¶äº†'</span><span class="token punctuation">)</span>
          <span class="token keyword">return</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// å¦‚æœæ²¡æœ‰æ‹’æ”¶ï¼Œåˆ™èµ‹å€¼æˆåŠŸï¼ŒåŒæ—¶å¹¶å…¥presentsæ•°ç»„</span>
      girl<span class="token punctuation">[</span>lastPresent<span class="token punctuation">]</span> <span class="token operator">=</span> val
      girl<span class="token punctuation">[</span>presents<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>presents<span class="token punctuation">,</span> val<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_5-3-äº‹ä»¶ä»£ç†"><a href="#_5-3-äº‹ä»¶ä»£ç†" class="header-anchor">#</a> 5.3 äº‹ä»¶ä»£ç†</h3> <blockquote><p>äº‹ä»¶ä»£ç†ï¼Œå¯èƒ½æ˜¯ä»£ç†æ¨¡å¼æœ€å¸¸è§çš„ä¸€ç§åº”ç”¨æ–¹å¼ï¼Œä¹Ÿæ˜¯ä¸€é“å®æ‰“å®çš„é«˜é¢‘é¢è¯•é¢˜ã€‚å®ƒçš„åœºæ™¯æ˜¯ä¸€ä¸ªçˆ¶å…ƒç´ ä¸‹æœ‰å¤šä¸ªå­å…ƒç´ ï¼Œåƒè¿™æ ·ï¼š</p></blockquote> <p>äº‹ä»¶ä»£ç†ï¼Œå¯èƒ½æ˜¯ä»£ç†æ¨¡å¼æœ€å¸¸è§çš„ä¸€ç§åº”ç”¨æ–¹å¼ï¼Œä¹Ÿæ˜¯ä¸€é“å®æ‰“å®çš„é«˜é¢‘é¢è¯•é¢˜ã€‚å®ƒçš„åœºæ™¯æ˜¯ä¸€ä¸ªçˆ¶å…ƒç´ ä¸‹æœ‰å¤šä¸ªå­å…ƒç´ ï¼Œåƒè¿™æ ·ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ie=edge<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>äº‹ä»¶ä»£ç†<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>father<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>é“¾æ¥1å·<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>é“¾æ¥2å·<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>é“¾æ¥3å·<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>é“¾æ¥4å·<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>é“¾æ¥5å·<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>é“¾æ¥6å·<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>æˆ‘ä»¬ç°åœ¨çš„éœ€æ±‚æ˜¯ï¼Œå¸Œæœ›é¼ æ ‡ç‚¹å‡»æ¯ä¸ª a æ ‡ç­¾ï¼Œéƒ½å¯ä»¥å¼¹å‡ºâ€œæˆ‘æ˜¯xxxâ€è¿™æ ·çš„æç¤ºã€‚æ¯”å¦‚ç‚¹å‡»ç¬¬ä¸€ä¸ª a æ ‡ç­¾ï¼Œå¼¹å‡ºâ€œæˆ‘æ˜¯é“¾æ¥1å·â€è¿™æ ·çš„æç¤ºã€‚è¿™æ„å‘³ç€æˆ‘ä»¬è‡³å°‘è¦å®‰è£… <code>6</code> ä¸ªç›‘å¬å‡½æ•°ç»™ <code>6</code> ä¸ªä¸åŒçš„çš„å…ƒç´ (ä¸€èˆ¬æˆ‘ä»¬ä¼šç”¨å¾ªç¯ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼‰ï¼Œå¦‚æœæˆ‘ä»¬çš„ <code>a</code> æ ‡ç­¾è¿›ä¸€æ­¥å¢å¤šï¼Œé‚£ä¹ˆæ€§èƒ½çš„å¼€é”€ä¼šæ›´å¤§ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å‡å¦‚ä¸ç”¨ä»£ç†æ¨¡å¼ï¼Œæˆ‘ä»¬å°†å¾ªç¯å®‰è£…ç›‘å¬å‡½æ•°</span>
<span class="token keyword">const</span> aNodes <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'father'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> aLength <span class="token operator">=</span> aNodes<span class="token punctuation">.</span>length

<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>aLength<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    aNodes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">æˆ‘æ˜¯</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>aNodes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>innerText<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>è€ƒè™‘åˆ°äº‹ä»¶æœ¬èº«å…·æœ‰â€œå†’æ³¡â€çš„ç‰¹æ€§ï¼Œå½“æˆ‘ä»¬ç‚¹å‡» a å…ƒç´ æ—¶ï¼Œç‚¹å‡»äº‹ä»¶ä¼šâ€œå†’æ³¡â€åˆ°çˆ¶å…ƒç´  div ä¸Šï¼Œä»è€Œè¢«ç›‘å¬åˆ°ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œç‚¹å‡»äº‹ä»¶çš„ç›‘å¬å‡½æ•°åªéœ€è¦åœ¨ div å…ƒç´ ä¸Šè¢«ç»‘å®šä¸€æ¬¡å³å¯ï¼Œè€Œä¸éœ€è¦åœ¨å­å…ƒç´ ä¸Šè¢«ç»‘å®š N æ¬¡â€”â€”è¿™ç§åšæ³•å°±æ˜¯äº‹ä»¶ä»£ç†ï¼Œå®ƒå¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šæé«˜æˆ‘ä»¬ä»£ç çš„æ€§èƒ½ã€‚</p></blockquote> <p><strong>äº‹ä»¶ä»£ç†çš„å®ç°</strong></p> <p>ç”¨ä»£ç†æ¨¡å¼å®ç°å¤šä¸ªå­å…ƒç´ çš„äº‹ä»¶ç›‘å¬ï¼Œä»£ç ä¼šç®€å•å¾ˆå¤šï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// è·å–çˆ¶å…ƒç´ </span>
<span class="token keyword">const</span> father <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'father'</span><span class="token punctuation">)</span>

<span class="token comment">// ç»™çˆ¶å…ƒç´ å®‰è£…ä¸€æ¬¡ç›‘å¬å‡½æ•°</span>
father<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è¯†åˆ«æ˜¯å¦æ˜¯ç›®æ ‡å­å…ƒç´ </span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>tagName <span class="token operator">===</span> <span class="token string">'A'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ä»¥ä¸‹æ˜¯ç›‘å¬å‡½æ•°çš„å‡½æ•°ä½“</span>
        e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">æˆ‘æ˜¯</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>innerText<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div><p>åœ¨è¿™ç§åšæ³•ä¸‹ï¼Œæˆ‘ä»¬çš„ç‚¹å‡»æ“ä½œå¹¶ä¸ä¼šç›´æ¥è§¦åŠç›®æ ‡å­å…ƒç´ ï¼Œè€Œæ˜¯ç”±çˆ¶å…ƒç´ å¯¹äº‹ä»¶è¿›è¡Œå¤„ç†å’Œåˆ†å‘ã€é—´æ¥åœ°å°†å…¶ä½œç”¨äºå­å…ƒç´ ï¼Œå› æ­¤è¿™ç§æ“ä½œä»æ¨¡å¼ä¸Šåˆ’åˆ†å±äºä»£ç†æ¨¡å¼ã€‚</p> <h3 id="_5-4-è™šæ‹Ÿä»£ç†"><a href="#_5-4-è™šæ‹Ÿä»£ç†" class="header-anchor">#</a> 5.4 è™šæ‹Ÿä»£ç†</h3> <p>ç®€å•åœ°ç»™å¤§å®¶æè¿°ä¸€ä¸‹æ‡’åŠ è½½æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ï¼šå®ƒæ˜¯é’ˆå¯¹å›¾ç‰‡åŠ è½½æ—¶æœºçš„ä¼˜åŒ–ï¼šåœ¨ä¸€äº›å›¾ç‰‡é‡æ¯”è¾ƒå¤§çš„ç½‘ç«™ï¼Œæ¯”å¦‚ç”µå•†ç½‘ç«™é¦–é¡µï¼Œæˆ–è€…å›¢è´­ç½‘ç«™ã€å°æ¸¸æˆé¦–é¡µç­‰ã€‚å¦‚æœæˆ‘ä»¬å°è¯•åœ¨ç”¨æˆ·æ‰“å¼€é¡µé¢çš„æ—¶å€™ï¼Œå°±æŠŠæ‰€æœ‰çš„å›¾ç‰‡èµ„æºåŠ è½½å®Œæ¯•ï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½ä¼šé€ æˆç™½å±ã€å¡é¡¿ç­‰ç°è±¡ã€‚</p> <p>æ­¤æ—¶æˆ‘ä»¬ä¼šé‡‡å–â€œå…ˆå ä½ã€ååŠ è½½â€çš„æ–¹å¼æ¥å±•ç¤ºå›¾ç‰‡ â€”â€” åœ¨å…ƒç´ éœ²å‡ºä¹‹å‰ï¼Œæˆ‘ä»¬ç»™å®ƒä¸€ä¸ª div ä½œå ä½ï¼Œå½“å®ƒæ»šåŠ¨åˆ°å¯è§†åŒºåŸŸå†…æ—¶ï¼Œå†å³æ—¶åœ°å»åŠ è½½çœŸå®çš„å›¾ç‰‡èµ„æºï¼Œè¿™æ ·åšæ—¢å‡è½»äº†æ€§èƒ½å‹åŠ›ã€åˆä¿ä½äº†ç”¨æˆ·ä½“éªŒã€‚</p> <p>é™¤äº†å›¾ç‰‡æ‡’åŠ è½½ï¼Œè¿˜æœ‰ä¸€ç§æ“ä½œå«<strong>å›¾ç‰‡é¢„åŠ è½½</strong>ã€‚é¢„åŠ è½½ä¸»è¦æ˜¯ä¸ºäº†é¿å…ç½‘ç»œä¸å¥½ã€æˆ–è€…å›¾ç‰‡å¤ªå¤§æ—¶ï¼Œé¡µé¢é•¿æ—¶é—´ç»™ç”¨æˆ·ç•™ç™½çš„å°´å°¬ã€‚å¸¸è§çš„æ“ä½œæ˜¯å…ˆè®©è¿™ä¸ª img æ ‡ç­¾å±•ç¤ºä¸€ä¸ªå ä½å›¾ï¼Œç„¶ååˆ›å»ºä¸€ä¸ª Image å®ä¾‹ï¼Œè®©è¿™ä¸ª Image å®ä¾‹çš„ src æŒ‡å‘çœŸå®çš„ç›®æ ‡å›¾ç‰‡åœ°å€ã€è§‚å¯Ÿè¯¥ Image å®ä¾‹çš„åŠ è½½æƒ…å†µ â€”â€” å½“å…¶å¯¹åº”çš„çœŸå®å›¾ç‰‡åŠ è½½å®Œæ¯•åï¼Œå³å·²ç»æœ‰äº†è¯¥å›¾ç‰‡çš„ç¼“å­˜å†…å®¹ï¼Œå†å°† DOM ä¸Šçš„ img å…ƒç´ çš„ src æŒ‡å‘çœŸå®çš„ç›®æ ‡å›¾ç‰‡åœ°å€ã€‚æ­¤æ—¶æˆ‘ä»¬ç›´æ¥å»å–äº†ç›®æ ‡å›¾ç‰‡çš„ç¼“å­˜ï¼Œæ‰€ä»¥å±•ç¤ºé€Ÿåº¦ä¼šéå¸¸å¿«ï¼Œä»å ä½å›¾åˆ°ç›®æ ‡å›¾ç‰‡çš„æ—¶é—´å·®ä¼šéå¸¸å°ã€å°åˆ°ç”¨æˆ·æ³¨æ„ä¸åˆ°ï¼Œè¿™æ ·ä½“éªŒå°±ä¼šéå¸¸å¥½äº†ã€‚</p> <p>ä¸Šé¢çš„æ€è·¯ï¼Œæˆ‘ä»¬å¯ä»¥ä¸å‡æ€ç´¢åœ°å®ç°å¦‚ä¸‹</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">PreLoadImage</span> <span class="token punctuation">{</span>
    <span class="token comment">// å ä½å›¾çš„urlåœ°å€</span>
    <span class="token keyword">static</span> <span class="token constant">LOADING_URL</span> <span class="token operator">=</span> <span class="token string">'xxxxxx'</span>

    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">imgNode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è·å–è¯¥å®ä¾‹å¯¹åº”çš„DOMèŠ‚ç‚¹</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>imgNode <span class="token operator">=</span> imgNode
    <span class="token punctuation">}</span>

    <span class="token comment">// è¯¥æ–¹æ³•ç”¨äºè®¾ç½®çœŸå®çš„å›¾ç‰‡åœ°å€</span>
    <span class="token function">setSrc</span><span class="token punctuation">(</span><span class="token parameter">targetUrl</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// imgèŠ‚ç‚¹åˆå§‹åŒ–æ—¶å±•ç¤ºçš„æ˜¯ä¸€ä¸ªå ä½å›¾</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>imgNode<span class="token punctuation">.</span>src <span class="token operator">=</span> PreLoadImage<span class="token punctuation">.</span><span class="token constant">LOADING_URL</span>
        <span class="token comment">// åˆ›å»ºä¸€ä¸ªå¸®æˆ‘ä»¬åŠ è½½å›¾ç‰‡çš„Imageå®ä¾‹</span>
        <span class="token keyword">const</span> image <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// ç›‘å¬ç›®æ ‡å›¾ç‰‡åŠ è½½çš„æƒ…å†µï¼Œå®Œæˆæ—¶å†å°†DOMä¸Šçš„imgèŠ‚ç‚¹çš„srcå±æ€§è®¾ç½®ä¸ºç›®æ ‡å›¾ç‰‡çš„url</span>
        image<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>imgNode<span class="token punctuation">.</span>src <span class="token operator">=</span> targetUrl
        <span class="token punctuation">}</span>
        <span class="token comment">// è®¾ç½®srcå±æ€§ï¼ŒImageå®ä¾‹å¼€å§‹åŠ è½½å›¾ç‰‡</span>
        image<span class="token punctuation">.</span>src <span class="token operator">=</span> srcUrl
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™ä¸ª <code>PreLoadImage</code> ä¹ä¸€çœ‹æ²¡é—®é¢˜ï¼Œä½†å…¶å®è¿åäº†æˆ‘ä»¬è®¾è®¡åŸåˆ™ä¸­çš„<strong>å•ä¸€èŒè´£åŸåˆ™</strong>ã€‚<code>PreLoadImage</code> ä¸ä»…è¦è´Ÿè´£å›¾ç‰‡çš„åŠ è½½ï¼Œè¿˜è¦è´Ÿè´£ <code>DOM</code> å±‚é¢çš„æ“ä½œï¼ˆimg èŠ‚ç‚¹çš„åˆå§‹åŒ–å’Œåç»­çš„æ”¹å˜ï¼‰ã€‚è¿™æ ·ä¸€æ¥ï¼Œå°±<strong>å‡ºç°äº†ä¸¤ä¸ªå¯èƒ½å¯¼è‡´è¿™ä¸ªç±»å‘ç”Ÿå˜åŒ–çš„åŸå› </strong>ã€‚</p> <blockquote><p>å¥½çš„åšæ³•æ˜¯å°†ä¸¤ä¸ªé€»è¾‘åˆ†ç¦»ï¼Œè®© <code>PreLoadImage</code> ä¸“å¿ƒå»åš DOM å±‚é¢çš„äº‹æƒ…ï¼ˆçœŸå® DOM èŠ‚ç‚¹çš„è·å–ã€img èŠ‚ç‚¹çš„é“¾æ¥è®¾ç½®ï¼‰ï¼Œå†æ‰¾ä¸€ä¸ªå¯¹è±¡æ¥ä¸“é—¨æ¥å¸®æˆ‘ä»¬æåŠ è½½â€”â€”è¿™ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´ç¼ºä¸ªåª’å©†ï¼Œè¿™åª’å©†éä»£ç†å™¨ä¸å¯ï¼š</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">PreLoadImage</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">imgNode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è·å–çœŸå®çš„DOMèŠ‚ç‚¹</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>imgNode <span class="token operator">=</span> imgNode
    <span class="token punctuation">}</span>

    <span class="token comment">// æ“ä½œimgèŠ‚ç‚¹çš„srcå±æ€§</span>
    <span class="token function">setSrc</span><span class="token punctuation">(</span><span class="token parameter">imgUrl</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>imgNode<span class="token punctuation">.</span>src <span class="token operator">=</span> imgUrl
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">ProxyImage</span> <span class="token punctuation">{</span>
    <span class="token comment">// å ä½å›¾çš„urlåœ°å€</span>
    <span class="token keyword">static</span> <span class="token constant">LOADING_URL</span> <span class="token operator">=</span> <span class="token string">'xxxxxx'</span>

    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">targetImage</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ç›®æ ‡Imageï¼Œå³PreLoadImageå®ä¾‹</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>targetImage <span class="token operator">=</span> targetImage
    <span class="token punctuation">}</span>

    <span class="token comment">// è¯¥æ–¹æ³•ä¸»è¦æ“ä½œè™šæ‹ŸImageï¼Œå®ŒæˆåŠ è½½</span>
    <span class="token function">setSrc</span><span class="token punctuation">(</span><span class="token parameter">targetUrl</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token comment">// çœŸå®imgèŠ‚ç‚¹åˆå§‹åŒ–æ—¶å±•ç¤ºçš„æ˜¯ä¸€ä¸ªå ä½å›¾</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>targetImage<span class="token punctuation">.</span><span class="token function">setSrc</span><span class="token punctuation">(</span>ProxyImage<span class="token punctuation">.</span><span class="token constant">LOADING_URL</span><span class="token punctuation">)</span>
        <span class="token comment">// åˆ›å»ºä¸€ä¸ªå¸®æˆ‘ä»¬åŠ è½½å›¾ç‰‡çš„è™šæ‹ŸImageå®ä¾‹</span>
        <span class="token keyword">const</span> virtualImage <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// ç›‘å¬ç›®æ ‡å›¾ç‰‡åŠ è½½çš„æƒ…å†µï¼Œå®Œæˆæ—¶å†å°†DOMä¸Šçš„çœŸå®imgèŠ‚ç‚¹çš„srcå±æ€§è®¾ç½®ä¸ºç›®æ ‡å›¾ç‰‡çš„url</span>
        virtualImage<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>targetImage<span class="token punctuation">.</span><span class="token function">setSrc</span><span class="token punctuation">(</span>targetUrl<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// è®¾ç½®srcå±æ€§ï¼Œè™šæ‹ŸImageå®ä¾‹å¼€å§‹åŠ è½½å›¾ç‰‡</span>
        virtualImage<span class="token punctuation">.</span>src <span class="token operator">=</span> targetUrl
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p><code>ProxyImage</code> å¸®æˆ‘ä»¬è°ƒåº¦äº†é¢„åŠ è½½ç›¸å…³çš„å·¥ä½œï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>ProxyImage</code> è¿™ä¸ªä»£ç†ï¼Œå®ç°å¯¹çœŸå® img èŠ‚ç‚¹çš„é—´æ¥è®¿é—®ï¼Œå¹¶å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœã€‚</p></blockquote> <p>åœ¨è¿™ä¸ªå®ä¾‹ä¸­ï¼Œ<code>virtualImage</code> è¿™ä¸ªå¯¹è±¡æ˜¯ä¸€ä¸ªâ€œå¹•åè‹±é›„â€ï¼Œå®ƒå§‹ç»ˆå­˜åœ¨äº JavaScript ä¸–ç•Œä¸­ã€ä»£æ›¿çœŸå® DOM å‘èµ·äº†å›¾ç‰‡åŠ è½½è¯·æ±‚ã€å®Œæˆäº†å›¾ç‰‡åŠ è½½å·¥ä½œï¼Œå´ä»æœªåœ¨æ¸²æŸ“å±‚é¢æŠ›å¤´éœ²é¢ã€‚å› æ­¤è¿™ç§æ¨¡å¼è¢«ç§°ä¸ºâ€œè™šæ‹Ÿä»£ç†â€æ¨¡å¼ã€‚</p> <h3 id="_5-5-ç¼“å­˜ä»£ç†"><a href="#_5-5-ç¼“å­˜ä»£ç†" class="header-anchor">#</a> 5.5 ç¼“å­˜ä»£ç†</h3> <blockquote><p>ç¼“å­˜ä»£ç†æ¯”è¾ƒå¥½ç†è§£ï¼Œå®ƒåº”ç”¨äºä¸€äº›è®¡ç®—é‡è¾ƒå¤§çš„åœºæ™¯é‡Œã€‚åœ¨è¿™ç§åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦â€œç”¨ç©ºé—´æ¢æ—¶é—´â€â€”â€”å½“æˆ‘ä»¬éœ€è¦ç”¨åˆ°æŸä¸ªå·²ç»è®¡ç®—è¿‡çš„å€¼çš„æ—¶å€™ï¼Œä¸æƒ³å†è€—æ—¶è¿›è¡ŒäºŒæ¬¡è®¡ç®—ï¼Œè€Œæ˜¯å¸Œæœ›èƒ½ä»å†…å­˜é‡Œå»å–å‡ºç°æˆçš„è®¡ç®—ç»“æœã€‚è¿™ç§åœºæ™¯ä¸‹ï¼Œå°±éœ€è¦ä¸€ä¸ªä»£ç†æ¥å¸®æˆ‘ä»¬åœ¨è¿›è¡Œè®¡ç®—çš„åŒæ—¶ï¼Œè¿›è¡Œè®¡ç®—ç»“æœçš„ç¼“å­˜äº†ã€‚</p></blockquote> <p>ä¸€ä¸ªæ¯”è¾ƒå…¸å‹çš„ä¾‹å­ï¼Œæ˜¯å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œæ±‚å’Œï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// addAllæ–¹æ³•ä¼šå¯¹ä½ ä¼ å…¥çš„æ‰€æœ‰å‚æ•°åšæ±‚å’Œæ“ä½œ</span>
<span class="token keyword">const</span> <span class="token function-variable function">addAll</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'è¿›è¡Œäº†ä¸€æ¬¡æ–°è®¡ç®—'</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">const</span> len <span class="token operator">=</span> arguments<span class="token punctuation">.</span>length
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        result <span class="token operator">+=</span> arguments<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> result
<span class="token punctuation">}</span>

<span class="token comment">// ä¸ºæ±‚å’Œæ–¹æ³•åˆ›å»ºä»£ç†</span>
<span class="token keyword">const</span> proxyAddAll <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// æ±‚å’Œç»“æœçš„ç¼“å­˜æ± </span>
    <span class="token keyword">const</span> resultCache <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å°†å…¥å‚è½¬åŒ–ä¸ºä¸€ä¸ªå”¯ä¸€çš„å…¥å‚å­—ç¬¦ä¸²</span>
        <span class="token keyword">const</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token string">','</span><span class="token punctuation">)</span>

        <span class="token comment">// æ£€æŸ¥æœ¬æ¬¡å…¥å‚æ˜¯å¦æœ‰å¯¹åº”çš„è®¡ç®—ç»“æœ</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>args <span class="token keyword">in</span> resultCache<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// å¦‚æœæœ‰ï¼Œåˆ™è¿”å›ç¼“å­˜æ± é‡Œç°æˆçš„ç»“æœ</span>
            <span class="token keyword">return</span> resultCache<span class="token punctuation">[</span>args<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> resultCache<span class="token punctuation">[</span>args<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">addAll</span><span class="token punctuation">(</span><span class="token operator">...</span>arguments<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>æˆ‘ä»¬æŠŠè¿™ä¸ªæ–¹æ³•ä¸¢è¿›æ§åˆ¶å°ï¼Œå°è¯•åŒä¸€å¥—å…¥å‚ä¸¤æ¬¡ï¼Œç»“æœå–œäººï¼š</p> <p><img src="http://img-repo.poetries.top/images/20210327190950.png" alt=""></p> <blockquote><p>æˆ‘ä»¬å‘ç° <code>proxyAddAll</code> é’ˆå¯¹é‡å¤çš„å…¥å‚åªä¼šè®¡ç®—ä¸€æ¬¡ï¼Œè¿™å°†å¤§å¤§èŠ‚çœè®¡ç®—è¿‡ç¨‹ä¸­çš„æ—¶é—´å¼€é”€ã€‚ç°åœ¨æˆ‘ä»¬æœ‰ 6 ä¸ªå…¥å‚ï¼Œå¯èƒ½è¿˜çœ‹ä¸å‡ºæ¥ï¼Œå½“æˆ‘ä»¬é’ˆå¯¹å¤§é‡å…¥å‚ã€åšåå¤è®¡ç®—æ—¶ï¼Œç¼“å­˜ä»£ç†çš„ä¼˜åŠ¿å°†å¾—åˆ°æ›´å……åˆ†çš„å‡¸æ˜¾ã€‚</p></blockquote> <h2 id="_6-è¡Œä¸ºå‹-ç­–ç•¥æ¨¡å¼"><a href="#_6-è¡Œä¸ºå‹-ç­–ç•¥æ¨¡å¼" class="header-anchor">#</a> 6 è¡Œä¸ºå‹-ç­–ç•¥æ¨¡å¼</h2> <blockquote><p>å®šä¹‰ä¸€ç³»åˆ—çš„ç®—æ³•,æŠŠå®ƒä»¬ä¸€ä¸ªä¸ªå°è£…èµ·æ¥, å¹¶ä¸”ä½¿å®ƒä»¬å¯ç›¸äº’æ›¿æ¢ã€‚</p></blockquote> <p><strong>ä¾‹å­</strong></p> <blockquote><p>å®šä¹‰ï¼šæ ¹æ®ä¸åŒå‚æ•°å¯ä»¥å‘½ä¸­ä¸åŒçš„ç­–ç•¥</p></blockquote> <ul><li>ä¼˜ç‚¹ï¼š</li></ul> <ul><li>èƒ½å‡å°‘å¤§é‡çš„ifè¯­å¥</li> <li>å¤ç”¨æ€§å¥½</li></ul> <ul><li>ä¼˜åŒ–ä½¿ç”¨ï¼š
<ul><li>å°è£…ä»£ç ï¼Œæš´éœ²æ–¹æ³•</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    xxx
<span class="token punctuation">}</span>

<span class="token keyword">import</span> xxx <span class="token keyword">from</span> <span class="token string">'x.js'</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> strategy <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'A'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">salary</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> salary <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token string">'B'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">salary</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> salary <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token string">'C'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">salary</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> salary <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">calculateBonus</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">level<span class="token punctuation">,</span> salary</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> strategy<span class="token punctuation">[</span>level<span class="token punctuation">]</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token constant">A</span> <span class="token operator">=</span> <span class="token function">calculateBonus</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">A</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 20000</span>

<span class="token comment">// æš´éœ²æ–¹æ³•</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    calculateBonus
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_6-1-å…ˆæ¥çœ‹ä¸€ä¸ªçœŸå®åœºæ™¯"><a href="#_6-1-å…ˆæ¥çœ‹ä¸€ä¸ªçœŸå®åœºæ™¯" class="header-anchor">#</a> 6.1 å…ˆæ¥çœ‹ä¸€ä¸ªçœŸå®åœºæ™¯</h3> <p>æœ‰ä¸€å¤©ï¼Œäº§å“ç»ç†éŸ©æ¢…æ¢…æ‰¾åˆ°æé›·ï¼Œç»™æé›·æäº†è¿™ä¹ˆä¸ªéœ€æ±‚ï¼š</p> <p>é©¬ä¸Šå¤§ä¿ƒè¦æ¥äº†ï¼Œæˆ‘ä»¬æœ¬æ¬¡å¤§ä¿ƒè¦åšå·®å¼‚åŒ–è¯¢ä»·ã€‚å•¥æ˜¯å·®å¼‚åŒ–è¯¢ä»·ï¼Ÿå°±æ˜¯è¯´åŒä¸€ä¸ªå•†å“ï¼Œæˆ‘é€šè¿‡åœ¨åå°ç»™å®ƒè®¾ç½®ä¸åŒçš„ä»·æ ¼ç±»å‹ï¼Œå¯ä»¥è®©å®ƒå±•ç¤ºä¸åŒçš„ä»·æ ¼ã€‚å…·ä½“çš„é€»è¾‘å¦‚ä¸‹ï¼š</p> <ul><li>å½“ä»·æ ¼ç±»å‹ä¸ºâ€œé¢„å”®ä»·â€æ—¶ï¼Œæ»¡ 100 - 20ï¼Œä¸æ»¡ 100 æ‰“ 9 æŠ˜</li> <li>å½“ä»·æ ¼ç±»å‹ä¸ºâ€œå¤§ä¿ƒä»·â€æ—¶ï¼Œæ»¡ 100 - 30ï¼Œä¸æ»¡ 100 æ‰“ 8 æŠ˜</li> <li>å½“ä»·æ ¼ç±»å‹ä¸ºâ€œè¿”åœºä»·â€æ—¶ï¼Œæ»¡ 200 - 50ï¼Œä¸å åŠ </li> <li>å½“ä»·æ ¼ç±»å‹ä¸ºâ€œå°é²œä»·â€æ—¶ï¼Œç›´æ¥æ‰“ 5 æŠ˜</li></ul> <p>æé›·æ‰«äº†ä¸€çœ¼ prdï¼Œç«‹åˆ»æ¥äº†ä¸»æ„ã€‚ä»–é¦–å…ˆå°†å››ç§ä»·æ ¼åšäº†æ ‡ç­¾åŒ–ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>é¢„å”®ä»· - pre
å¤§ä¿ƒä»· - onSale
è¿”åœºä»· - back
å°é²œä»· - fresh
</code></pre></div><p>æ¥ä¸‹æ¥æé›·ä»”ç»†ç ”è¯»äº† prd çš„å†…å®¹ï¼Œä½œä¸ºèµ„æ·± if-else ä¾ ï¼Œä»–ä¸‰ä¸‹äº”é™¤äºŒå°±å†™å‡ºä¸€å¥—åŠŸèƒ½å®Œå¤‡çš„ä»£ç ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// è¯¢ä»·æ–¹æ³•ï¼Œæ¥å—ä»·æ ¼æ ‡ç­¾å’ŒåŸä»·ä¸ºå…¥å‚</span>
<span class="token keyword">function</span> <span class="token function">askPrice</span><span class="token punctuation">(</span><span class="token parameter">tag<span class="token punctuation">,</span> originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token comment">// å¤„ç†é¢„çƒ­ä»·</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">'pre'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>originPrice <span class="token operator">&gt;=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">20</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.9</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å¤„ç†å¤§ä¿ƒä»·</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">'onSale'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>originPrice <span class="token operator">&gt;=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">30</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.8</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å¤„ç†è¿”åœºä»·</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">'back'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>originPrice <span class="token operator">&gt;=</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">50</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> originPrice
  <span class="token punctuation">}</span>

  <span class="token comment">// å¤„ç†å°é²œä»·</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">'fresh'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.5</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_6-2-if-else-ä¾ ï¼Œäººäººå–Šæ‰“"><a href="#_6-2-if-else-ä¾ ï¼Œäººäººå–Šæ‰“" class="header-anchor">#</a> 6.2 if-else ä¾ ï¼Œäººäººå–Šæ‰“</h3> <p>éšä¾¿è·‘ä¸€ä¸‹ï¼Œä¸Šè¿°ä»£ç è¿è¡Œèµ·æ¥ç¡®å®æ²¡å•¥æ¯›ç—…ã€‚ä½†ä¹Ÿåªæ˜¯â€œè¿è¡Œèµ·æ¥â€æ²¡æ¯›ç—…è€Œå·²ã€‚ä½œä¸ºäººäººå–Šæ‰“çš„ if-else ä¾ ï¼Œæé›·å¿…é¡»ä¸ºä»–çš„è¡Œä¸ºä»˜å‡ºä»£ä»·ã€‚æˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹è¿™ä¹ˆå†™ä»£ç ä¼šå¸¦æ¥ä»€ä¹ˆåæœï¼š</p> <ul><li>é¦–å…ˆï¼Œå®ƒè¿èƒŒäº†â€œå•ä¸€åŠŸèƒ½â€åŸåˆ™ã€‚ä¸€ä¸ª function é‡Œé¢ï¼Œå®ƒç«Ÿç„¶å¤„ç†äº†å››å¨é€»è¾‘â€”â€”è¿™ä¸ªå‡½æ•°çš„é€»è¾‘å¤ªèƒ–äº†ï¼è¿™æ ·ä¼šå¸¦æ¥ä»€ä¹ˆæ ·çš„ç³Ÿç³•åæœï¼Œç¬”è€…åœ¨å‰é¢çš„å°èŠ‚ä¸­å·²ç» BB è¿‡å¾ˆå¤šæ¬¡äº†ï¼šæ¯”å¦‚è¯´ä¸‡ä¸€å…¶ä¸­ä¸€è¡Œä»£ç å‡ºäº† Bugï¼Œé‚£ä¹ˆæ•´ä¸ªè¯¢ä»·é€»è¾‘éƒ½ä¼šå´©åï¼›ä¸æ­¤åŒæ—¶å‡ºäº† Bug ä½ å¾ˆéš¾å®šä½åˆ°åº•æ˜¯å“ªä¸ªä»£ç å—åäº†äº‹ï¼›å†æ¯”å¦‚è¯´å•ä¸ªèƒ½åŠ›å¾ˆéš¾è¢«æŠ½ç¦»å¤ç”¨ç­‰ç­‰ç­‰ç­‰ã€‚ç›¸ä¿¡è·Ÿç€æˆ‘ä¸€è·¯å­¦ä¸‹æ¥çš„å„ä½ï¼Œä¹Ÿå·²ç»åœ¨é‡é‡å®æˆ˜ä¸­å¯¹èƒ–é€»è¾‘çš„æ¶åŠ£å½±å“æœ‰äº†åˆ‡èº«çš„ä½“ä¼šã€‚æ€»ä¹‹ï¼Œè§åˆ°èƒ–é€»è¾‘ï¼Œæˆ‘ä»¬çš„ç¬¬ä¸€ååº”ï¼Œå°±æ˜¯ä¸€ä¸ªå­—â€”â€”æ‹†ï¼</li> <li>ä¸ä»…å¦‚æ­¤ï¼Œå®ƒè¿˜è¿èƒŒäº†â€œå¼€æ”¾å°é—­â€åŸåˆ™ã€‚å‡å¦‚æœ‰ä¸€å¤©éŸ©æ¢…æ¢…å†æ¬¡æ‰¾åˆ°æé›·ï¼Œè¦ä»–åŠ ä¸€ä¸ªæ»¡ 100 - 50 çš„â€œæ–°äººä»·â€æ€ä¹ˆåŠï¼Ÿä»–åªèƒ½ç»§ç»­ if-elseï¼š</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">askPrice</span><span class="token punctuation">(</span><span class="token parameter">tag<span class="token punctuation">,</span> originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token comment">// å¤„ç†é¢„çƒ­ä»·</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">'pre'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>originPrice <span class="token operator">&gt;=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">20</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.9</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// å¤„ç†å¤§ä¿ƒä»·</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">'onSale'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>originPrice <span class="token operator">&gt;=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">30</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.8</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å¤„ç†è¿”åœºä»·</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">'back'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>originPrice <span class="token operator">&gt;=</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">50</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> originPrice
  <span class="token punctuation">}</span>

  <span class="token comment">// å¤„ç†å°é²œä»·</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">'fresh'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.5</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å¤„ç†æ–°äººä»·</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">'newUser'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>originPrice <span class="token operator">&gt;=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">50</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> originPrice
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>æ²¡é”™ï¼Œæé›·ç°æºœæºœåœ°è·‘å»æ”¹äº† <code>askPrice</code> å‡½æ•°ï¼éšåä»–æ¬ä¸çŸ¥è€»åœ°å¾å¾è½¬å¤´ï¼Œå¯¹èƒŒåçš„æµ‹è¯•åŒå­¦è¯´ï¼šå“¥ï¼Œæˆ‘æ”¹äº†è¯¢ä»·å‡½æ•°ï¼Œéº»çƒ¦ä½ å¸®æˆ‘æŠŠ<strong>æ•´ä¸ªè¯¢ä»·é€»è¾‘</strong>å›å½’ä¸€ä¸‹ã€‚æµ‹è¯•åŒå­¦èå°”ä¸€ç¬‘ï¼Œ å¿ƒä¸­æ—©å·²æœ‰æ— æ•°å¤´ç¾Šé©¼åœ¨ç‹‚å¥”ã€‚ä»–å¼ºå¿ç€å‘¨æœ«åŠ ç­çš„æ‚²ç—›ï¼Œåšå®Œäº†è¿™æ¼«é•¿è€Œä¸å¿…è¦çš„å›å½’æµ‹è¯•ï¼Œéšåé»˜é»˜ç‚¹å‡»äº†åŒäº‹ç³»ç»Ÿé‡Œçš„ä¸¾æŠ¥æŒ‰é’®å¯¹æé›·è¯´ï¼šå“¥ï¼Œæ±‚ä½ å­¦å­¦è®¾è®¡æ¨¡å¼å§ï¼ï¼</p></blockquote> <h3 id="_6-3-é‡æ„è¯¢ä»·é€»è¾‘"><a href="#_6-3-é‡æ„è¯¢ä»·é€»è¾‘" class="header-anchor">#</a> 6.3 é‡æ„è¯¢ä»·é€»è¾‘</h3> <p>ç°åœ¨æˆ‘ä»¬åŸºäºæˆ‘ä»¬å·²ç»å­¦è¿‡çš„è®¾è®¡æ¨¡å¼æ€æƒ³ï¼Œä¸€ç‚¹ä¸€ç‚¹æ”¹é€ æ‰è¿™ä¸ªè‡ƒè‚¿çš„ askPriceã€‚</p> <p><strong>1. å•ä¸€åŠŸèƒ½æ”¹é€ </strong></p> <p>é¦–å…ˆï¼Œæˆ‘ä»¬èµ¶ç´§æŠŠå››ç§è¯¢ä»·é€»è¾‘æå‡ºæ¥ï¼Œè®©å®ƒä»¬å„è‡ªä¸ºæ”¿ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å¤„ç†é¢„çƒ­ä»·</span>
<span class="token keyword">function</span> <span class="token function">prePrice</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>originPrice <span class="token operator">&gt;=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">20</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.9</span>
<span class="token punctuation">}</span>

<span class="token comment">// å¤„ç†å¤§ä¿ƒä»·</span>
<span class="token keyword">function</span> <span class="token function">onSalePrice</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>originPrice <span class="token operator">&gt;=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">30</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.8</span>
<span class="token punctuation">}</span>

<span class="token comment">// å¤„ç†è¿”åœºä»·</span>
<span class="token keyword">function</span> <span class="token function">backPrice</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>originPrice <span class="token operator">&gt;=</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">50</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> originPrice
<span class="token punctuation">}</span>

<span class="token comment">// å¤„ç†å°é²œä»·</span>
<span class="token keyword">function</span> <span class="token function">freshPrice</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.5</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">askPrice</span><span class="token punctuation">(</span><span class="token parameter">tag<span class="token punctuation">,</span> originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// å¤„ç†é¢„çƒ­ä»·</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">'pre'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">prePrice</span><span class="token punctuation">(</span>originPrice<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// å¤„ç†å¤§ä¿ƒä»·</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">'onSale'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">onSalePrice</span><span class="token punctuation">(</span>originPrice<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å¤„ç†è¿”åœºä»·</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">'back'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">backPrice</span><span class="token punctuation">(</span>originPrice<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å¤„ç†å°é²œä»·</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">'fresh'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">return</span> <span class="token function">freshPrice</span><span class="token punctuation">(</span>originPrice<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>OKï¼Œæˆ‘ä»¬ç°åœ¨è‡³å°‘åšåˆ°äº†ä¸€ä¸ªå‡½æ•°åªåšä¸€ä»¶äº‹ã€‚ç°åœ¨æ¯ä¸ªå‡½æ•°éƒ½æœ‰äº†è‡ªå·±æ˜ç¡®çš„ã€å•ä¸€çš„åˆ†å·¥ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>prePrice - å¤„ç†é¢„çƒ­ä»·
onSalePrice - å¤„ç†å¤§ä¿ƒä»·
backPrice - å¤„ç†è¿”åœºä»·
freshPrice - å¤„ç†å°é²œä»·
askPrice - åˆ†å‘è¯¢ä»·é€»è¾‘
</code></pre></div><p>å¦‚æ­¤ä¸€æ¥ï¼Œæˆ‘ä»¬åœ¨é‡åˆ° Bug æ—¶ï¼Œå°±å¯ä»¥åšåˆ°â€œå¤´ç—›åŒ»å¤´ï¼Œè„šç—›åŒ»è„šâ€ï¼Œè€Œä¸å¿…åœ¨åºå¤§çš„é€»è¾‘æµ·æ´‹é‡Œè´¹åŠ›å»å®šä½åˆ°åº•æ˜¯å“ªå—ä¸å¯¹ã€‚</p> <p>åŒæ—¶ï¼Œå¦‚æœæˆ‘åœ¨å¦ä¸€ä¸ªå‡½æ•°é‡Œä¹Ÿæƒ³ä½¿ç”¨æŸä¸ªè¯¢ä»·èƒ½åŠ›ï¼Œæ¯”å¦‚è¯´æˆ‘æƒ³è¯¢é¢„çƒ­ä»·ï¼Œé‚£æˆ‘ç›´æ¥æŠŠ prePrice è¿™ä¸ªå‡½æ•°æ‹¿å»è°ƒç”¨å°±æ˜¯äº†ï¼Œè€Œä¸å¿…åœ¨ askPrice è‚¥èƒ–çš„èº«èº¯é‡Œè‹¦è‹¦å¯»è§…ã€ç„¶åæå‡ºè¿™å—é€»è¾‘ã€æœ€åå†å¤åˆ¶ç²˜è´´åˆ°å¦ä¸€ä¸ªå‡½æ•°å»â€”â€”æ›´ä½•å†µä¸‡ä¸€å“ªå¤© askPrice é‡Œçš„é¢„çƒ­ä»·é€»è¾‘æ”¹äº†ï¼Œä½ è¿˜å¾—å†å¤åˆ¶ç²˜è´´ä¸€æ¬¡ï¼Œæ‰å¿ƒå•Šè€é“ï¼</p> <p>åˆ°è¿™é‡Œï¼Œåœ¨å•ä¸€åŠŸèƒ½åŸåˆ™çš„æŒ‡å¼•ä¸‹ï¼Œæˆ‘ä»¬å·²ç»è§£å†³äº†ä¸€åŠçš„é—®é¢˜ã€‚</p> <p>æˆ‘ä»¬ç°åœ¨æ¥æ‹ä¸€ä¸‹ï¼Œå…¶å®è¿™ä¸ªè¯¢ä»·é€»è¾‘æ•´ä½“ä¸Šæ¥çœ‹åªæœ‰ä¸¤ä¸ªå…³é”®åŠ¨ä½œï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>è¯¢ä»·é€»è¾‘çš„åˆ†å‘ â€”â€”&gt; è¯¢ä»·é€»è¾‘çš„æ‰§è¡Œ
</code></pre></div><p>åœ¨æ”¹é€ çš„ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬å·²ç»æŠŠâ€œè¯¢ä»·é€»è¾‘çš„æ‰§è¡Œâ€ç»™æ‘˜äº†å‡ºå»ï¼Œå¹¶ä¸”å®ç°äº†ä¸åŒè¯¢ä»·é€»è¾‘ä¹‹é—´çš„è§£è€¦ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±è¦æ‹¿â€œåˆ†å‘â€è¿™ä¸ªåŠ¨ä½œå¼€åˆ€ã€‚</p> <p><strong>2. å¼€æ”¾å°é—­æ”¹é€ </strong></p> <p>å‰©ä¸‹ä¸€åŠçš„é—®é¢˜æ˜¯å•¥å‘¢ï¼Ÿå°±æ˜¯å’±ä»¬ä¸Šé¢è¯´çš„é‚£ä¸ªæ–°äººä»·çš„é—®é¢˜â€”â€”è¿™ä¼šå„¿æˆ‘è¦æƒ³ç»™ askPrice å¢åŠ æ–°äººè¯¢ä»·é€»è¾‘ï¼Œæˆ‘è¯¥å’‹æ•´ï¼Ÿæˆ‘åªèƒ½è¿™ä¹ˆæ¥ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å¤„ç†é¢„çƒ­ä»·</span>
<span class="token keyword">function</span> <span class="token function">prePrice</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>originPrice <span class="token operator">&gt;=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">20</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.9</span>
<span class="token punctuation">}</span>

<span class="token comment">// å¤„ç†å¤§ä¿ƒä»·</span>
<span class="token keyword">function</span> <span class="token function">onSalePrice</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>originPrice <span class="token operator">&gt;=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">30</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.8</span>
<span class="token punctuation">}</span>

<span class="token comment">// å¤„ç†è¿”åœºä»·</span>
<span class="token keyword">function</span> <span class="token function">backPrice</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>originPrice <span class="token operator">&gt;=</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">50</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> originPrice
<span class="token punctuation">}</span>

<span class="token comment">// å¤„ç†å°é²œä»·</span>
<span class="token keyword">function</span> <span class="token function">freshPrice</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.5</span>
<span class="token punctuation">}</span>

<span class="token comment">// å¤„ç†æ–°äººä»·</span>
<span class="token keyword">function</span> <span class="token function">newUserPrice</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>originPrice <span class="token operator">&gt;=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">50</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> originPrice
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">askPrice</span><span class="token punctuation">(</span><span class="token parameter">tag<span class="token punctuation">,</span> originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// å¤„ç†é¢„çƒ­ä»·</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">'pre'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">prePrice</span><span class="token punctuation">(</span>originPrice<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// å¤„ç†å¤§ä¿ƒä»·</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">'onSale'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">onSalePrice</span><span class="token punctuation">(</span>originPrice<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å¤„ç†è¿”åœºä»·</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">'back'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">backPrice</span><span class="token punctuation">(</span>originPrice<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å¤„ç†å°é²œä»·</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">'fresh'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">return</span> <span class="token function">freshPrice</span><span class="token punctuation">(</span>originPrice<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å¤„ç†æ–°äººä»·</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">'newUser'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">return</span> <span class="token function">newUserPrice</span><span class="token punctuation">(</span>originPrice<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>åœ¨å¤–å±‚ï¼Œæˆ‘ä»¬ç¼–å†™ä¸€ä¸ª newUser å‡½æ•°ç”¨äºå¤„ç†æ–°äººä»·é€»è¾‘ï¼›åœ¨ askPrice é‡Œé¢ï¼Œæˆ‘ä»¬æ–°å¢äº†ä¸€ä¸ª if-else åˆ¤æ–­ã€‚å¯ä»¥çœ‹å‡ºï¼Œè¿™æ ·å…¶å®è¿˜æ˜¯åœ¨ä¿®æ”¹ askPrice çš„å‡½æ•°ä½“ï¼Œæ²¡æœ‰å®ç°â€œå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­â€çš„æ•ˆæœã€‚</p> <blockquote><p>é‚£ä¹ˆæˆ‘ä»¬åº”è¯¥æ€ä¹ˆåšï¼Ÿæˆ‘ä»¬ä»”ç»†æƒ³æƒ³ï¼Œæ¥¼ä¸Šç”¨äº†è¿™ä¹ˆå¤š if-elseï¼Œæˆ‘ä»¬çš„ç›®çš„åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯ä¸æ˜¯å°±æ˜¯ä¸ºäº†æŠŠ è¯¢ä»·æ ‡ç­¾-è¯¢ä»·å‡½æ•° è¿™ä¸ªæ˜ å°„å…³ç³»ç»™æ˜ç¡®ä¸‹æ¥ï¼Ÿé‚£ä¹ˆåœ¨ JS ä¸­ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆæ—¢èƒ½å¤Ÿæ—¢å¸®æˆ‘ä»¬æ˜ç¡®æ˜ å°„å…³ç³»ï¼ŒåŒæ—¶ä¸ç ´åä»£ç çš„çµæ´»æ€§çš„æ–¹æ³•å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯<strong>å¯¹è±¡æ˜ å°„</strong>ï¼</p></blockquote> <p>å’±ä»¬å®Œå…¨å¯ä»¥æŠŠè¯¢ä»·ç®—æ³•å…¨éƒ½æ”¶æ•›åˆ°ä¸€ä¸ªå¯¹è±¡é‡Œå»å˜›ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å®šä¹‰ä¸€ä¸ªè¯¢ä»·å¤„ç†å™¨å¯¹è±¡</span>
<span class="token keyword">const</span> priceProcessor <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">pre</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>originPrice <span class="token operator">&gt;=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.9</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">onSale</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>originPrice <span class="token operator">&gt;=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">30</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.8</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">back</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>originPrice <span class="token operator">&gt;=</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">50</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> originPrice<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">fresh</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.5</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>å½“æˆ‘ä»¬æƒ³ä½¿ç”¨å…¶ä¸­æŸä¸ªè¯¢ä»·ç®—æ³•çš„æ—¶å€™ï¼šé€šè¿‡æ ‡ç­¾åå»å®šä½å°±å¥½äº†ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// è¯¢ä»·å‡½æ•°</span>
<span class="token keyword">function</span> <span class="token function">askPrice</span><span class="token punctuation">(</span><span class="token parameter">tag<span class="token punctuation">,</span> originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> priceProcessor<span class="token punctuation">[</span>tag<span class="token punctuation">]</span><span class="token punctuation">(</span>originPrice<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>å¦‚æ­¤ä¸€æ¥ï¼ŒaskPrice å‡½æ•°é‡Œçš„ if-else å¤§å†›å½»åº•è¢«å’±ä»¬æ¶ˆç­äº†ã€‚è¿™æ—¶å€™å¦‚æœä½ éœ€è¦ä¸€ä¸ªæ–°äººä»·ï¼Œåªéœ€è¦ç»™ priceProcessor æ–°å¢ä¸€ä¸ªæ˜ å°„å…³ç³»ï¼š</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>priceProcessor<span class="token punctuation">.</span><span class="token function-variable function">newUser</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>originPrice <span class="token operator">&gt;=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">50</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> originPrice<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™æ ·ä¸€æ¥ï¼Œè¯¢ä»·é€»è¾‘çš„åˆ†å‘ä¹Ÿå˜æˆäº†ä¸€ä¸ªæ¸…æ¸…çˆ½çˆ½çš„è¿‡ç¨‹ã€‚å½“æé›·ä»¥è¿™ç§æ–¹å¼æ–°å¢ä¸€ä¸ªæ–°äººä»·çš„è¯¢ä»·é€»è¾‘çš„æ—¶å€™ï¼Œå°±å¯ä»¥åº•æ°”åè¶³åœ°å¯¹æµ‹è¯•åŒå­¦è¯´ï¼šè€å“¥ï¼Œæˆ‘æ”¹äº†è¯¢ä»·é€»è¾‘ï¼Œä½†æ˜¯æ”¹åŠ¨èŒƒå›´ä»…ä»…æ¶‰åŠåˆ°æ–°äººä»·ï¼Œæ˜¯ä¸€ä¸ªå•çº¯çš„åŠŸèƒ½å¢åŠ ã€‚æ‰€ä»¥ä½ åªæµ‹è¿™ä¸ªæ–°åŠŸèƒ½ç‚¹å°± OKï¼Œè€é€»è¾‘ä¸ç”¨ç®¡ï¼</p> <p>ä»æ­¤ï¼Œæé›·å°±ä»äººäººå–Šæ‰“çš„ if-else ä¾ ï¼Œæ‘‡èº«ä¸€å˜æˆä¸ºäº†æµ‹è¯•ä¹‹å‹ã€ä¸­å›½å¥½å¼€å‘ã€‚ä¸šåŠ¡ä»£ç é‡Œçš„è¯¢ä»·é€»è¾‘ï¼Œä¹Ÿå› ä¸ºæé›·åšå®ˆè®¾è®¡åŸåˆ™100å¹´ä¸åŠ¨æ‘‡ï¼Œè€Œå˜å¾—æ˜“è¯»ã€æ˜“ç»´æŠ¤ã€‚</p> <h3 id="_6-4-æ€»ç»“"><a href="#_6-4-æ€»ç»“" class="header-anchor">#</a> 6.4 æ€»ç»“</h3> <p>è¯´èµ·æ¥ä½ å¯èƒ½ä¸ç›¸ä¿¡ï¼Œå’±ä»¬ä¸Šé¢çš„æ•´ä¸ªé‡æ„çš„è¿‡ç¨‹ï¼Œå°±æ˜¯å¯¹ç­–ç•¥æ¨¡å¼çš„åº”ç”¨ã€‚</p> <p>ç°åœ¨å¤§å®¶æ¥å“å“ç­–ç•¥æ¨¡å¼çš„å®šä¹‰ï¼š</p> <blockquote><p>å®šä¹‰ä¸€ç³»åˆ—çš„ç®—æ³•,æŠŠå®ƒä»¬ä¸€ä¸ªä¸ªå°è£…èµ·æ¥, å¹¶ä¸”ä½¿å®ƒä»¬å¯ç›¸äº’æ›¿æ¢ã€‚</p></blockquote> <p>å›å¤´çœ‹çœ‹ï¼Œå’±ä»¬å¿™æ´»åˆ°ç°åœ¨ï¼Œæ˜¯ä¸æ˜¯å°±å¹²äº†è¿™äº‹å„¿ï¼Ÿ</p> <p>ä½†ä½ è¦ç›´æ¥è¯»è¿™å¥è¯ï¼Œå¯èƒ½ç¡®å®ä¼šæ‡µåœˆâ€”â€”å•¥æ˜¯ç®—æ³•ï¼Ÿå¦‚ä½•å°è£…ï¼Ÿå¯æ›¿æ¢åˆæ˜¯å’‹åšåˆ°çš„ï¼Ÿ</p> <p>å¦‚ä»Šä½ ä½ å·²ç»è‡ªå·±åŠ¨æ‰‹å®ç°äº†ç®—æ³•æå–ã€ç®—æ³•å°è£…ã€åˆ†å‘ä¼˜åŒ–çš„æ•´ä¸ªä¸€æ¡é¾™çš„æ“ä½œæµï¼Œç›¸ä¿¡é¢å¯¹è¿™æ¡å®šä¹‰ï¼Œä½ å¯ä»¥ä¼šå¿ƒä¸€ç¬‘â€”â€”ç®—æ³•ï¼Œå°±æ˜¯æˆ‘ä»¬è¿™ä¸ªåœºæ™¯ä¸­çš„è¯¢ä»·é€»è¾‘ï¼Œå®ƒä¹Ÿå¯ä»¥æ˜¯ä½ ä»»ä½•ä¸€ä¸ªåŠŸèƒ½å‡½æ•°çš„é€»è¾‘ï¼›â€œå°è£…â€å°±æ˜¯æŠŠæŸä¸€åŠŸèƒ½ç‚¹å¯¹åº”çš„é€»è¾‘ç»™æå‡ºæ¥ï¼›â€œå¯æ›¿æ¢â€å»ºç«‹åœ¨å°è£…çš„åŸºç¡€ä¸Šï¼Œåªæ˜¯è¯´è¿™ä¸ªâ€œæ›¿æ¢â€çš„åˆ¤æ–­è¿‡ç¨‹ï¼Œå’±ä»¬ä¸èƒ½ç›´æ¥æ€¼ if-elseï¼Œè€Œè¦è€ƒè™‘æ›´ä¼˜çš„æ˜ å°„æ–¹æ¡ˆã€‚</p> <h2 id="_7-è¡Œä¸ºå‹-çŠ¶æ€æ¨¡å¼"><a href="#_7-è¡Œä¸ºå‹-çŠ¶æ€æ¨¡å¼" class="header-anchor">#</a> 7 è¡Œä¸ºå‹-çŠ¶æ€æ¨¡å¼</h2> <h3 id="_7-1-ä¸€å°å’–å•¡æœºçš„è¯ç”Ÿ"><a href="#_7-1-ä¸€å°å’–å•¡æœºçš„è¯ç”Ÿ" class="header-anchor">#</a> 7.1 ä¸€å°å’–å•¡æœºçš„è¯ç”Ÿ</h3> <p>ä½œä¸ºä¸€ä¸ªå…·å¤‡å¼ºå¤§æŠ½è±¡æ€ç»´èƒ½åŠ›çš„ç¨‹åºå‘˜ï¼Œæé›·æ²¡æœ‰è¾œè´Ÿè‡ªå·±è¿™ä¹ˆå¤šå¹´æ¥å­¦è¿‡çš„ç°ä»£å‰ç«¯æ¡†æ¶ã€‚ä»–æ•é”åœ°æ„ŸçŸ¥åˆ°ï¼ŒéŸ©æ¢…æ¢…æ‰€è¯´çš„è¿™äº›ä¸åŒçš„â€é€‰æ‹©â€œé—´çš„åˆ‡æ¢ï¼Œæœ¬è´¨å°±æ˜¯çŠ¶æ€çš„åˆ‡æ¢ã€‚åœ¨è¿™ä¸ªèƒ½åšå››ç§å’–å•¡çš„å’–å•¡æœºä½“å†…ï¼Œè•´å«ç€å››ç§çŠ¶æ€ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>- ç¾å¼å’–å•¡æ€ï¼ˆamerican)ï¼šåªåé»‘å’–å•¡
- æ™®é€šæ‹¿é“æ€(latte)ï¼šé»‘å’–å•¡åŠ ç‚¹å¥¶
- é¦™è‰æ‹¿é“æ€ï¼ˆvanillaLatteï¼‰ï¼šé»‘å’–å•¡åŠ ç‚¹å¥¶å†åŠ é¦™è‰ç³–æµ†
- æ‘©å¡å’–å•¡æ€(mocha)ï¼šé»‘å’–å•¡åŠ ç‚¹å¥¶å†åŠ ç‚¹å·§å…‹åŠ›
</code></pre></div><p>å˜¿å˜¿ï¼Œè¿™ä¹ˆä¸€æ¢³ç†ï¼Œæé›·çš„æ€è·¯ä¸€ä¸‹å­æ¸…æ™°äº†èµ·æ¥ã€‚ä½œä¸ºæ­»æ€§ä¸æ”¹çš„ if-else ä¾ ï¼Œä»–å†æ¬¡ä¸‰ä¸‹äº”é™¤äºŒå†™å‡ºäº†ä¸€å¥—åŠŸèƒ½å®Œå¤‡çš„ä»£ç ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">CoffeeMaker</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     *è¿™é‡Œç•¥å»å’–å•¡æœºä¸­ä¸å’–å•¡çŠ¶æ€åˆ‡æ¢æ— å…³çš„ä¸€äº›åˆå§‹åŒ–é€»è¾‘
    **/</span>
    <span class="token comment">// åˆå§‹åŒ–çŠ¶æ€ï¼Œæ²¡æœ‰åˆ‡æ¢ä»»ä½•å’–å•¡æ¨¡å¼</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">'init'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// å…³æ³¨å’–å•¡æœºçŠ¶æ€åˆ‡æ¢å‡½æ•°</span>
  <span class="token function">changeState</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è®°å½•å½“å‰çŠ¶æ€</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> state<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>state <span class="token operator">===</span> <span class="token string">'american'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// è¿™é‡Œç”¨ console ä»£æŒ‡å’–å•¡åˆ¶ä½œæµç¨‹çš„ä¸šåŠ¡é€»è¾‘</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æˆ‘åªåé»‘å’–å•¡'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>state <span class="token operator">===</span> <span class="token string">'latte'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ç»™é»‘å’–å•¡åŠ ç‚¹å¥¶</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>state <span class="token operator">===</span> <span class="token string">'vanillaLatte'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'é»‘å’–å•¡åŠ ç‚¹å¥¶å†åŠ é¦™è‰ç³–æµ†'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>state <span class="token operator">===</span> <span class="token string">'mocha'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'é»‘å’–å•¡åŠ ç‚¹å¥¶å†åŠ ç‚¹å·§å…‹åŠ›'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æµ‹è¯•ä¸€ä¸‹ï¼Œå®Œç¾æ— ç¼ºï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> mk <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CoffeeMaker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mk<span class="token punctuation">.</span><span class="token function">changeState</span><span class="token punctuation">(</span><span class="token string">'latte'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¾“å‡º 'ç»™é»‘å’–å•¡åŠ ç‚¹å¥¶'</span>
</code></pre></div><blockquote><p>é‰´äº if-else ä½¿ä¸å¾—ï¼Œæé›·èµ¶ç´§ç¿»å‡ºäº†ä»–åœ¨ç­–ç•¥æ¨¡å¼ä¸­å­¦åˆ°çš„â€œå•ä¸€èŒè´£â€å’Œâ€œå¼€æ”¾å°é—­â€åŸåˆ™ï¼Œæ¯”çŒ«ç”»è™åœ°æ”¹é€ èµ·äº†è‡ªå·±çš„å’–å•¡æœºï¼š</p></blockquote> <h3 id="_7-2-æ”¹é€ å’–å•¡æœºçš„çŠ¶æ€åˆ‡æ¢æœºåˆ¶"><a href="#_7-2-æ”¹é€ å’–å•¡æœºçš„çŠ¶æ€åˆ‡æ¢æœºåˆ¶" class="header-anchor">#</a> 7.2 æ”¹é€ å’–å•¡æœºçš„çŠ¶æ€åˆ‡æ¢æœºåˆ¶</h3> <p><strong>1. èŒè´£åˆ†ç¦»</strong></p> <p>é¦–å…ˆï¼Œæ˜ å…¥æé›·çœ¼å¸˜æœ€å¤§çš„é—®é¢˜ï¼Œå°±æ˜¯å’–å•¡åˆ¶ä½œè¿‡ç¨‹ä¸å¯å¤ç”¨ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">changeState</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è®°å½•å½“å‰çŠ¶æ€</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> state<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>state <span class="token operator">===</span> <span class="token string">'american'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// è¿™é‡Œç”¨ console ä»£æŒ‡å’–å•¡åˆ¶ä½œæµç¨‹çš„ä¸šåŠ¡é€»è¾‘</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æˆ‘åªåé»‘å’–å•¡'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>state <span class="token operator">===</span> <span class="token string">'latte'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ç»™é»‘å’–å•¡åŠ ç‚¹å¥¶</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>state <span class="token operator">===</span> <span class="token string">'vanillaLatte'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'é»‘å’–å•¡åŠ ç‚¹å¥¶å†åŠ é¦™è‰ç³–æµ†'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>state <span class="token operator">===</span> <span class="token string">'mocha'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'é»‘å’–å•¡åŠ ç‚¹å¥¶å†åŠ ç‚¹å·§å…‹åŠ›'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æé›·å‘ç°ï¼Œè¿™ä¸ª changeState å‡½æ•°ï¼Œå®ƒå¥½å¥½ç®¡å¥½è‡ªå·±çš„äº‹ï¼ˆçŠ¶æ€åˆ‡æ¢ï¼‰ä¸è¡Œå—ï¼Ÿæ€ä¹ˆè¿åšå’–å•¡çš„è¿‡ç¨‹ä¹Ÿå†™åœ¨è¿™é‡Œé¢ï¼Ÿè¿™ä¸åˆç†ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">CoffeeMaker</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
    è¿™é‡Œç•¥å»å’–å•¡æœºä¸­ä¸å’–å•¡çŠ¶æ€åˆ‡æ¢æ— å…³çš„ä¸€äº›åˆå§‹åŒ–é€»è¾‘
  **/</span>
    <span class="token comment">// åˆå§‹åŒ–çŠ¶æ€ï¼Œæ²¡æœ‰åˆ‡æ¢ä»»ä½•å’–å•¡æ¨¡å¼</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">'init'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">changeState</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è®°å½•å½“å‰çŠ¶æ€</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> state<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>state <span class="token operator">===</span> <span class="token string">'american'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// è¿™é‡Œç”¨ console ä»£æŒ‡å’–å•¡åˆ¶ä½œæµç¨‹çš„ä¸šåŠ¡é€»è¾‘</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">americanProcess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>state <span class="token operator">===</span> <span class="token string">'latte'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">latteProcress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>state <span class="token operator">===</span> <span class="token string">'vanillaLatte'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">vanillaLatteProcress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>state <span class="token operator">===</span> <span class="token string">'mocha'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">mochaProcress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">americanProcess</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æˆ‘åªåé»‘å’–å•¡'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">latteProcress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">americanProcess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'åŠ ç‚¹å¥¶'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">vanillaLatteProcress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">latteProcress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å†åŠ é¦™è‰ç³–æµ†'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">mochaProcress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">latteProcress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å†åŠ å·§å…‹åŠ›'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> mk <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CoffeeMaker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mk<span class="token punctuation">.</span><span class="token function">changeState</span><span class="token punctuation">(</span><span class="token string">'latte'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>è¾“å‡ºç»“æœç¬¦åˆé¢„æœŸï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>æˆ‘åªåé»‘å’–å•¡
åŠ ç‚¹å¥¶
</code></pre></div><h3 id="_7-3-å¼€æ”¾å°é—­"><a href="#_7-3-å¼€æ”¾å°é—­" class="header-anchor">#</a> 7.3 å¼€æ”¾å°é—­</h3> <p>å¤ç”¨çš„é—®é¢˜è§£å†³äº†ï¼Œif-else å´ä»ç„¶æ´»å¾—å¥½å¥½çš„ã€‚</p> <p>ç°åœ¨å’±ä»¬å‡å¦‚è¦å¢åŠ â€æ°”æ³¡ç¾å¼â€œè¿™ä¸ªå’–å•¡å“ç§ï¼Œå°±ä¸å¾—ä¸å»ä¿®æ”¹ changeState çš„å‡½æ•°é€»è¾‘ï¼Œè¿™è¿åäº†å¼€æ”¾å°é—­çš„åŸåˆ™ã€‚</p> <p>åŒæ—¶ï¼Œä¸€ä¸ªå‡½æ•°é‡Œæ”¶æ•›è¿™ä¹ˆå¤šåˆ¤æ–­ï¼Œä¹Ÿç€å®ä¸å¤Ÿä½“é¢ã€‚å’±ä»¬ç°åœ¨è¦åƒç­–ç•¥æ¨¡å¼ä¸€æ ·ï¼Œæƒ³åŠæ³•æŠŠå’–å•¡æœºçŠ¶æ€å’Œå’–å•¡åˆ¶ä½œå·¥åºä¹‹é—´çš„æ˜ å°„å…³ç³»ï¼ˆä¹Ÿå°±æ˜¯å’±ä»¬ä¸ŠèŠ‚è°ˆåˆ°çš„åˆ†å‘è¿‡ç¨‹ï¼‰ç”¨ä¸€ä¸ªæ›´ä¼˜é›…åœ°æ–¹å¼åšæ‰ã€‚å¦‚æœä½ ç­–ç•¥æ¨¡å¼æŒæ¡å¾—è¶³å¤Ÿå¥½ï¼Œä½ ä¼šç¬¬ä¸€æ—¶é—´åæ˜ å‡ºå¯¹è±¡æ˜ å°„çš„æ–¹æ¡ˆï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> stateToProcessor <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">american</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æˆ‘åªåé»‘å’–å•¡'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">latte</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">american</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'åŠ ç‚¹å¥¶'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">vanillaLatte</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">latte</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å†åŠ é¦™è‰ç³–æµ†'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mocha</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">latte</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å†åŠ å·§å…‹åŠ›'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">CoffeeMaker</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
    è¿™é‡Œç•¥å»å’–å•¡æœºä¸­ä¸å’–å•¡çŠ¶æ€åˆ‡æ¢æ— å…³çš„ä¸€äº›åˆå§‹åŒ–é€»è¾‘
  **/</span>
    <span class="token comment">// åˆå§‹åŒ–çŠ¶æ€ï¼Œæ²¡æœ‰åˆ‡æ¢ä»»ä½•å’–å•¡æ¨¡å¼</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">'init'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å…³æ³¨å’–å•¡æœºçŠ¶æ€åˆ‡æ¢å‡½æ•°</span>
  <span class="token function">changeState</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è®°å½•å½“å‰çŠ¶æ€</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> state<span class="token punctuation">;</span>
    <span class="token comment">// è‹¥çŠ¶æ€ä¸å­˜åœ¨ï¼Œåˆ™è¿”å›</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>stateToProcessor<span class="token punctuation">[</span>state<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    stateToProcessor<span class="token punctuation">[</span>state<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> mk <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CoffeeMaker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mk<span class="token punctuation">.</span><span class="token function">changeState</span><span class="token punctuation">(</span><span class="token string">'latte'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>è¾“å‡ºç»“æœç¬¦åˆé¢„æœŸï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>æˆ‘åªåé»‘å’–å•¡
åŠ ç‚¹å¥¶

</code></pre></div><p>å½“æˆ‘ä»¬è¿™ä¹ˆåšæ—¶ï¼Œå…¶å®å·²ç»å®ç°äº†ä¸€ä¸ª js ç‰ˆæœ¬çš„çŠ¶æ€æ¨¡å¼ã€‚</p> <p>ä½†è¿™é‡Œæœ‰ä¸€ç‚¹å¤§å®¶éœ€è¦å¼•èµ·æ³¨æ„ï¼šè¿™ç§æ–¹æ³•ä»…ä»…æ˜¯çœ‹ä¸Šå»å®Œç¾æ— ç¼ºï¼Œå…¶ä¸­å´æš—å«ä¸€ä¸ªéå¸¸é‡è¦çš„éšæ‚£â€”â€”stateToProcessor é‡Œçš„å·¥åºå‡½æ•°ï¼Œæ„ŸçŸ¥ä¸åˆ°å’–å•¡æœºçš„å†…éƒ¨çŠ¶å†µã€‚</p> <h3 id="_7-4-è¿›ä¸€æ­¥æ”¹é€ "><a href="#_7-4-è¿›ä¸€æ­¥æ”¹é€ " class="header-anchor">#</a> 7.4 è¿›ä¸€æ­¥æ”¹é€ </h3> <p>æŒ‰ç…§æˆ‘ä»¬è¿™ä¸€é€šæè¿°ï¼Œå½“åŠ¡ä¹‹æ€¥æ˜¯è¦æŠŠå’–å•¡æœºå’Œå®ƒçš„çŠ¶æ€å¤„ç†å‡½æ•°å»ºç«‹å…³è”ã€‚</p> <p>å¦‚æœä½ è¯»è¿‡ä¸€äº›æ—©æœŸçš„è®¾è®¡æ¨¡å¼æ•™å­¦èµ„æ–™ï¼Œæœ‰ä¸€ç§æ€è·¯æ˜¯å°†æ¯ä¸€ä¸ªçŠ¶æ€æ‰€å¯¹åº”çš„çš„ä¸€äº›è¡Œä¸ºæŠ½è±¡æˆç±»ï¼Œç„¶åé€šè¿‡ä¼ é€’ this çš„æ–¹å¼æ¥å…³è”çŠ¶æ€å’ŒçŠ¶æ€ä¸»ä½“ã€‚</p> <p>è¿™ç§æ€è·¯ä¹Ÿå¯ä»¥ï¼Œä¸è¿‡å®ƒä¸€èˆ¬è¿˜éœ€è¦ä½ å®ç°æŠ½è±¡å·¥å‚ï¼Œæ¯”è¾ƒéº»çƒ¦ã€‚å®é™…ä¸šåŠ¡ä¸­è¿™ç§åšæ³•æä¸ºå°‘è§ã€‚æˆ‘è¿™é‡Œè¦ç»™å¤§å®¶ä»‹ç»çš„æ˜¯ä¸€ç§æ›´æ–¹ä¾¿ä¹Ÿæ›´å¸¸ç”¨çš„è§£å†³æ–¹æ¡ˆâ€”â€”éå¸¸ç®€å•ï¼ŒæŠŠçŠ¶æ€-è¡Œä¸ºæ˜ å°„å¯¹è±¡ä½œä¸ºä¸»ä½“ç±»å¯¹åº”å®ä¾‹çš„ä¸€ä¸ªå±æ€§æ·»åŠ è¿›å»å°±è¡Œäº†ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">CoffeeMaker</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     *è¿™é‡Œç•¥å»å’–å•¡æœºä¸­ä¸å’–å•¡çŠ¶æ€åˆ‡æ¢æ— å…³çš„ä¸€äº›åˆå§‹åŒ–é€»è¾‘
    **/</span>
    <span class="token comment">// åˆå§‹åŒ–çŠ¶æ€ï¼Œæ²¡æœ‰åˆ‡æ¢ä»»ä½•å’–å•¡æ¨¡å¼</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">'init'</span><span class="token punctuation">;</span>
    <span class="token comment">// åˆå§‹åŒ–ç‰›å¥¶çš„å­˜å‚¨é‡</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>leftMilk <span class="token operator">=</span> <span class="token string">'500ml'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  stateToProcessor <span class="token operator">=</span> <span class="token punctuation">{</span>
    that<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">,</span>
    <span class="token function">american</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// å°è¯•åœ¨è¡Œä¸ºå‡½æ•°é‡Œæ‹¿åˆ°å’–å•¡æœºå®ä¾‹çš„ä¿¡æ¯å¹¶è¾“å‡º</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å’–å•¡æœºç°åœ¨çš„ç‰›å¥¶å­˜å‚¨é‡æ˜¯:'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>that<span class="token punctuation">.</span>leftMilk<span class="token punctuation">)</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æˆ‘åªåé»‘å’–å•¡'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">latte</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">american</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'åŠ ç‚¹å¥¶'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">vanillaLatte</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">latte</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å†åŠ é¦™è‰ç³–æµ†'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">mocha</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">latte</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å†åŠ å·§å…‹åŠ›'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å…³æ³¨å’–å•¡æœºçŠ¶æ€åˆ‡æ¢å‡½æ•°</span>
  <span class="token function">changeState</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> state<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>stateToProcessor<span class="token punctuation">[</span>state<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>stateToProcessor<span class="token punctuation">[</span>state<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> mk <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CoffeeMaker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mk<span class="token punctuation">.</span><span class="token function">changeState</span><span class="token punctuation">(</span><span class="token string">'latte'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>è¾“å‡ºç»“æœä¸ºï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>å’–å•¡æœºç°åœ¨çš„ç‰›å¥¶å­˜å‚¨é‡æ˜¯: 500ml
æˆ‘åªåé»‘å’–å•¡
åŠ ç‚¹å¥¶
</code></pre></div><p>å¦‚æ­¤ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ stateToProcessor è½»æ¾æ‹¿åˆ°å’–å•¡æœºçš„å®ä¾‹å¯¹è±¡ï¼Œè¿›è€Œæ„ŸçŸ¥å’–å•¡æœºè¿™ä¸ªä¸»ä½“äº†ã€‚</p> <h3 id="_7-5-çŠ¶æ€æ¨¡å¼å¤ç›˜"><a href="#_7-5-çŠ¶æ€æ¨¡å¼å¤ç›˜" class="header-anchor">#</a> 7.5 çŠ¶æ€æ¨¡å¼å¤ç›˜</h3> <p>å’Œç­–ç•¥æ¨¡å¼ä¸€æ ·ï¼Œå’±ä»¬ä»ç„¶æ˜¯æ•²å®Œä»£ç ä¹‹åï¼Œä¸€èµ·æ¥å¤ç›˜ä¸€ä¸‹çŠ¶æ€æ¨¡å¼çš„å®šä¹‰ï¼š</p> <blockquote><p>çŠ¶æ€æ¨¡å¼(State Pattern) ï¼šå…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºï¼Œå¯¹è±¡çœ‹èµ·æ¥ä¼¼ä¹ä¿®æ”¹äº†å®ƒçš„ç±»ã€‚</p></blockquote> <p>è¿™ä¸ªå®šä¹‰æ¯”è¾ƒç²—ç³™ï¼Œå¯èƒ½ä½ è¯»å®Œä»ç„¶ get ä¸åˆ°å®ƒæƒ³è®©ä½ å¹²å•¥ã€‚è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å°±åº”è¯¥æŠŠç›®å…‰è½¬ç§»åˆ°å®ƒè§£å†³çš„é—®é¢˜ä¸Šæ¥ï¼š</p> <blockquote><p>çŠ¶æ€æ¨¡å¼<strong>ä¸»è¦è§£å†³çš„æ˜¯å½“æ§åˆ¶ä¸€ä¸ªå¯¹è±¡çŠ¶æ€çš„æ¡ä»¶è¡¨è¾¾å¼è¿‡äºå¤æ‚æ—¶çš„æƒ…å†µã€‚æŠŠçŠ¶æ€çš„åˆ¤æ–­é€»è¾‘è½¬ç§»åˆ°è¡¨ç¤ºä¸åŒçŠ¶æ€çš„ä¸€ç³»åˆ—ç±»ä¸­</strong>ï¼Œå¯ä»¥æŠŠå¤æ‚çš„åˆ¤æ–­é€»è¾‘ç®€åŒ–ã€‚</p></blockquote> <p>ä»”ç»†å›å¿†ä¸€ä¸‹æˆ‘ä»¬è¿™èŠ‚åšçš„äº‹æƒ…ï¼Œä¹Ÿç¡®å®å°±æ˜¯è¿™ä¹ˆå›äº‹å„¿ã€‚</p> <blockquote><p>å”¯ä¸€çš„åŒºåˆ«åœ¨äºï¼Œå®šä¹‰é‡Œå¼ºè°ƒäº†â€ç±»â€œçš„æ¦‚å¿µã€‚ä½†æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼ŒåŒ…æ‹¬å¤§å®¶ä»Šåçš„å®è·µä¸­ï¼Œä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å¦‚æœå¤æ‚åˆ°äº†ä½ ä¸å¾—ä¸ç»™å®ƒçš„æ¯ N ç§çŠ¶æ€åˆ’åˆ†ä¸ºä¸€ç±»ã€ä¸€å£æ°”åˆ’åˆ†å¾ˆå¤šç±»è¿™ç§ç¨‹åº¦ï¼Œæˆ‘æ›´å€¾å‘äºä½ å»åæ€ä¸€ä¸ªè¿™ä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯åšå¤ªå¤šäº‹æƒ…äº†ã€‚äº‹å®ä¸Šï¼Œåœ¨å¤§å¤šæ•°åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬çš„è¡Œä¸ºåˆ’åˆ†ï¼Œéƒ½æ˜¯å¯ä»¥åƒæœ¬èŠ‚ä¸€æ ·ï¼Œæ§åˆ¶åœ¨â€å‡½æ•°â€œè¿™ä¸ªç²’åº¦çš„ã€‚</p></blockquote> <h2 id="_8-è¡Œä¸ºå‹-è§‚å¯Ÿè€…æ¨¡å¼"><a href="#_8-è¡Œä¸ºå‹-è§‚å¯Ÿè€…æ¨¡å¼" class="header-anchor">#</a> 8 è¡Œä¸ºå‹-è§‚å¯Ÿè€…æ¨¡å¼</h2> <blockquote><p>è§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰äº†ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œè®©å¤šä¸ªè§‚å¯Ÿè€…å¯¹è±¡åŒæ—¶ç›‘å¬æŸä¸€ä¸ªç›®æ ‡å¯¹è±¡ï¼Œå½“è¿™ä¸ªç›®æ ‡å¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šé€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…å¯¹è±¡ï¼Œä½¿å®ƒä»¬èƒ½å¤Ÿè‡ªåŠ¨æ›´æ–°ã€‚ â€”â€” Graphic Design Patterns</p></blockquote> <p>è§‚å¯Ÿè€…æ¨¡å¼ï¼Œæ˜¯æ‰€æœ‰ JavaScript è®¾è®¡æ¨¡å¼ä¸­<strong>ä½¿ç”¨é¢‘ç‡</strong>æœ€é«˜ï¼Œ<strong>é¢è¯•é¢‘ç‡ä¹Ÿæœ€é«˜</strong>çš„è®¾è®¡æ¨¡å¼ï¼Œæ‰€ä»¥è¯´å®ƒ<strong>ååˆ†é‡è¦</strong>â€”â€”å¦‚æœæˆ‘æ˜¯é¢è¯•å®˜ï¼Œè€ƒè™‘åˆ°é¢è¯•æ—¶é—´æœ‰é™ã€è®¾è®¡æ¨¡å¼è¿™å—ä¸èƒ½å¤šé—®ï¼Œæˆ‘å¯èƒ½åœ¨è€ƒæŸ¥ä½ è®¾è®¡æ¨¡å¼çš„æ—¶å€™åªä¼šé—®è§‚å¯Ÿè€…æ¨¡å¼è¿™ä¸€ä¸ªæ¨¡å¼ã€‚è¯¥æ¨¡å¼çš„æƒé‡æé«˜</p> <p>é‡ç‚¹ä¸ä¸€å®šæ˜¯éš¾ç‚¹ã€‚è§‚å¯Ÿè€…æ¨¡å¼ååˆ†é‡è¦ï¼Œä½†å®ƒå¹¶ä¸æŠ½è±¡ï¼Œç†è§£éš¾åº¦ä¸å¤§ã€‚è¿™ç§æ¨¡å¼ä¸ä»…åœ¨ä¸šåŠ¡å¼€å‘ä¸­éåœ°å¼€èŠ±ï¼Œåœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­ä¹Ÿæ˜¯éå¸¸å¸¸è§çš„ã€‚ä¸ºäº†å¸®åŠ©å¤§å®¶å½¢æˆåˆæ­¥çš„ç†è§£ï¼Œåœ¨è¿›å…¥ä»£ç ä¸–ç•Œä¹‹å‰ï¼Œæˆ‘ä»¬ç…§ä¾‹æ¥çœ‹ä¸€æ®µæ—¥å¸¸ï¼š</p> <h3 id="_8-1-ç”Ÿæ´»ä¸­çš„è§‚å¯Ÿè€…æ¨¡å¼"><a href="#_8-1-ç”Ÿæ´»ä¸­çš„è§‚å¯Ÿè€…æ¨¡å¼" class="header-anchor">#</a> 8.1 ç”Ÿæ´»ä¸­çš„è§‚å¯Ÿè€…æ¨¡å¼</h3> <p>å‘¨ä¸€åˆšä¸Šç­ï¼Œå‰ç«¯å¼€å‘æé›·å°±è¢«äº§å“ç»ç†éŸ©æ¢…æ¢…æ‹‰è¿›äº†ä¸€ä¸ªé’‰é’‰ç¾¤â€”â€”â€œå‘˜å·¥ç®¡ç†ç³»ç»Ÿéœ€æ±‚ç¬¬99æ¬¡å˜æ›´ç¾¤â€ã€‚è¿™ä¸ªç¾¤é‡Œä¸ä»…æœ‰æé›·ï¼Œè¿˜æœ‰åç«¯å¼€å‘ Aï¼Œæµ‹è¯•åŒå­¦ Bã€‚ä¸‰ä½æŠ€æœ¯åŒå­¦çœ‹åˆ°è¿™ç®€å•ç›´ç™½çš„ç¾¤åä¾¿ç«‹åˆ»åšå¥½äº†æ¥å—å˜æ›´çš„å‡†å¤‡ã€æ‰“ç®—æ’¸èµ·è¢–å­å¼€å§‹å¹²äº†ã€‚æ­¤æ—¶éŸ©æ¢…æ¢…å´è¯´ï¼šâ€œåˆ«æ€¥ï¼Œè¿™ä¸ªéœ€æ±‚æœ‰é—®é¢˜ï¼Œæˆ‘éœ€è¦å’Œä¸šåŠ¡æ–¹å†ç¡®è®¤ä¸€ä¸‹ï¼Œå¤§å®¶å…ˆå„å¿™å„çš„å§â€ã€‚è¿™ç§æƒ…å†µä¸‹ä¸‰ä½æŠ€æœ¯åŒå­¦ä¸å¿…ç«‹åˆ»æŠ•å…¥å·¥ä½œï¼Œä½†ä»–ä»¬éƒ½å·²ç»åšå¥½äº†<strong>æœ¬å‘¨éœ€è¦åšä¸€ä¸ªæ–°éœ€æ±‚</strong>çš„å‡†å¤‡ï¼Œæ—¶åˆ»ç­‰å¾…ç€äº§å“ç»ç†çš„å·å¬ã€‚</p> <p>ä¸€å¤©è¿‡å»äº†ï¼Œä¸¤å¤©è¿‡å»äº†ã€‚å‘¨ä¸‰ä¸‹åˆï¼ŒéŸ©æ¢…æ¢…ç»ˆäºå’Œä¸šåŠ¡æ–¹ç¡®è®¤äº†æ‰€æœ‰çš„éœ€æ±‚ç»†èŠ‚ï¼Œäºæ˜¯åœ¨â€œå‘˜å·¥ç®¡ç†ç³»ç»Ÿéœ€æ±‚ç¬¬99æ¬¡å˜æ›´ç¾¤â€é‡Œå¤§å¼ä¸€å£°ï¼šâ€œéœ€æ±‚æ–‡æ¡£æ¥äº†ï¼â€ï¼Œéšåç”©å‡ºäº†&quot;éœ€æ±‚æ–‡æ¡£.zip&quot;æ–‡ä»¶ï¼ŒåŒæ—¶@æ‰€æœ‰äººã€‚ä¸‰ä½æŠ€æœ¯åŒå­¦å¬åˆ°ç†Ÿæ‚‰çš„â€œæœ‰äºº@æˆ‘â€æç¤ºéŸ³ï¼Œç«‹åˆ»ç‚¹å¼€ç¾¤è¿›è¡Œç¾¤æ¶ˆæ¯å’Œç¾¤æ–‡ä»¶æŸ¥æ”¶ï¼Œéšåæ ¹æ®ç¾¤æ¶ˆæ¯å’Œç¾¤æ–‡ä»¶æä¾›çš„éœ€æ±‚ä¿¡æ¯ï¼ŒæŠ•å…¥åˆ°äº†å„è‡ªçš„å¼€å‘é‡Œã€‚ä¸Šè¿°è¿™ä¸ªè¿‡ç¨‹ï¼Œå°±æ˜¯ä¸€ä¸ªå…¸å‹çš„<strong>è§‚å¯Ÿè€…æ¨¡å¼</strong>ã€‚</p> <p><strong>é‡ç‚¹è§’è‰²å¯¹å·å…¥åº§</strong></p> <p>è§‚å¯Ÿè€…æ¨¡å¼æœ‰ä¸€ä¸ªâ€œåˆ«åâ€ï¼Œå«<code>å‘å¸ƒ - è®¢é˜…æ¨¡å¼</code>ï¼ˆä¹‹æ‰€ä»¥åˆ«ååŠ äº†å¼•å·ï¼Œæ˜¯å› ä¸ºä¸¤è€…ä¹‹é—´å­˜åœ¨ç€ç»†å¾®çš„å·®å¼‚ï¼Œä¸‹ä¸ªå°èŠ‚é‡Œæˆ‘ä»¬ä¼šè®²åˆ°è¿™ç‚¹ï¼‰ã€‚è¿™ä¸ªåˆ«åéå¸¸å½¢è±¡åœ°è¯ é‡Šäº†è§‚å¯Ÿè€…æ¨¡å¼é‡Œä¸¤ä¸ªæ ¸å¿ƒçš„è§’è‰²è¦ç´ â€”â€”<strong>â€œå‘å¸ƒè€…â€<strong>ä¸</strong>â€œè®¢é˜…è€…â€</strong>ã€‚</p> <p>åœ¨ä¸Šè¿°çš„è¿‡ç¨‹ä¸­ï¼Œéœ€æ±‚æ–‡æ¡£ï¼ˆç›®æ ‡å¯¹è±¡ï¼‰çš„å‘å¸ƒè€…åªæœ‰ä¸€ä¸ªâ€”â€”äº§å“ç»ç†éŸ©æ¢…æ¢…ã€‚è€Œéœ€æ±‚ä¿¡æ¯çš„æ¥å—è€…å´æœ‰å¤šä¸ªâ€”â€”å‰ç«¯ã€åç«¯ã€æµ‹è¯•åŒå­¦ï¼Œè¿™äº›åŒå­¦çš„å…±æ€§å°±æ˜¯ä»–ä»¬éœ€è¦æ ¹æ®éœ€æ±‚ä¿¡æ¯å¼€å±•è‡ªå·±åç»­çš„å·¥ä½œã€å› æ­¤éƒ½éå¸¸å…³å¿ƒè¿™ä¸ªéœ€æ±‚ä¿¡æ¯ï¼Œäºæ˜¯ä¸å¾—ä¸æ—¶åˆ»å…³æ³¨ç€è¿™ä¸ªç¾¤çš„ç¾¤æ¶ˆæ¯æé†’ï¼Œä»–ä»¬æ˜¯å®æ‰“å®çš„<strong>è®¢é˜…è€…</strong>ï¼Œå³è§‚å¯Ÿè€…å¯¹è±¡ã€‚</p> <p>ç°åœ¨æˆ‘ä»¬å†å›è¿‡å¤´æ¥çœ‹ä¸€éå¼€å¤´æˆ‘ä»¬æåˆ°çš„ç•¥æ˜¾æŠ½è±¡çš„å®šä¹‰ï¼š</p> <blockquote><p>è§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰äº†ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œè®©å¤šä¸ªè§‚å¯Ÿè€…å¯¹è±¡åŒæ—¶ç›‘å¬æŸä¸€ä¸ªç›®æ ‡å¯¹è±¡ï¼Œå½“è¿™ä¸ªç›®æ ‡å¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šé€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…å¯¹è±¡ï¼Œä½¿å®ƒä»¬èƒ½å¤Ÿè‡ªåŠ¨æ›´æ–°ã€‚</p></blockquote> <p>åœ¨æˆ‘ä»¬ä¸Šæ–‡è¿™ä¸ªé’‰é’‰ç¾¤é‡Œï¼Œä¸€ä¸ªéœ€æ±‚ä¿¡æ¯å¯¹è±¡å¯¹åº”äº†å¤šä¸ªè§‚å¯Ÿè€…ï¼ˆæŠ€æœ¯åŒå­¦ï¼‰ï¼Œå½“éœ€æ±‚ä¿¡æ¯å¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿ<strong>å˜åŒ–</strong>ï¼ˆä»æ— åˆ°æœ‰ï¼‰æ—¶ï¼Œäº§å“ç»ç†é€šçŸ¥äº†ç¾¤é‡Œçš„æ‰€æœ‰åŒå­¦ï¼Œä»¥ä¾¿è¿™äº›åŒå­¦æ¥æ”¶ä¿¡æ¯è¿›è€Œå¼€å±•å·¥ä½œï¼šè§’è‰²åˆ’åˆ† --&gt; çŠ¶æ€å˜åŒ– --&gt; å‘å¸ƒè€…é€šçŸ¥åˆ°è®¢é˜…è€…ï¼Œè¿™å°±æ˜¯è§‚å¯Ÿè€…æ¨¡å¼çš„â€œå¥—è·¯â€ã€‚</p> <h3 id="_8-2-åœ¨å®è·µä¸­ç†è§£å®šä¹‰"><a href="#_8-2-åœ¨å®è·µä¸­ç†è§£å®šä¹‰" class="header-anchor">#</a> 8.2 åœ¨å®è·µä¸­ç†è§£å®šä¹‰</h3> <blockquote><p>ç»“åˆæˆ‘ä»¬ä¸Šé¢çš„åˆ†æï¼Œç°åœ¨å¤§å®¶çŸ¥é“ï¼Œåœ¨è§‚å¯Ÿè€…æ¨¡å¼é‡Œï¼Œè‡³å°‘åº”è¯¥æœ‰ä¸¤ä¸ªå…³é”®è§’è‰²æ˜¯ä¸€å®šè¦å‡ºç°çš„â€”â€”<strong>å‘å¸ƒè€…å’Œè®¢é˜…è€…</strong>ã€‚ç”¨é¢å‘å¯¹è±¡çš„æ–¹å¼è¡¨è¾¾çš„è¯ï¼Œé‚£å°±æ˜¯è¦æœ‰<strong>ä¸¤ä¸ªç±»</strong>ã€‚</p></blockquote> <p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹è¿™ä¸ªä»£è¡¨å‘å¸ƒè€…çš„ç±»ï¼Œæˆ‘ä»¬ç»™å®ƒèµ·åå«<code>Publisher</code>ã€‚è¿™ä¸ªç±»åº”è¯¥å…·å¤‡å“ªäº›â€œåŸºæœ¬æŠ€èƒ½â€å‘¢ï¼Ÿå¤§å®¶å›å¿†ä¸€ä¸‹ä¸Šæ–‡ä¸­çš„éŸ©æ¢…æ¢…ï¼ŒéŸ©æ¢…æ¢…çš„åŸºæœ¬æ“ä½œæ˜¯ä»€ä¹ˆï¼Ÿé¦–å…ˆæ˜¯æ‹‰ç¾¤ï¼ˆå¢åŠ è®¢é˜…è€…ï¼‰ï¼Œç„¶åæ˜¯<code>@</code>æ‰€æœ‰äººï¼ˆé€šçŸ¥è®¢é˜…è€…ï¼‰ï¼Œè¿™ä¿©æ˜¯æœ€æ˜æ˜¾çš„äº†ã€‚æ­¤å¤–ä½œä¸ºç¾¤ä¸»&amp;äº§å“ç»ç†ï¼ŒéŸ©æ¢…æ¢…è¿˜å…·æœ‰è¸¢èµ°é¡¹ç›®ç»„æˆå‘˜ï¼ˆç§»é™¤è®¢é˜…è€…ï¼‰çš„èƒ½åŠ›ã€‚OKï¼Œäº§å“ç»ç†å‘å¸ƒè€…ç±»çš„ä¸‰ä¸ªåŸºæœ¬èƒ½åŠ›é½äº†ï¼Œä¸‹é¢æˆ‘ä»¬å¼€å§‹å†™ä»£ç ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å®šä¹‰å‘å¸ƒè€…ç±»</span>
<span class="token keyword">class</span> <span class="token class-name">Publisher</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Publisher created'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// å¢åŠ è®¢é˜…è€…</span>
  <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">observer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Publisher.add invoked'</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ç§»é™¤è®¢é˜…è€…</span>
  <span class="token function">remove</span><span class="token punctuation">(</span><span class="token parameter">observer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Publisher.remove invoked'</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>item <span class="token operator">===</span> observer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…</span>
  <span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Publisher.notify invoked'</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">observer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      observer<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>okï¼Œæå®šäº†å‘å¸ƒè€…ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥æƒ³æƒ³è®¢é˜…è€…èƒ½å¹²å•¥â€”â€”å…¶å®è®¢é˜…è€…çš„èƒ½åŠ›éå¸¸ç®€å•ï¼Œä½œä¸ºè¢«åŠ¨çš„ä¸€æ–¹ï¼Œå®ƒçš„è¡Œä¸ºåªæœ‰ä¸¤ä¸ªâ€”â€”è¢«é€šçŸ¥ã€å»æ‰§è¡Œï¼ˆæœ¬è´¨ä¸Šæ˜¯æ¥å—å‘å¸ƒè€…çš„è°ƒç”¨ï¼Œè¿™æ­¥æˆ‘ä»¬åœ¨<code>Publisher</code>ä¸­å·²ç»åšæ‰äº†ï¼‰ã€‚æ—¢ç„¶æˆ‘ä»¬åœ¨Publisherä¸­åšçš„æ˜¯æ–¹æ³•è°ƒç”¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨è®¢é˜…è€…ç±»é‡Œè¦åšçš„å°±æ˜¯<strong>æ–¹æ³•çš„å®šä¹‰</strong>ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å®šä¹‰è®¢é˜…è€…ç±»</span>
<span class="token keyword">class</span> <span class="token class-name">Observer</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Observer created'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Observer.update invoked'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä»¥ä¸Šï¼Œæˆ‘ä»¬å°±å®Œæˆäº†æœ€åŸºæœ¬çš„å‘å¸ƒè€…å’Œè®¢é˜…è€…ç±»çš„è®¾è®¡å’Œç¼–å†™ã€‚åœ¨å®é™…çš„ä¸šåŠ¡å¼€å‘ä¸­ï¼Œæˆ‘ä»¬æ‰€æœ‰çš„å®šåˆ¶åŒ–çš„å‘å¸ƒè€…/è®¢é˜…è€…é€»è¾‘éƒ½å¯ä»¥åŸºäºè¿™ä¸¤ä¸ªåŸºæœ¬ç±»æ¥æ”¹å†™ã€‚æ¯”å¦‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ‹“å±•å‘å¸ƒè€…ç±»ï¼Œæ¥ä½¿æ‰€æœ‰çš„è®¢é˜…è€…æ¥<strong>ç›‘å¬æŸä¸ªç‰¹å®šçŠ¶æ€çš„å˜åŒ–</strong>ã€‚</p> <p>ä»ç„¶ä»¥å¼€ç¯‡çš„ä¾‹å­ä¸ºä¾‹ï¼Œæˆ‘ä»¬è®©å¼€å‘è€…ä»¬æ¥ç›‘å¬éœ€æ±‚æ–‡æ¡£ï¼ˆprdï¼‰çš„å˜åŒ–ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å®šä¹‰ä¸€ä¸ªå…·ä½“çš„éœ€æ±‚æ–‡æ¡£ï¼ˆprdï¼‰å‘å¸ƒç±»</span>
<span class="token keyword">class</span> <span class="token class-name">PrdPublisher</span> <span class="token keyword">extends</span> <span class="token class-name">Publisher</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// åˆå§‹åŒ–éœ€æ±‚æ–‡æ¡£</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>prdState <span class="token operator">=</span> <span class="token keyword">null</span>
        <span class="token comment">// éŸ©æ¢…æ¢…è¿˜æ²¡æœ‰æ‹‰ç¾¤ï¼Œå¼€å‘ç¾¤ç›®å‰ä¸ºç©º</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>observers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'PrdPublisher created'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// è¯¥æ–¹æ³•ç”¨äºè·å–å½“å‰çš„prdState</span>
    <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'PrdPublisher.getState invoked'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prdState
    <span class="token punctuation">}</span>

    <span class="token comment">// è¯¥æ–¹æ³•ç”¨äºæ”¹å˜prdStateçš„å€¼</span>
    <span class="token function">setState</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'PrdPublisher.setState invoked'</span><span class="token punctuation">)</span>
        <span class="token comment">// prdçš„å€¼å‘ç”Ÿæ”¹å˜</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>prdState <span class="token operator">=</span> state
        <span class="token comment">// éœ€æ±‚æ–‡æ¡£å˜æ›´ï¼Œç«‹åˆ»é€šçŸ¥æ‰€æœ‰å¼€å‘è€…</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä½œä¸ºè®¢é˜…æ–¹ï¼Œå¼€å‘è€…çš„ä»»åŠ¡ä¹Ÿå˜å¾—å…·ä½“èµ·æ¥ï¼šæ¥æ”¶éœ€æ±‚æ–‡æ¡£ã€å¹¶å¼€å§‹å¹²æ´»ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">DeveloperObserver</span> <span class="token keyword">extends</span> <span class="token class-name">Observer</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// éœ€æ±‚æ–‡æ¡£ä¸€å¼€å§‹è¿˜ä¸å­˜åœ¨ï¼Œprdåˆå§‹ä¸ºç©ºå¯¹è±¡</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>prdState <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'DeveloperObserver created'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// é‡å†™ä¸€ä¸ªå…·ä½“çš„updateæ–¹æ³•</span>
    <span class="token function">update</span><span class="token punctuation">(</span><span class="token parameter">publisher</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'DeveloperObserver.update invoked'</span><span class="token punctuation">)</span>
        <span class="token comment">// æ›´æ–°éœ€æ±‚æ–‡æ¡£</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>prdState <span class="token operator">=</span> publisher<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// è°ƒç”¨å·¥ä½œå‡½æ•°</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">work</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// workæ–¹æ³•ï¼Œä¸€ä¸ªä¸“é—¨æ¬ç –çš„æ–¹æ³•</span>
    <span class="token function">work</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è·å–éœ€æ±‚æ–‡æ¡£</span>
        <span class="token keyword">const</span> prd <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prdState
        <span class="token comment">// å¼€å§‹åŸºäºéœ€æ±‚æ–‡æ¡£æä¾›çš„ä¿¡æ¯æ¬ç –ã€‚ã€‚ã€‚</span>
        <span class="token operator">...</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'996 begins...'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä¸‹é¢ï¼Œæˆ‘ä»¬å¯ä»¥ <code>new</code> ä¸€ä¸ª <code>PrdPublisher</code> å¯¹è±¡ï¼ˆäº§å“ç»ç†ï¼‰ï¼Œå¥¹å¯ä»¥é€šè¿‡è°ƒç”¨ <code>setState</code> æ–¹æ³•æ¥æ›´æ–°éœ€æ±‚æ–‡æ¡£ã€‚éœ€æ±‚æ–‡æ¡£æ¯æ¬¡æ›´æ–°ï¼Œéƒ½ä¼šç´§æ¥ç€è°ƒç”¨ <code>notify</code> æ–¹æ³•æ¥é€šçŸ¥æ‰€æœ‰å¼€å‘è€…ï¼š</p> <blockquote><p>ç›®æ ‡å¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šé€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…å¯¹è±¡ï¼Œä½¿å®ƒä»¬èƒ½å¤Ÿè‡ªåŠ¨æ›´æ–°ã€‚</p></blockquote> <p>OKï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹éŸ©æ¢…æ¢…å’Œå¥¹çš„å°ä¼™ä¼´ä»¬æ˜¯å¦‚ä½•æäº‹æƒ…çš„å§ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// åˆ›å»ºè®¢é˜…è€…ï¼šå‰ç«¯å¼€å‘æé›·</span>
<span class="token keyword">const</span> liLei <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DeveloperObserver</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// åˆ›å»ºè®¢é˜…è€…ï¼šæœåŠ¡ç«¯å¼€å‘å°Aï¼ˆsorryã€‚ã€‚ã€‚èµ·åå­—çœŸçš„å¤ªéš¾äº†ï¼‰</span>
<span class="token keyword">const</span> <span class="token constant">A</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DeveloperObserver</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// åˆ›å»ºè®¢é˜…è€…ï¼šæµ‹è¯•åŒå­¦å°B</span>
<span class="token keyword">const</span> <span class="token constant">B</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DeveloperObserver</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// éŸ©æ¢…æ¢…å‡ºç°äº†</span>
<span class="token keyword">const</span> hanMeiMei <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PrdPublisher</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// éœ€æ±‚æ–‡æ¡£å‡ºç°äº†</span>
<span class="token keyword">const</span> prd <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// å…·ä½“çš„éœ€æ±‚å†…å®¹</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
<span class="token comment">// éŸ©æ¢…æ¢…å¼€å§‹æ‹‰ç¾¤</span>
hanMeiMei<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>liLei<span class="token punctuation">)</span>
hanMeiMei<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token constant">A</span><span class="token punctuation">)</span>
hanMeiMei<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token constant">B</span><span class="token punctuation">)</span>
<span class="token comment">// éŸ©æ¢…æ¢…å‘é€äº†éœ€æ±‚æ–‡æ¡£ï¼Œå¹¶@äº†æ‰€æœ‰äºº</span>
hanMeiMei<span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span>prd<span class="token punctuation">)</span>
</code></pre></div><p>ä»¥ä¸Šï¼Œå°±æ˜¯è§‚å¯Ÿè€…æ¨¡å¼åœ¨ä»£ç ä¸–ç•Œé‡Œçš„å®Œæ•´å®ç°æµç¨‹äº†ã€‚</p> <p>ç›¸ä¿¡èµ°åˆ°è¿™ä¸€æ­¥ï¼Œå¤§å®¶å¯¹è§‚å¯Ÿè€…æ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³ã€åŸºæœ¬å®ç°æ¨¡å¼éƒ½æœ‰äº†ä¸é”™çš„æŒæ¡ã€‚ä¸‹é¢æˆ‘ä»¬è¶çƒ­æ‰“é“ï¼Œä¸€èµ·æ¥çœ‹çœ‹å¦‚ä½•å‡­å€Ÿè§‚å¯Ÿè€…æ¨¡å¼ï¼Œåœ¨é¢è¯•ä¸­è¡¨æ¼”çœŸæ­£çš„æŠ€æœ¯~</p> <h3 id="_8-3-vueæ•°æ®åŒå‘ç»‘å®šï¼ˆå“åº”å¼ç³»ç»Ÿï¼‰çš„å®ç°åŸç†"><a href="#_8-3-vueæ•°æ®åŒå‘ç»‘å®šï¼ˆå“åº”å¼ç³»ç»Ÿï¼‰çš„å®ç°åŸç†" class="header-anchor">#</a> 8.3 Vueæ•°æ®åŒå‘ç»‘å®šï¼ˆå“åº”å¼ç³»ç»Ÿï¼‰çš„å®ç°åŸç†</h3> <p><strong>1. è§£æ</strong></p> <p>Vue æ¡†æ¶æ˜¯çƒ­é—¨çš„æ¸è¿›å¼ JavaScriptæ¡†æ¶ã€‚åœ¨ Vue ä¸­ï¼Œå½“æˆ‘ä»¬ä¿®æ”¹çŠ¶æ€æ—¶ï¼Œè§†å›¾ä¼šéšä¹‹æ›´æ–°ï¼Œè¿™å°±æ˜¯Vueçš„æ•°æ®åŒå‘ç»‘å®šï¼ˆåˆç§°å“åº”å¼åŸç†ï¼‰ã€‚æ•°æ®åŒå‘ç»‘å®šæ˜¯Vue æœ€ç‹¬ç‰¹çš„ç‰¹æ€§ä¹‹ä¸€ã€‚å¦‚æœè¯»è€…æ²¡æœ‰æ¥è§¦è¿‡ Vueï¼Œå¼ºçƒˆå»ºè®®é˜…è¯»<a href="https://cn.vuejs.org/v2/guide/reactivity.html" target="_blank" rel="noopener noreferrer">Vueå®˜æ–¹å¯¹å“åº”å¼åŸç†çš„ä»‹ç»<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚æ­¤å¤„æˆ‘ä»¬ç”¨å®˜æ–¹çš„ä¸€å¼ æµç¨‹å›¾æ¥ç®€è¦åœ°è¯´æ˜ä¸€ä¸‹Vueå“åº”å¼ç³»ç»Ÿçš„æ•´ä¸ªæµç¨‹ï¼š</p> <p><img src="http://img-repo.poetries.top/images/20210327204351.png" alt=""></p> <p>åœ¨ <code>Vue</code> ä¸­ï¼Œæ¯ä¸ªç»„ä»¶å®ä¾‹éƒ½æœ‰ç›¸åº”çš„ <code>watcher</code> å®ä¾‹å¯¹è±¡ï¼Œå®ƒä¼šåœ¨ç»„ä»¶æ¸²æŸ“çš„è¿‡ç¨‹ä¸­æŠŠå±æ€§è®°å½•ä¸ºä¾èµ–ï¼Œä¹‹åå½“ä¾èµ–é¡¹çš„ <code>setter</code> è¢«è°ƒç”¨æ—¶ï¼Œä¼šé€šçŸ¥ <code>watcher</code> é‡æ–°è®¡ç®—ï¼Œä»è€Œè‡´ä½¿å®ƒå…³è”çš„ç»„ä»¶å¾—ä»¥æ›´æ–°â€”â€”è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„è§‚å¯Ÿè€…æ¨¡å¼ã€‚è¿™é“é¢è¯•é¢˜è€ƒå¯Ÿäº†å—è¯•è€…å¯¹Vueåº•å±‚åŸç†çš„ç†è§£ã€å¯¹è§‚å¯Ÿè€…æ¨¡å¼çš„å®ç°èƒ½åŠ›ä»¥åŠä¸€ç³»åˆ—é‡è¦çš„JSçŸ¥è¯†ç‚¹ï¼Œå…·æœ‰è¾ƒå¼ºçš„ç»¼åˆæ€§å’Œä»£è¡¨æ€§ã€‚</p> <p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨é¢è¯•è¿‡ç¨‹ä¸­ï¼Œé¢è¯•å®˜å¤šæ•°æƒ…å†µä¸‹ä¸ä¼šè¦æ±‚å¤§å®¶å†™å‡ºå®Œæ•´çš„å“åº”å¼åŸç†å®ç°ä»£ç ï¼Œè€Œæ˜¯è¦æ±‚ä½ â€œè¯´è¯´è‡ªå·±çš„ç†è§£â€ã€‚åœ¨æœ¬èŠ‚ï¼Œæˆ‘ä»¬ä¸ä¼šå¸¦å¤§å®¶ä¸€è¡Œä¸€è¡Œå†™ä»£ç ï¼ˆå…·ä½“æ·±å…¥Vueæ¡†æ¶çš„ç›¸å…³çŸ¥è¯†ï¼Œå»ºè®®å¤§å®¶é˜…è¯»<a href="https://github.com/vuejs/vue" target="_blank" rel="noopener noreferrer">Vueæºç <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>åŠè¿™æœ¬<a href="https://juejin.im/book/5a36661851882538e2259c0f" target="_blank" rel="noopener noreferrer">ä¸“é—¨å†™Vueçš„å°å†Œ<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚ï¼‰ï¼Œè€Œæ˜¯é’ˆå¯¹Vueå“åº”å¼ç³»ç»Ÿä¸­ä¸è§‚å¯Ÿè€…æ¨¡å¼ç´§å¯†å…³è”çš„è¿™éƒ¨åˆ†çŸ¥è¯†ä½œè®²è§£ï¼Œå¸®åŠ©å¤§å®¶æ‹æ¸…æ¥šæ•´å¥—æµç¨‹é‡Œçš„æ¥é¾™å»è„‰ã€åŠ æ·±å¯¹è§‚å¯Ÿè€…æ¨¡å¼çš„ç†è§£ã€‚</p> <p><strong>åœ¨Vueæ•°æ®åŒå‘ç»‘å®šçš„å®ç°é€»è¾‘é‡Œï¼Œæœ‰è¿™æ ·ä¸‰ä¸ªå…³é”®è§’è‰²ï¼š</strong></p> <ul><li><code>observer</code>ï¼ˆç›‘å¬å™¨ï¼‰ï¼šæ³¨æ„ï¼Œæ­¤ <code>observer</code> éå½¼ <code>observer</code>ã€‚åœ¨æˆ‘ä»¬ä¸Šé¢çš„è§£æä¸­ï¼Œ<code>observer</code> ä½œä¸ºè®¾è®¡æ¨¡å¼ä¸­çš„ä¸€ä¸ªè§’è‰²ï¼Œä»£è¡¨â€œè®¢é˜…è€…â€ã€‚ä½†åœ¨<code>Vue</code>æ•°æ®åŒå‘ç»‘å®šçš„è§’è‰²ç»“æ„é‡Œï¼Œæ‰€è°“çš„ <code>observer</code> ä¸ä»…æ˜¯ä¸€ä¸ªæ•°æ®ç›‘å¬å™¨ï¼Œå®ƒè¿˜éœ€è¦å¯¹ç›‘å¬åˆ°çš„æ•°æ®è¿›è¡Œ<strong>è½¬å‘</strong>â€”â€”ä¹Ÿå°±æ˜¯è¯´å®ƒ<strong>åŒæ—¶è¿˜æ˜¯ä¸€ä¸ªå‘å¸ƒè€…</strong>ã€‚</li> <li><code>watcher</code>ï¼ˆè®¢é˜…è€…ï¼‰ï¼š<code>observer</code> æŠŠæ•°æ®è½¬å‘ç»™äº†<strong>çœŸæ­£çš„è®¢é˜…è€…</strong>â€”â€”<code>watcher</code>å¯¹è±¡ã€‚<code>watcher</code> æ¥æ”¶åˆ°æ–°çš„æ•°æ®åï¼Œä¼šå»æ›´æ–°è§†å›¾ã€‚</li> <li><code>compile</code>ï¼ˆç¼–è¯‘å™¨ï¼‰ï¼š<code>MVVM</code> æ¡†æ¶ç‰¹æœ‰çš„è§’è‰²ï¼Œè´Ÿè´£å¯¹æ¯ä¸ªèŠ‚ç‚¹å…ƒç´ æŒ‡ä»¤è¿›è¡Œæ‰«æå’Œè§£æï¼ŒæŒ‡ä»¤çš„æ•°æ®åˆå§‹åŒ–ã€è®¢é˜…è€…çš„åˆ›å»ºè¿™äº›â€œæ‚æ´»â€ä¹Ÿå½’å®ƒç®¡~</li></ul> <p>è¿™ä¸‰è€…çš„é…åˆè¿‡ç¨‹å¦‚å›¾æ‰€ç¤ºï¼š</p> <p><img src="http://img-repo.poetries.top/images/20210327204920.png" alt=""></p> <p>OKï¼Œå®ç°æ–¹æ¡ˆææ¸…æ¥šäº†ï¼Œä¸‹é¢æˆ‘ä»¬ç»™æ•´ä¸ªæµç¨‹ä¸­<strong>æ¶‰åŠåˆ°å‘å¸ƒ-è®¢é˜…è¿™ä¸€æ¨¡å¼çš„ä»£ç </strong>æ¥ä¸ªç‰¹å†™ï¼š</p> <p><strong>2. æ ¸å¿ƒä»£ç </strong></p> <p><strong>å®ç°observer</strong></p> <blockquote><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šå¯¹éœ€è¦ç›‘å¬çš„æ•°æ®å¯¹è±¡è¿›è¡Œéå†ã€ç»™å®ƒçš„å±æ€§åŠ ä¸Šå®šåˆ¶çš„ <code>getter</code> å’Œ <code>setter</code> å‡½æ•°ã€‚è¿™æ ·ä½†å‡¡è¿™ä¸ªå¯¹è±¡çš„æŸä¸ªå±æ€§å‘ç”Ÿäº†æ”¹å˜ï¼Œå°±ä¼šè§¦å‘ <code>setter</code> å‡½æ•°ï¼Œè¿›è€Œé€šçŸ¥åˆ°è®¢é˜…è€…ã€‚è¿™ä¸ª <code>setter</code> å‡½æ•°ï¼Œå°±æ˜¯æˆ‘ä»¬çš„ç›‘å¬å™¨ï¼š</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// observeæ–¹æ³•éå†å¹¶åŒ…è£…å¯¹è±¡å±æ€§</span>
<span class="token keyword">function</span> <span class="token function">observe</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è‹¥targetæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™éå†å®ƒ</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>target <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> target <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// defineReactiveæ–¹æ³•ä¼šç»™ç›®æ ‡å±æ€§è£…ä¸Šâ€œç›‘å¬å™¨â€</span>
            <span class="token function">defineReactive</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// å®šä¹‰defineReactiveæ–¹æ³•</span>
<span class="token keyword">function</span> <span class="token function">defineReactive</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å±æ€§å€¼ä¹Ÿå¯èƒ½æ˜¯objectç±»å‹ï¼Œè¿™ç§æƒ…å†µä¸‹éœ€è¦è°ƒç”¨observeè¿›è¡Œé€’å½’éå†</span>
    <span class="token function">observe</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
    <span class="token comment">// ä¸ºå½“å‰å±æ€§å®‰è£…ç›‘å¬å™¨</span>
    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
         <span class="token comment">// å¯æšä¸¾</span>
        enumerable<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token comment">// ä¸å¯é…ç½®</span>
        configurable<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token function-variable function">get</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> val<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// ç›‘å¬å™¨å‡½æ•°</span>
        <span class="token function-variable function">set</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>target<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">å±æ€§çš„</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">å±æ€§ä»</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>val<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">å€¼å˜æˆäº†äº†</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
            val <span class="token operator">=</span> value
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>ä¸‹é¢å®ç°è®¢é˜…è€… <code>Dep</code>ï¼š</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å®šä¹‰è®¢é˜…è€…ç±»Dep</span>
<span class="token keyword">class</span> <span class="token class-name">Dep</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// åˆå§‹åŒ–è®¢é˜…é˜Ÿåˆ—</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>subs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// å¢åŠ è®¢é˜…è€…</span>
    <span class="token function">addSub</span><span class="token punctuation">(</span><span class="token parameter">sub</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// é€šçŸ¥è®¢é˜…è€…ï¼ˆæ˜¯ä¸æ˜¯æ‰€æœ‰çš„ä»£ç éƒ½ä¼¼æ›¾ç›¸è¯†ï¼Ÿï¼‰</span>
    <span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">sub</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            sub<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥æ”¹å†™ <code>defineReactive</code> ä¸­çš„ <code>setter</code> æ–¹æ³•ï¼Œåœ¨ç›‘å¬å™¨é‡Œå»é€šçŸ¥è®¢é˜…è€…äº†ï¼š</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">defineReactive</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> dep <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dep</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// ç›‘å¬å½“å‰å±æ€§</span>
    <span class="token function">observe</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">set</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…</span>
            dep<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_8-4-å®ç°ä¸€ä¸ªevent-bus-event-emitter"><a href="#_8-4-å®ç°ä¸€ä¸ªevent-bus-event-emitter" class="header-anchor">#</a> 8.4 å®ç°ä¸€ä¸ªEvent Bus / Event Emitter</h3> <blockquote><p><code>Event Bus</code>ï¼ˆVueã€Flutter ç­‰å‰ç«¯æ¡†æ¶ä¸­æœ‰å‡ºé•œï¼‰å’Œ <code>Event Emitter</code>ï¼ˆNodeä¸­æœ‰å‡ºé•œï¼‰å‡ºåœºçš„â€œå‰§ç»„â€ä¸åŒï¼Œä½†æ˜¯å®ƒä»¬éƒ½å¯¹åº”ä¸€ä¸ªå…±åŒçš„è§’è‰²â€”â€”<strong>å…¨å±€äº‹ä»¶æ€»çº¿</strong>ã€‚</p></blockquote> <p>å…¨å±€äº‹ä»¶æ€»çº¿ï¼Œä¸¥æ ¼æ¥è¯´ä¸èƒ½è¯´æ˜¯è§‚å¯Ÿè€…æ¨¡å¼ï¼Œè€Œæ˜¯å‘å¸ƒ-è®¢é˜…æ¨¡å¼ã€‚å®ƒåœ¨æˆ‘ä»¬æ—¥å¸¸çš„ä¸šåŠ¡å¼€å‘ä¸­åº”ç”¨éå¸¸å¹¿ã€‚</p> <blockquote><p>å¦‚æœåªèƒ½é€‰ä¸€é“é¢˜ï¼Œé‚£è¿™é“é¢˜ä¸€å®šæ˜¯ <code>Event Bus/Event Emitter</code> çš„ä»£ç å®ç°â€”â€”æˆ‘éƒ½è¯´è¿™ä¹ˆæ¸…æ¥šäº†ï¼Œè¿™ä¸ªçŸ¥è¯†ç‚¹åˆ°åº•è¦ä¸è¦æŒæ¡ã€éœ€è¦æŒæ¡åˆ°ä»€ä¹ˆç¨‹åº¦ï¼Œå°±çœ‹å„ä½è‡ªå·±çš„äº†ã€‚</p></blockquote> <p><strong>åœ¨Vueä¸­ä½¿ç”¨Event Busæ¥å®ç°ç»„ä»¶é—´çš„é€šè®¯</strong></p> <blockquote><p><code>Event Bus/Event Emitter</code> ä½œä¸ºå…¨å±€äº‹ä»¶æ€»çº¿ï¼Œå®ƒèµ·åˆ°çš„æ˜¯ä¸€ä¸ª<strong>æ²Ÿé€šæ¡¥æ¢</strong>çš„ä½œç”¨ã€‚æˆ‘ä»¬å¯ä»¥æŠŠå®ƒç†è§£ä¸ºä¸€ä¸ªäº‹ä»¶ä¸­å¿ƒï¼Œæˆ‘ä»¬æ‰€æœ‰äº‹ä»¶çš„è®¢é˜…/å‘å¸ƒéƒ½ä¸èƒ½ç”±è®¢é˜…æ–¹å’Œå‘å¸ƒæ–¹â€œç§ä¸‹æ²Ÿé€šâ€ï¼Œå¿…é¡»è¦å§”æ‰˜è¿™ä¸ªäº‹ä»¶ä¸­å¿ƒå¸®æˆ‘ä»¬å®ç°ã€‚</p></blockquote> <p>åœ¨Vueä¸­ï¼Œæœ‰æ—¶å€™ A ç»„ä»¶å’Œ B ç»„ä»¶ä¸­é—´éš”äº†å¾ˆè¿œï¼Œçœ‹ä¼¼æ²¡ä»€ä¹ˆå…³ç³»ï¼Œä½†æˆ‘ä»¬å¸Œæœ›å®ƒä»¬ä¹‹é—´èƒ½å¤Ÿé€šä¿¡ã€‚è¿™ç§æƒ…å†µä¸‹é™¤äº†æ±‚åŠ©äº <code>Vuex</code> ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ <code>Event Bus</code> æ¥å®ç°æˆ‘ä»¬çš„éœ€æ±‚ã€‚</p> <p>åˆ›å»ºä¸€ä¸ª <code>Event Bus</code>ï¼ˆæœ¬è´¨ä¸Šä¹Ÿæ˜¯ Vue å®ä¾‹ï¼‰å¹¶å¯¼å‡ºï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> EventBus <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> EventBus
</code></pre></div><p>åœ¨ä¸»æ–‡ä»¶é‡Œå¼•å…¥<code>EventBus</code>ï¼Œå¹¶æŒ‚è½½åˆ°å…¨å±€ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> bus <span class="token keyword">from</span> <span class="token string">'EventBusçš„æ–‡ä»¶è·¯å¾„'</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>bus <span class="token operator">=</span> bus
</code></pre></div><p>è®¢é˜…äº‹ä»¶ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// è¿™é‡ŒfuncæŒ‡someEventè¿™ä¸ªäº‹ä»¶çš„ç›‘å¬å‡½æ•°</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>bus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'someEvent'</span><span class="token punctuation">,</span> func<span class="token punctuation">)</span>
</code></pre></div><p>å‘å¸ƒï¼ˆè§¦å‘ï¼‰äº‹ä»¶ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// è¿™é‡ŒparamsæŒ‡someEventè¿™ä¸ªäº‹ä»¶è¢«è§¦å‘æ—¶å›è°ƒå‡½æ•°æ¥æ”¶çš„å…¥å‚</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>bus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'someEvent'</span><span class="token punctuation">,</span> params<span class="token punctuation">)</span>
</code></pre></div><blockquote><p>å¤§å®¶ä¼šå‘ç°ï¼Œæ•´ä¸ªè°ƒç”¨è¿‡ç¨‹ä¸­ï¼Œæ²¡æœ‰å‡ºç°å…·ä½“çš„å‘å¸ƒè€…å’Œè®¢é˜…è€…ï¼ˆæ¯”å¦‚ä¸Šé¢çš„<code>PrdPublisher</code>å’Œ<code>DeveloperObserver</code>ï¼‰ï¼Œå…¨ç¨‹åªæœ‰<code>bus</code>è¿™ä¸ªä¸œè¥¿ä¸€ä¸ªäººåœ¨ç–¯ç‹‚åˆ·å­˜åœ¨æ„Ÿã€‚è¿™å°±æ˜¯å…¨å±€äº‹ä»¶æ€»çº¿çš„ç‰¹ç‚¹â€”â€”æ‰€æœ‰äº‹ä»¶çš„å‘å¸ƒ/è®¢é˜…æ“ä½œï¼Œå¿…é¡»ç»ç”±äº‹ä»¶ä¸­å¿ƒï¼Œç¦æ­¢ä¸€åˆ‡â€œç§ä¸‹äº¤æ˜“â€ï¼</p></blockquote> <p>ä¸‹é¢ï¼Œæˆ‘ä»¬å°±ä¸€èµ·æ¥å®ç°ä¸€ä¸ª<code>Event Bus</code>ï¼ˆæ³¨æ„çœ‹æ³¨é‡Šé‡Œçš„è§£æï¼‰ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">EventEmitter</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// handlersæ˜¯ä¸€ä¸ªmapï¼Œç”¨äºå­˜å‚¨äº‹ä»¶ä¸å›è°ƒä¹‹é—´çš„å¯¹åº”å…³ç³»</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>handlers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// onæ–¹æ³•ç”¨äºå®‰è£…äº‹ä»¶ç›‘å¬å™¨ï¼Œå®ƒæ¥å—ç›®æ ‡äº‹ä»¶åå’Œå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°</span>
  <span class="token function">on</span><span class="token punctuation">(</span><span class="token parameter">eventName<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å…ˆæ£€æŸ¥ä¸€ä¸‹ç›®æ ‡äº‹ä»¶åæœ‰æ²¡æœ‰å¯¹åº”çš„ç›‘å¬å‡½æ•°é˜Ÿåˆ—</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>handlers<span class="token punctuation">[</span>eventName<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// å¦‚æœæ²¡æœ‰ï¼Œé‚£ä¹ˆé¦–å…ˆåˆå§‹åŒ–ä¸€ä¸ªç›‘å¬å‡½æ•°é˜Ÿåˆ—</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>handlers<span class="token punctuation">[</span>eventName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// æŠŠå›è°ƒå‡½æ•°æ¨å…¥ç›®æ ‡äº‹ä»¶çš„ç›‘å¬å‡½æ•°é˜Ÿåˆ—é‡Œå»</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>handlers<span class="token punctuation">[</span>eventName<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// emitæ–¹æ³•ç”¨äºè§¦å‘ç›®æ ‡äº‹ä»¶ï¼Œå®ƒæ¥å—äº‹ä»¶åå’Œç›‘å¬å‡½æ•°å…¥å‚ä½œä¸ºå‚æ•°</span>
  <span class="token function">emit</span><span class="token punctuation">(</span><span class="token parameter">eventName<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ£€æŸ¥ç›®æ ‡äº‹ä»¶æ˜¯å¦æœ‰ç›‘å¬å‡½æ•°é˜Ÿåˆ—</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>handlers<span class="token punctuation">[</span>eventName<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// å¦‚æœæœ‰ï¼Œåˆ™é€ä¸ªè°ƒç”¨é˜Ÿåˆ—é‡Œçš„å›è°ƒå‡½æ•°</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>handlers<span class="token punctuation">[</span>eventName<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// ç§»é™¤æŸä¸ªäº‹ä»¶å›è°ƒé˜Ÿåˆ—é‡Œçš„æŒ‡å®šå›è°ƒå‡½æ•°</span>
  <span class="token function">off</span><span class="token punctuation">(</span><span class="token parameter">eventName<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> callbacks <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handlers<span class="token punctuation">[</span>eventName<span class="token punctuation">]</span>
    <span class="token keyword">const</span> index <span class="token operator">=</span> callbacks<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      callbacks<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// ä¸ºäº‹ä»¶æ³¨å†Œå•æ¬¡ç›‘å¬å™¨</span>
  <span class="token function">once</span><span class="token punctuation">(</span><span class="token parameter">eventName<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¯¹å›è°ƒå‡½æ•°è¿›è¡ŒåŒ…è£…ï¼Œä½¿å…¶æ‰§è¡Œå®Œæ¯•è‡ªåŠ¨è¢«ç§»é™¤</span>
    <span class="token keyword">const</span> <span class="token function-variable function">wrapper</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">cb</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">off</span><span class="token punctuation">(</span>eventName<span class="token punctuation">,</span> wrapper<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span>eventName<span class="token punctuation">,</span> wrapper<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><blockquote><p>åœ¨æ—¥å¸¸çš„å¼€å‘ä¸­ï¼Œå¤§å®¶ç”¨åˆ°<code>EventBus/EventEmitter</code>å¾€å¾€æä¾›æ¯”è¿™äº”ä¸ªæ–¹æ³•å¤šçš„å¤šçš„å¤šçš„æ–¹æ³•ã€‚ä½†åœ¨é¢è¯•è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå¤§å®¶èƒ½å¤Ÿå®Œæ•´åœ°å®ç°å‡ºè¿™äº”ä¸ªæ–¹æ³•ï¼Œå·²ç»éå¸¸å¯ä»¥è¯´æ˜é—®é¢˜äº†ï¼Œå› æ­¤æ¥¼ä¸Šè¿™ä¸ª<code>EventBus</code>å¸Œæœ›å¤§å®¶å¯ä»¥ç†Ÿç»ƒæŒæ¡ã€‚å­¦æœ‰ä½™åŠ›çš„åŒå­¦ï¼Œæ¨èé˜…è¯»<a href="https://github.com/facebook/emitter" target="_blank" rel="noopener noreferrer">FaceBookæ¨å‡ºçš„é€šç”¨EventEmiiteråº“çš„æºç <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œç›¸ä¿¡ä½ ä¼šæœ‰æ›´å¤šæ”¶è·ã€‚</p></blockquote> <h3 id="_8-5-è§‚å¯Ÿè€…æ¨¡å¼ä¸å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#_8-5-è§‚å¯Ÿè€…æ¨¡å¼ä¸å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="header-anchor">#</a> 8.5 è§‚å¯Ÿè€…æ¨¡å¼ä¸å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3> <blockquote><p>åœ¨é¢è¯•è¿‡ç¨‹ä¸­ï¼Œä¸€äº›å¯¹ç»†èŠ‚æ¯”è¾ƒåœ¨æ„çš„é¢è¯•å®˜å¯èƒ½ä¼šè¿½é—®è§‚å¯Ÿè€…æ¨¡å¼ä¸å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„åŒºåˆ«ã€‚è¿™ä¸ªé—®é¢˜å¯èƒ½ä¼šå¼•å‘ä¸€äº›åŒå­¦çš„ä¸é€‚ï¼Œå› ä¸ºåœ¨å¤§é‡å‚è€ƒèµ„æ–™ä»¥åŠå·²å‡ºç‰ˆçš„çº¸è´¨ä¹¦ç±ä¸­ï¼Œéƒ½ä¼šå‘Šè¯‰å¤§å®¶â€œå‘å¸ƒ-è®¢é˜…æ¨¡å¼å’Œè§‚å¯Ÿè€…æ¨¡å¼æ˜¯åŒä¸€ä¸ªä¸œè¥¿çš„ä¸¤ä¸ªåå­—â€ã€‚æœ¬ä¹¦åœ¨å‰æ–‡çš„å™è¿°ä¸­ï¼Œä¹Ÿæ²¡æœ‰çªå‡ºå¼ºè°ƒä¸¤è€…çš„åŒºåˆ«ã€‚å…¶å®è¿™ä¸¤ä¸ªæ¨¡å¼ï¼Œè¦è¾ƒèµ·çœŸæ¥ï¼Œç¡®å®ä¸èƒ½ç»™å®ƒä»¬åˆ’ä¸¥æ ¼çš„ç­‰å·ã€‚</p></blockquote> <p>ä¸ºä»€ä¹ˆå¤§å®¶éƒ½å–œæ¬¢ç»™å®ƒä»¬å¼ºè¡Œåˆ’ç­‰å·å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºå°±ç®—åˆ’äº†ç­‰å·ï¼Œä¹Ÿä¸å½±å“æˆ‘ä»¬æ­£å¸¸ä½¿ç”¨ï¼Œæ¯•ç«Ÿä¸¤è€…åœ¨æ ¸å¿ƒæ€æƒ³ã€è¿ä½œæœºåˆ¶ä¸Šæ²¡æœ‰æœ¬è´¨çš„å·®åˆ«ã€‚ä½†è€ƒè™‘åˆ°è¿™ä¸ªé—®é¢˜ç¡®å®å¯ä»¥æˆä¸ºé¢è¯•é¢˜çš„ä¸€ä¸ªæ–¹å‘ï¼Œæ­¤å¤„æˆ‘ä»¬è¿˜æ˜¯å•ç‹¬æ‹¿å‡ºæ¥è®²ä¸€ä¸‹ã€‚</p> <p>å›åˆ°æˆ‘ä»¬ä¸Šæ–‡çš„ä¾‹å­é‡Œã€‚éŸ©æ¢…æ¢…æŠŠæ‰€æœ‰çš„å¼€å‘è€…æ‹‰äº†ä¸€ä¸ªç¾¤ï¼Œç›´æ¥æŠŠéœ€æ±‚æ–‡æ¡£ä¸¢ç»™æ¯ä¸€ä½ç¾¤æˆå‘˜ï¼Œè¿™ç§<strong>å‘å¸ƒè€…ç›´æ¥è§¦åŠåˆ°è®¢é˜…è€…</strong>çš„æ“ä½œï¼Œå«è§‚å¯Ÿè€…æ¨¡å¼ã€‚ä½†å¦‚æœéŸ©æ¢…æ¢…æ²¡æœ‰æ‹‰ç¾¤ï¼Œè€Œæ˜¯æŠŠéœ€æ±‚æ–‡æ¡£ä¸Šä¼ åˆ°äº†å…¬å¸ç»Ÿä¸€çš„éœ€æ±‚å¹³å°ä¸Šï¼Œéœ€æ±‚å¹³å°æ„ŸçŸ¥åˆ°æ–‡ä»¶çš„å˜åŒ–ã€è‡ªåŠ¨é€šçŸ¥äº†æ¯ä¸€ä½è®¢é˜…äº†è¯¥æ–‡ä»¶çš„å¼€å‘è€…ï¼Œè¿™ç§<strong>å‘å¸ƒè€…ä¸ç›´æ¥è§¦åŠåˆ°è®¢é˜…è€…ã€è€Œæ˜¯ç”±ç»Ÿä¸€çš„ç¬¬ä¸‰æ–¹æ¥å®Œæˆå®é™…çš„é€šä¿¡çš„æ“ä½œï¼Œå«åšå‘å¸ƒ-è®¢é˜…æ¨¡å¼</strong>ã€‚</p> <p>ç›¸ä¿¡å¤§å®¶ä¹Ÿå·²ç»çœ‹å‡ºæ¥äº†ï¼Œè§‚å¯Ÿè€…æ¨¡å¼å’Œå‘å¸ƒ-è®¢é˜…æ¨¡å¼ä¹‹é—´çš„åŒºåˆ«ï¼Œåœ¨äºæ˜¯å¦å­˜åœ¨ç¬¬ä¸‰æ–¹ã€å‘å¸ƒè€…èƒ½å¦ç›´æ¥æ„ŸçŸ¥è®¢é˜…è€…ï¼ˆå¦‚å›¾æ‰€ç¤ºï¼‰ã€‚</p> <p><img src="http://img-repo.poetries.top/images/20210327211020.png" alt=""></p> <p><strong>è§‚å¯Ÿè€…æ¨¡å¼</strong></p> <p><img src="http://img-repo.poetries.top/images/20210327211122.png" alt=""></p> <p><strong>å‘å¸ƒ-è®¢é˜…æ¨¡å¼</strong></p> <blockquote><p>åœ¨æˆ‘ä»¬è§è¿‡çš„è¿™äº›ä¾‹å­é‡Œï¼ŒéŸ©æ¢…æ¢…æ‹‰é’‰é’‰ç¾¤çš„æ“ä½œï¼Œå°±æ˜¯å…¸å‹çš„<code>è§‚å¯Ÿè€…æ¨¡å¼</code>ï¼›è€Œé€šè¿‡<code>EventBus</code>å»å®ç°äº‹ä»¶<code>ç›‘å¬/å‘å¸ƒ</code>ï¼Œåˆ™å±äº<code>å‘å¸ƒ-è®¢é˜…æ¨¡å¼</code>ã€‚</p></blockquote> <p>æ—¢ç”Ÿç‘œï¼Œä½•ç”Ÿäº®ï¼Ÿæ—¢ç„¶æœ‰äº†è§‚å¯Ÿè€…æ¨¡å¼ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦å‘å¸ƒ-è®¢é˜…æ¨¡å¼å‘¢ï¼Ÿ</p> <blockquote><p>å¤§å®¶æ€è€ƒä¸€ä¸‹ï¼šä¸ºä»€ä¹ˆè¦æœ‰è§‚å¯Ÿè€…æ¨¡å¼ï¼Ÿ<code>è§‚å¯Ÿè€…æ¨¡å¼</code>ï¼Œè§£å†³çš„å…¶å®æ˜¯æ¨¡å—é—´çš„è€¦åˆé—®é¢˜ï¼Œæœ‰å®ƒåœ¨ï¼Œå³ä¾¿æ˜¯ä¸¤ä¸ªåˆ†ç¦»çš„ã€æ¯«ä¸ç›¸å…³çš„æ¨¡å—ï¼Œä¹Ÿå¯ä»¥å®ç°æ•°æ®é€šä¿¡ã€‚ä½†è§‚å¯Ÿè€…æ¨¡å¼ä»…ä»…æ˜¯å‡å°‘äº†è€¦åˆï¼Œ<strong>å¹¶æ²¡æœ‰å®Œå…¨åœ°è§£å†³è€¦åˆé—®é¢˜</strong>â€”â€”è¢«è§‚å¯Ÿè€…å¿…é¡»å»ç»´æŠ¤ä¸€å¥—è§‚å¯Ÿè€…çš„é›†åˆï¼Œè¿™äº›è§‚å¯Ÿè€…å¿…é¡»å®ç°ç»Ÿä¸€çš„æ–¹æ³•ä¾›è¢«è§‚å¯Ÿè€…è°ƒç”¨ï¼Œä¸¤è€…ä¹‹é—´è¿˜æ˜¯æœ‰ç€è¯´ä¸æ¸…ã€é“ä¸æ˜çš„å…³ç³»ã€‚</p></blockquote> <p>è€Œ<code>å‘å¸ƒ-è®¢é˜…æ¨¡å¼</code>ï¼Œåˆ™æ˜¯å¿«åˆ€æ–©ä¹±éº»äº†â€”â€”<code>å‘å¸ƒè€…å®Œå…¨ä¸ç”¨æ„ŸçŸ¥è®¢é˜…è€…</code>ï¼Œä¸ç”¨å…³å¿ƒå®ƒæ€ä¹ˆå®ç°å›è°ƒæ–¹æ³•ï¼Œ<code>äº‹ä»¶çš„æ³¨å†Œå’Œè§¦å‘éƒ½å‘ç”Ÿåœ¨ç‹¬ç«‹äºåŒæ–¹çš„ç¬¬ä¸‰æ–¹å¹³å°ï¼ˆäº‹ä»¶æ€»çº¿ï¼‰ä¸Š</code>ã€‚<code>å‘å¸ƒ-è®¢é˜…æ¨¡å¼</code>ä¸‹ï¼Œå®ç°äº†å®Œå…¨åœ°è§£è€¦ã€‚</p> <blockquote><p>ä½†è¿™å¹¶ä¸æ„å‘³ç€ï¼Œ<code>å‘å¸ƒ-è®¢é˜…æ¨¡å¼å°±æ¯”è§‚å¯Ÿè€…æ¨¡å¼â€œé«˜çº§â€</code>ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬çš„æ¨¡å—è§£è€¦è¯‰æ±‚<strong>å¹¶éæ€»æ˜¯éœ€è¦å®ƒä»¬å®Œå…¨è§£è€¦</strong>ã€‚å¦‚æœä¸¤ä¸ªæ¨¡å—ä¹‹é—´æœ¬èº«å­˜åœ¨å…³è”ï¼Œä¸”è¿™ç§å…³è”æ˜¯ç¨³å®šçš„ã€å¿…è¦çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼å°±è¶³å¤Ÿäº†ã€‚è€Œåœ¨æ¨¡å—ä¸æ¨¡å—ä¹‹é—´ç‹¬ç«‹æ€§è¾ƒå¼ºã€ä¸”æ²¡æœ‰å¿…è¦å•çº¯ä¸ºäº†æ•°æ®é€šä¿¡è€Œå¼ºè¡Œä¸ºä¸¤è€…åˆ¶é€ ä¾èµ–çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¾€å¾€ä¼šå€¾å‘äºä½¿ç”¨<code>å‘å¸ƒ-è®¢é˜…æ¨¡å¼</code>ã€‚</p></blockquote> <h2 id="_9-è¡Œä¸ºå‹-è¿­ä»£å™¨æ¨¡å¼"><a href="#_9-è¡Œä¸ºå‹-è¿­ä»£å™¨æ¨¡å¼" class="header-anchor">#</a> 9 è¡Œä¸ºå‹-è¿­ä»£å™¨æ¨¡å¼</h2> <blockquote><p>è¿­ä»£å™¨æ¨¡å¼æä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚ â€”â€”ã€Šè®¾è®¡æ¨¡å¼ï¼šå¯å¤ç”¨é¢å‘å¯¹è±¡è½¯ä»¶çš„åŸºç¡€ã€‹</p></blockquote> <p>è¿­ä»£å™¨æ¨¡å¼æ˜¯è®¾è®¡æ¨¡å¼ä¸­å°‘æœ‰çš„<strong>ç›®çš„æ€§æå¼ºçš„æ¨¡å¼</strong>ã€‚æ‰€è°“â€œç›®çš„æ€§æå¼ºâ€å°±æ˜¯è¯´å®ƒä¸æ“å¿ƒåˆ«çš„ï¼Œå®ƒå°±è§£å†³è¿™ä¸€ä¸ªé—®é¢˜â€”â€”éå†ã€‚</p> <h3 id="_9-1-â€œå…¬å…ƒå‰â€çš„è¿­ä»£å™¨æ¨¡å¼"><a href="#_9-1-â€œå…¬å…ƒå‰â€çš„è¿­ä»£å™¨æ¨¡å¼" class="header-anchor">#</a> 9.1 â€œå…¬å…ƒå‰â€çš„è¿­ä»£å™¨æ¨¡å¼</h3> <blockquote><p>éå†ä½œä¸ºä¸€ç§åˆç†ã€é«˜é¢‘çš„ä½¿ç”¨éœ€æ±‚ï¼Œå‡ ä¹æ²¡æœ‰è¯­è¨€ä¼šè¦æ±‚å®ƒçš„å¼€å‘è€…æ‰‹åŠ¨å»å®ç°ã€‚åœ¨JSä¸­ï¼Œæœ¬èº«ä¹Ÿå†…ç½®äº†ä¸€ä¸ªæ¯”è¾ƒç®€é™‹çš„æ•°ç»„è¿­ä»£å™¨çš„å®ç°â€”â€” <code>Array.prototype.forEach</code></p></blockquote> <p>é€šè¿‡è°ƒç”¨<code>forEach</code>æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°éå†ä¸€ä¸ªæ•°ç»„ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ç´¢å¼•ä¸º</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>index<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">çš„å…ƒç´ æ˜¯</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>ä½†<code>forEach</code>æ–¹æ³•å¹¶ä¸æ˜¯ä¸‡èƒ½çš„ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ç§åœºæ™¯ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ie=edge<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>äº‹ä»¶ä»£ç†<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>é“¾æ¥1å·<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>é“¾æ¥2å·<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>é“¾æ¥3å·<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>é“¾æ¥4å·<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>é“¾æ¥5å·<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>é“¾æ¥6å·<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>æˆ‘æƒ³æ‹¿åˆ°æ‰€æœ‰çš„aæ ‡ç­¾ï¼Œæˆ‘å¯ä»¥è¿™æ ·åšï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> aNodes <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'aNodes are'</span><span class="token punctuation">,</span> aNodes<span class="token punctuation">)</span>
</code></pre></div><p>æˆ‘æƒ³å–å…¶ä¸­ä¸€ä¸ª<code>a</code>æ ‡ç­¾ï¼Œå¯ä»¥è¿™æ ·åšï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> aNode <span class="token operator">=</span> aNodes<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
</code></pre></div><p>åœ¨è¿™ä¸ªæ“ä½œçš„æ˜ è¡¬ä¸‹ï¼Œ<code>aNodes</code>çœ‹ä¸Šå»å¤šä¹ˆåƒä¸€ä¸ªæ•°ç»„å•Šï¼ä½†å½“ä½ å°è¯•ç”¨æ•°ç»„çš„åŸå‹æ–¹æ³•å»éå†å®ƒæ—¶ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>aNodes<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>aNode<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>aNode<span class="token punctuation">,</span> index<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>ä½ å‘ç°æŠ¥é”™äº†ï¼š</p> <p><img src="http://img-repo.poetries.top/images/20210327212411.png" alt=""></p> <p>åŸæ¥è¿™ä¸ª<code>aNodes</code>æ˜¯ä¸ªå‡æ•°ç»„ï¼å‡†ç¡®åœ°è¯´ï¼Œå®ƒæ˜¯ä¸€ä¸ª<strong>ç±»æ•°ç»„</strong>å¯¹è±¡ï¼Œå¹¶æ²¡æœ‰ä¸ºä½ å®ç°å¥½ç”¨çš„<code>forEach</code>æ–¹æ³•ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¦æƒ³å®ç°ç±»æ•°ç»„çš„éå†ï¼Œä½ å¾—å¦è¯·é«˜æ˜ã€‚</p> <p>ç°åœ¨é—®é¢˜å°±å‡ºç°äº†ï¼šæ™®é€šæ•°ç»„æ˜¯ä¸æ˜¯é›†åˆï¼Ÿæ˜¯ï¼<code>aNodes</code>æ˜¯ä¸æ˜¯é›†åˆï¼Ÿæ˜¯ï¼åŒæ ·æ˜¯é›†åˆï¼ŒåŒæ ·æœ‰éå†éœ€æ±‚ï¼Œæˆ‘ä»¬å´è¦é’ˆå¯¹ä¸åŒçš„æ•°æ®ç»“æ„æ‰§è¡Œä¸åŒçš„éå†æ‰‹æ®µï¼Œå¥½ç´¯ï¼å†å›å¤´çœ‹çœ‹è¿­ä»£å™¨çš„å®šä¹‰æ˜¯ä»€ä¹ˆâ€”â€”éå†é›†åˆçš„åŒæ—¶ï¼Œæˆ‘ä»¬<strong>ä¸éœ€è¦å…³å¿ƒé›†åˆçš„å†…éƒ¨ç»“æ„</strong>ã€‚è€Œ<code>forEach</code>åªèƒ½åšåˆ°å…è®¸æˆ‘ä»¬ä¸å…³å¿ƒæ•°ç»„è¿™ä¸€ç§é›†åˆçš„å†…éƒ¨ç»“æ„ï¼Œçœ‹æ¥æƒ³è¦ä¸€å¥—ç»Ÿä¸€çš„éå†æ–¹æ¡ˆï¼Œæˆ‘ä»¬éå¾—è¯·å‡ºä¸€ä¸ª<strong>æ›´å¼ºçš„é€šç”¨è¿­ä»£å™¨</strong>ä¸å¯äº†ã€‚</p> <p>è¿™ä¸ªå°èŠ‚çš„æ ‡é¢˜å®šè¯­é‡Œæœ‰ä¸‰ä¸ªå­—â€œå…¬å…ƒå‰â€ï¼Œè¿™ä¸ªâ€œå…¬å…ƒå‰â€æ€ä¹ˆå®šä¹‰å‘¢ï¼Ÿå…¶å®å®ƒè¯´çš„å°±æ˜¯ESæ ‡å‡†å†…ç½®è¿­ä»£å™¨ä¹‹å‰çš„é‚£äº›æ—¥å­â€”â€”å·®ä¸å¤šå››äº”å¹´ä¹‹å‰ï¼Œå½¼æ—¶è¿˜æ²¡æœ‰è¿™ä¹ˆå¤šè½®å­ï¼Œ<code>jQuery</code>é£å¤´æ­£ç››ã€‚å½“æ—¶é¢è¯•å¯ä¸é—®ä»€ä¹ˆ<code>Vue</code>åŸç†ã€<code>React</code>åŸç†ã€<code>Webpack</code>è¿™äº›ï¼Œå½“æ—¶é—®çš„æœ€å¤šçš„æ˜¯<strong>ä½ è¯»è¿‡jQueryæºç å—</strong>ï¼Ÿç­”è¯»è¿‡ï¼Œå¥½ï¼Œé‚£å’±ä»¬å°±æœ‰çš„èŠäº†ã€‚ç­”æ²¡æœ‰ï¼Ÿfineï¼Œçœ‹æ¥ä½ åªæ˜¯ä¸ªè°ƒåŒ…ä¾ ï¼Œå›è§å§â€”â€”å› ä¸ºå‰ç«¯çš„æŠ€æœ¯ç‚¹åœ¨é‚£æ—¶è¿˜å¾ˆæœ‰é™ï¼Œæ‰€ä»¥å¯è€ƒå¯Ÿçš„ä¸œè¥¿ä¹Ÿå°±è¿™ä¹ˆç‚¹ï¼Œè¯»jQueryæºç çš„ç¨‹åºå‘˜å’Œä¸è¯»jQueryæºç çš„ç¨‹åºå‘˜åœ¨é¢è¯•å®˜çœ¼é‡Œæœ‰ç€è´¨çš„åŒºåˆ«ã€‚ä½†è¿™ä¹Ÿä»ä¸€ä¸ªä¾§é¢åæ˜ å‡ºæ¥ï¼ŒjQueryè¿™ä¸ªåº“å…¶å®æ˜¯éå¸¸ä¼˜ç§€çš„ï¼Œè‡³å°‘jQueryé‡Œæœ‰å¤ªå¤šä¼˜ç§€çš„è®¾è®¡æ¨¡å¼å¯ä»¥æ‹¿æ¥è€ƒè€ƒä½ ã€‚å°±åŒ…æ‹¬å’±ä»¬å½“å¹´æƒ³ç”¨ä¸€ä¸ªçœŸÂ·è¿­ä»£å™¨åˆä¸æƒ³è‡ªå·±æçš„æ—¶å€™ï¼Œä¹Ÿæ˜¯è¯·jQueryå®ç°çš„è¿­ä»£å™¨æ¥å¸®å¿™ï¼š</p> <p>é¦–å…ˆæˆ‘ä»¬è¦åœ¨é¡µé¢é‡Œå¼•å…¥jQueryï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>  &lt;script src=&quot;https://cdn.bootcss.com/jquery/3.3.0/jquery.min.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
</code></pre></div><p>å€ŸåŠ©<code>jQuery</code>çš„<code>each</code>æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åŒä¸€å¥—éå†è§„åˆ™éå†ä¸åŒçš„é›†åˆå¯¹è±¡ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> aNodes <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>

$<span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span> item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">æ•°ç»„çš„ç¬¬</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>index<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">ä¸ªå…ƒç´ æ˜¯</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

$<span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span>aNodes<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span> aNode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">DOMç±»æ•°ç»„çš„ç¬¬</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>index<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">ä¸ªå…ƒç´ æ˜¯</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>aNode<span class="token punctuation">.</span>innerText<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>è¾“å‡ºç»“æœå®Œå…¨æ²¡é—®é¢˜ï¼š</p> <p><img src="https://user-gold-cdn.xitu.io/2019/4/5/169ec0943e93c3cd?w=653&amp;h=346&amp;f=png&amp;s=195823" alt=""></p> <p>å½“ç„¶å•¦ï¼Œéå†<code>jQuery</code>è‡ªå·±çš„é›†åˆå¯¹è±¡ä¹Ÿä¸åœ¨è¯ä¸‹ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> jQNodes <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
$<span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span>jQNodes<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span> aNode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">jQueryé›†åˆçš„ç¬¬</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>index<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">ä¸ªå…ƒç´ æ˜¯</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>aNode<span class="token punctuation">.</span>innerText<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>è¾“å‡ºç»“æœä»ç„¶æ²¡é—®é¢˜ï¼š</p> <p><img src="http://img-repo.poetries.top/images/20210327212836.png" alt=""></p> <blockquote><p>å¯ä»¥çœ‹å‡ºï¼Œ<code>jQuery</code>çš„è¿­ä»£å™¨ä¸ºæˆ‘ä»¬ç»Ÿä¸€äº†ä¸åŒç±»å‹é›†åˆçš„éå†æ–¹å¼ï¼Œä½¿æˆ‘ä»¬åœ¨è®¿é—®é›†åˆå†…æ¯ä¸€ä¸ªæˆå‘˜æ—¶ä¸ç”¨å»å…³å¿ƒé›†åˆæœ¬èº«çš„å†…éƒ¨ç»“æ„ä»¥åŠé›†åˆä¸é›†åˆé—´çš„å·®å¼‚ï¼Œè¿™å°±æ˜¯è¿­ä»£å™¨å­˜åœ¨çš„ä»·å€¼~</p></blockquote> <h3 id="_9-2-es6å¯¹è¿­ä»£å™¨çš„å®ç°"><a href="#_9-2-es6å¯¹è¿­ä»£å™¨çš„å®ç°" class="header-anchor">#</a> 9.2 ES6å¯¹è¿­ä»£å™¨çš„å®ç°</h3> <p>åœ¨â€œå…¬å…ƒå‰â€ï¼ŒJSåŸç”Ÿçš„é›†åˆç±»å‹æ•°æ®ç»“æ„ï¼Œåªæœ‰<code>Array</code>ï¼ˆæ•°ç»„ï¼‰å’Œ<code>Object</code>ï¼ˆå¯¹è±¡ï¼‰ï¼›è€Œ<code>ES6</code>ä¸­ï¼Œåˆæ–°å¢äº†<code>Map</code>å’Œ<code>Set</code>ã€‚å››ç§æ•°æ®ç»“æ„å„è‡ªæœ‰ç€è‡ªå·±ç‰¹åˆ«çš„å†…éƒ¨å®ç°ï¼Œä½†æˆ‘ä»¬ä»æœŸå¾…ä»¥åŒæ ·çš„ä¸€å¥—è§„åˆ™å»éå†å®ƒä»¬ï¼Œæ‰€ä»¥<code>ES6</code>åœ¨æ¨å‡ºæ–°æ•°æ®ç»“æ„çš„åŒæ—¶ä¹Ÿæ¨å‡ºäº†ä¸€å¥—<strong>ç»Ÿä¸€çš„æ¥å£æœºåˆ¶</strong>â€”â€”è¿­ä»£å™¨ï¼ˆ<code>Iterator</code>ï¼‰ã€‚</p> <blockquote><p><code>ES6</code>çº¦å®šï¼Œä»»ä½•æ•°æ®ç»“æ„åªè¦å…·å¤‡<code>Symbol.iterator</code>å±æ€§ï¼ˆè¿™ä¸ªå±æ€§å°±æ˜¯<code>Iterator</code>çš„å…·ä½“å®ç°ï¼Œå®ƒæœ¬è´¨ä¸Šæ˜¯å½“å‰æ•°æ®ç»“æ„é»˜è®¤çš„è¿­ä»£å™¨ç”Ÿæˆå‡½æ•°ï¼‰ï¼Œå°±å¯ä»¥è¢«éå†â€”â€”å‡†ç¡®åœ°è¯´ï¼Œæ˜¯è¢«<code>for...of...</code>å¾ªç¯å’Œè¿­ä»£å™¨çš„nextæ–¹æ³•éå†ã€‚ äº‹å®ä¸Šï¼Œ<code>for...of...</code>çš„èƒŒåæ­£æ˜¯å¯¹<code>next</code>æ–¹æ³•çš„åå¤è°ƒç”¨ã€‚</p></blockquote> <p>åœ¨ES6ä¸­ï¼Œé’ˆå¯¹<code>Array</code>ã€<code>Map</code>ã€<code>Set</code>ã€<code>String</code>ã€<code>TypedArray</code>ã€å‡½æ•°çš„ <code>arguments</code> å¯¹è±¡ã€<code>NodeList</code> å¯¹è±¡è¿™äº›åŸç”Ÿçš„æ•°æ®ç»“æ„éƒ½å¯ä»¥é€šè¿‡<code>for...of...</code>è¿›è¡Œéå†ã€‚åŸç†éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ­¤å¤„æˆ‘ä»¬æ‹¿æœ€ç®€å•çš„æ•°ç»„è¿›è¡Œä¸¾ä¾‹ï¼Œå½“æˆ‘ä»¬ç”¨<code>for...of...</code>éå†æ•°ç»„æ—¶ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> len <span class="token operator">=</span> arr<span class="token punctuation">.</span>length
<span class="token keyword">for</span><span class="token punctuation">(</span>item <span class="token keyword">of</span> arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">å½“å‰å…ƒç´ æ˜¯</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>ä¹‹æ‰€ä»¥èƒ½å¤ŸæŒ‰é¡ºåºä¸€æ¬¡ä¸€æ¬¡åœ°æ‹¿åˆ°æ•°ç»„é‡Œçš„æ¯ä¸€ä¸ªæˆå‘˜ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬å€ŸåŠ©æ•°ç»„çš„<code>Symbol.iterator</code>ç”Ÿæˆäº†å®ƒå¯¹åº”çš„è¿­ä»£å™¨å¯¹è±¡ï¼Œé€šè¿‡åå¤è°ƒç”¨è¿­ä»£å™¨å¯¹è±¡çš„<code>next</code>æ–¹æ³•è®¿é—®äº†æ•°ç»„æˆå‘˜ï¼Œåƒè¿™æ ·ï¼š</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token comment">// é€šè¿‡è°ƒç”¨iteratorï¼Œæ‹¿åˆ°è¿­ä»£å™¨å¯¹è±¡</span>
<span class="token keyword">const</span> iterator <span class="token operator">=</span> arr<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// å¯¹è¿­ä»£å™¨å¯¹è±¡æ‰§è¡Œnextï¼Œå°±èƒ½é€ä¸ªè®¿é—®é›†åˆçš„æˆå‘˜</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>ä¸¢è¿›æ§åˆ¶å°ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>next</code>æ¯æ¬¡ä¼šæŒ‰é¡ºåºå¸®æˆ‘ä»¬è®¿é—®ä¸€ä¸ªé›†åˆæˆå‘˜ï¼š</p> <p><img src="http://img-repo.poetries.top/images/20210327213037.png" alt=""></p> <blockquote><p>è€Œ<code>for...of...</code>åšçš„äº‹æƒ…ï¼ŒåŸºæœ¬ç­‰ä»·äºä¸‹é¢è¿™é€šæ“ä½œï¼š</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// é€šè¿‡è°ƒç”¨iteratorï¼Œæ‹¿åˆ°è¿­ä»£å™¨å¯¹è±¡</span>
<span class="token keyword">const</span> iterator <span class="token operator">=</span> arr<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// åˆå§‹åŒ–ä¸€ä¸ªè¿­ä»£ç»“æœ</span>
<span class="token keyword">let</span> now <span class="token operator">=</span> <span class="token punctuation">{</span> done<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span>

<span class="token comment">// å¾ªç¯å¾€å¤–è¿­ä»£æˆå‘˜</span>
<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>now<span class="token punctuation">.</span>done<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    now <span class="token operator">=</span> iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>now<span class="token punctuation">.</span>done<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ç°åœ¨éå†åˆ°äº†</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>now<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>å¯ä»¥çœ‹å‡ºï¼Œ<code>for...of...</code>å…¶å®å°±æ˜¯<code>iterator</code>å¾ªç¯è°ƒç”¨æ¢äº†ç§å†™æ³•ã€‚åœ¨ES6ä¸­æˆ‘ä»¬ä¹‹æ‰€ä»¥èƒ½å¤Ÿå¼€å¿ƒåœ°ç”¨<code>for...of...</code>éå†å„ç§å„ç§çš„é›†åˆï¼Œå…¨é è¿­ä»£å™¨æ¨¡å¼åœ¨èƒŒåç»™åŠ›ã€‚</p></blockquote> <p>psï¼šæ­¤å¤„æ¨èé˜…è¯»<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Iteration_protocols" target="_blank" rel="noopener noreferrer">è¿­ä»£åè®®<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œç›¸ä¿¡å¤§å®¶è¯»è¿‡åä¼šå¯¹è¿­ä»£å™¨åœ¨ES6ä¸­çš„å®ç°æœ‰æ›´æ·±çš„ç†è§£ã€‚</p> <h3 id="_9-3-å®ç°ä¸€ä¸ªè¿­ä»£å™¨ç”Ÿæˆå‡½æ•°"><a href="#_9-3-å®ç°ä¸€ä¸ªè¿­ä»£å™¨ç”Ÿæˆå‡½æ•°" class="header-anchor">#</a> 9.3 å®ç°ä¸€ä¸ªè¿­ä»£å™¨ç”Ÿæˆå‡½æ•°</h3> <p>okï¼Œçœ‹è¿‡äº†è¿­ä»£å™¨ä»å¤è‡³ä»Šçš„æ“ä½œï¼Œæˆ‘ä»¬ä¸€èµ·æ¥å®ç°ä¸€ä¸ªè‡ªå®šä¹‰çš„è¿­ä»£å™¨ã€‚</p> <p>æ¥¼ä¸Šæˆ‘ä»¬è¯´<strong>è¿­ä»£å™¨å¯¹è±¡</strong>å…¨å‡­<strong>è¿­ä»£å™¨ç”Ÿæˆå‡½æ•°</strong>å¸®æˆ‘ä»¬ç”Ÿæˆã€‚åœ¨<code>ES6</code>ä¸­ï¼Œå®ç°ä¸€ä¸ªè¿­ä»£å™¨ç”Ÿæˆå‡½æ•°å¹¶ä¸æ˜¯ä»€ä¹ˆéš¾äº‹å„¿ï¼Œå› ä¸ºES6æ—©å¸®æˆ‘ä»¬è€ƒè™‘å¥½äº†å…¨å¥—çš„è§£å†³æ–¹æ¡ˆï¼Œå†…ç½®äº†è´´å¿ƒçš„<strong>ç”Ÿæˆå™¨</strong>ï¼ˆ<code>Generator</code>ï¼‰ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ç¼–å†™ä¸€ä¸ªè¿­ä»£å™¨ç”Ÿæˆå‡½æ•°</span>
<span class="token keyword">function</span> <span class="token operator">*</span><span class="token function">iteratorGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">yield</span> <span class="token string">'1å·é€‰æ‰‹'</span>
    <span class="token keyword">yield</span> <span class="token string">'2å·é€‰æ‰‹'</span>
    <span class="token keyword">yield</span> <span class="token string">'3å·é€‰æ‰‹'</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> iterator <span class="token operator">=</span> <span class="token function">iteratorGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>ä¸¢è¿›æ§åˆ¶å°ï¼Œä¸è´Ÿä¼—æœ›ï¼š</p> <p><img src="http://img-repo.poetries.top/images/20210327213223.png" alt=""></p> <p>å†™ä¸€ä¸ªç”Ÿæˆå™¨å‡½æ•°å¹¶æ²¡æœ‰ä»€ä¹ˆéš¾åº¦ï¼Œä½†åœ¨é¢è¯•çš„è¿‡ç¨‹ä¸­ï¼Œé¢è¯•å®˜å¾€å¾€å¯¹ç”Ÿæˆå™¨è¿™ç§è¯­æ³•ç³–èƒŒåçš„å®ç°é€»è¾‘æ›´æ„Ÿå…´è¶£ã€‚ä¸‹é¢æˆ‘ä»¬è¦åšçš„ï¼Œä¸ä»…ä»…æ˜¯å†™ä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡ï¼Œè€Œæ˜¯ç”¨<code>ES5</code>å»å†™ä¸€ä¸ªèƒ½å¤Ÿç”Ÿæˆè¿­ä»£å™¨å¯¹è±¡çš„è¿­ä»£å™¨ç”Ÿæˆå‡½æ•°ï¼ˆè§£æåœ¨æ³¨é‡Šé‡Œï¼‰ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å®šä¹‰ç”Ÿæˆå™¨å‡½æ•°ï¼Œå…¥å‚æ˜¯ä»»æ„é›†åˆ</span>
<span class="token keyword">function</span> <span class="token function">iteratorGenerator</span><span class="token punctuation">(</span><span class="token parameter">list</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// idxè®°å½•å½“å‰è®¿é—®çš„ç´¢å¼•</span>
    <span class="token keyword">var</span> idx <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token comment">// lenè®°å½•ä¼ å…¥é›†åˆçš„é•¿åº¦</span>
    <span class="token keyword">var</span> len <span class="token operator">=</span> list<span class="token punctuation">.</span>length
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token comment">// è‡ªå®šä¹‰nextæ–¹æ³•</span>
        <span class="token function-variable function">next</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// å¦‚æœç´¢å¼•è¿˜æ²¡æœ‰è¶…å‡ºé›†åˆé•¿åº¦ï¼Œdoneä¸ºfalse</span>
            <span class="token keyword">var</span> done <span class="token operator">=</span> idx <span class="token operator">&gt;=</span> len
            <span class="token comment">// å¦‚æœdoneä¸ºfalseï¼Œåˆ™å¯ä»¥ç»§ç»­å–å€¼</span>
            <span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token operator">!</span>done <span class="token operator">?</span> list<span class="token punctuation">[</span>idx<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token keyword">undefined</span>

            <span class="token comment">// å°†å½“å‰å€¼ä¸éå†æ˜¯å¦å®Œæ¯•ï¼ˆdoneï¼‰è¿”å›</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                done<span class="token punctuation">:</span> done<span class="token punctuation">,</span>
                value<span class="token punctuation">:</span> value
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> iterator <span class="token operator">=</span> <span class="token function">iteratorGenerator</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'1å·é€‰æ‰‹'</span><span class="token punctuation">,</span> <span class="token string">'2å·é€‰æ‰‹'</span><span class="token punctuation">,</span> <span class="token string">'3å·é€‰æ‰‹'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>æ­¤å¤„ä¸ºäº†è®°å½•æ¯æ¬¡éå†çš„ä½ç½®ï¼Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ªé—­åŒ…ï¼Œå€ŸåŠ©è‡ªç”±å˜é‡æ¥åšæˆ‘ä»¬çš„è¿­ä»£è¿‡ç¨‹ä¸­çš„â€œæ¸¸æ ‡â€ã€‚</p> <p>è¿è¡Œä¸€ä¸‹æˆ‘ä»¬è‡ªå®šä¹‰çš„è¿­ä»£å™¨ï¼Œç»“æœç¬¦åˆé¢„æœŸï¼š</p> <p><img src="http://img-repo.poetries.top/images/20210327213700.png" alt=""></p> <p>è¿­ä»£å™¨æ¨¡å¼æ¯”è¾ƒç‰¹åˆ«ï¼Œå®ƒéå¸¸é‡è¦ï¼Œé‡è¦åˆ°è¯­è¨€å’Œæ¡†æ¶éƒ½äº‰ç€æŠ¢ç€å¸®æˆ‘ä»¬å®ç°ã€‚ä½†ä¹Ÿæ­£å› ä¸ºå¦‚æ­¤ï¼Œå¤§å®¶ä¸šåŠ¡å¼€å‘ä¸­éœ€è¦æ‰‹åŠ¨å†™è¿­ä»£å™¨çš„åœºæ™¯å‡ ä¹æ²¡æœ‰ï¼Œæ‰€ä»¥å¾ˆå°‘æœ‰åŒå­¦ä¼šå»åˆ»æ„ç•™æ„è¿­ä»£å™¨æ¨¡å¼ã€æ€è€ƒå®ƒèƒŒåçš„å®ç°æœºåˆ¶ã€‚é€šè¿‡é˜…è¯»æœ¬èŠ‚ï¼Œå¸Œæœ›å¤§å®¶å¯ä»¥é¢†ç•¥è¿­ä»£å™¨æ¨¡å¼çš„å¦™å¤„ï¼ˆä¸ºä»€ä¹ˆä¼šæœ‰ï¼Œä¸ºä»€ä¹ˆè¦ç”¨ï¼‰å’Œè¿­ä»£å™¨æ¨¡å¼çš„å®ç°æ€è·¯ï¼ˆæ–¹ä¾¿é¢è¯•ï¼‰ã€‚</p> <h2 id="_10-ä¸­ä»‹è€…æ¨¡å¼"><a href="#_10-ä¸­ä»‹è€…æ¨¡å¼" class="header-anchor">#</a> 10 ä¸­ä»‹è€…æ¨¡å¼</h2> <blockquote><p>å®šä¹‰ï¼šå¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´å€ŸåŠ©ç¬¬ä¸‰æ–¹ä¸­ä»‹è€…é€šä¿¡</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Player</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>playerMiddle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PlayerMiddle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>playerMiddle<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">win</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>playerMiddle<span class="token punctuation">.</span><span class="token function">win</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">lose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>playerMiddle<span class="token punctuation">.</span><span class="token function">lose</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// ä¸­ä»‹è€…</span>
<span class="token keyword">class</span> <span class="token class-name">PlayerMiddle</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>players <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>winArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>loseArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>players<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token function">win</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>winArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>winArr<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>loseArr<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span>players<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token function">lose</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>loseArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>winArr<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>loseArr<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span>players<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> winner <span class="token keyword">of</span> <span class="token keyword">this</span><span class="token punctuation">.</span>winArr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>winner <span class="token operator">+</span> <span class="token string">'æŒ‘æˆ˜æˆåŠŸ;'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> loser <span class="token keyword">of</span> <span class="token keyword">this</span><span class="token punctuation">.</span>loseArr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>loser <span class="token operator">+</span> <span class="token string">'æŒ‘æˆ˜å¤±è´¥;'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Player</span><span class="token punctuation">(</span><span class="token string">'A é€‰æ‰‹'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Player</span><span class="token punctuation">(</span><span class="token string">'B é€‰æ‰‹'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Player</span><span class="token punctuation">(</span><span class="token string">'C é€‰æ‰‹'</span><span class="token punctuation">)</span>

a<span class="token punctuation">.</span><span class="token function">win</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
b<span class="token punctuation">.</span><span class="token function">win</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
c<span class="token punctuation">.</span><span class="token function">lose</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_11-äº«å…ƒæ¨¡å¼"><a href="#_11-äº«å…ƒæ¨¡å¼" class="header-anchor">#</a> 11 äº«å…ƒæ¨¡å¼</h2> <blockquote><p>å®šä¹‰ï¼šä¸€ç§ä¼˜åŒ–ç¨‹åºæ€§èƒ½çš„æ¨¡å¼, æœ¬è´¨ä¸ºå‡å°‘å¯¹è±¡åˆ›å»ºçš„ä¸ªæ•°ã€‚</p></blockquote> <p>ä»¥ä¸‹æƒ…å†µå¯ä»¥ä½¿ç”¨äº«å…ƒæ¨¡å¼</p> <ol><li>æœ‰å¤§é‡ç›¸ä¼¼çš„å¯¹è±¡ï¼Œå ç”¨äº†å¤§é‡å†…å­˜</li> <li>å¯¹è±¡ä¸­å¤§éƒ¨åˆ†çŠ¶æ€å¯ä»¥æŠ½ç¦»ä¸ºå¤–éƒ¨çŠ¶æ€</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// é¢˜ç›®ï¼šæŸå•†å®¶æœ‰ 50 ç§ç”·æ¬¾å†…è¡£å’Œ 50 ç§æ¬¾å¥³æ¬¾å†…è¡£, è¦å±•ç¤ºå®ƒä»¬ï¼</span>

<span class="token keyword">class</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">gender</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>gender <span class="token operator">=</span> gender
        <span class="token comment">// this.underwear = ''</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/* æ–¹æ³•ä¸€ */</span>
    <span class="token comment">// takePhoto() {</span>
    <span class="token comment">//     console.log(`${this.gender}ç©¿ç€${this.underwear}`)</span>
    <span class="token comment">// }</span>

   <span class="token comment">/* æ–¹æ³•äºŒ */</span>
    <span class="token function">takePhoto</span><span class="token punctuation">(</span><span class="token parameter">i</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>gender<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">ç©¿ç€</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">æ¬¾è¡£æœ</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>


<span class="token punctuation">}</span>

<span class="token keyword">const</span> maleModel <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Model</span><span class="token punctuation">(</span><span class="token string">'male'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> femaleModel <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Model</span><span class="token punctuation">(</span><span class="token string">'female'</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">51</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// maleModel.underwear = `ç¬¬${i}æ¬¾è¡£æœ`</span>
    <span class="token comment">// maleModel.takePhoto()</span>

    maleModel<span class="token punctuation">.</span><span class="token function">takePhoto</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">51</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// femaleModel.underwear = `ç¬¬${i}æ¬¾è¡£æœ`</span>
    <span class="token comment">// femaleModel.takePhoto()</span>

    maleModel<span class="token punctuation">.</span><span class="token function">takePhoto</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <!---->  </div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/excellent-docs/14-HTTPæ¨¡å—.html" class="prev">14 HTTPæ¨¡å—</a></span> <span class="next"><a href="/excellent-docs/16-æ¡†æ¶é€šè¯†.html">16 æ¡†æ¶é€šè¯†</a>
      â†’
    </span></p></div>  <div class="el-dialog__wrapper" style="display:none;"><div role="dialog" aria-modal="true" aria-label="è¯·å…ˆé˜…è¯»è´­ä¹°åè®®" class="el-dialog el-dialog--center" style="margin-top:15vh;width:30%;"><div class="el-dialog__header"><span class="el-dialog__title">è¯·å…ˆé˜…è¯»è´­ä¹°åè®®</span><button type="button" aria-label="Close" class="el-dialog__headerbtn"><i class="el-dialog__close el-icon el-icon-close"></i></button></div><!----><div class="el-dialog__footer"><span class="dialog-footer"><button disabled="disabled" type="button" class="el-button el-button--danger is-disabled" style="width:100%;"><!----><!----><span>æˆ‘å·²é˜…è¯»ï¼ˆ8sï¼‰</span></button></span></div></div></div> <div class="el-dialog__wrapper" style="display:none;"><div role="dialog" aria-modal="true" aria-label="ä»˜è´¹é˜…è¯»" class="el-dialog" style="margin-top:15vh;width:30%;"><div class="el-dialog__header"><span class="el-dialog__title">ä»˜è´¹é˜…è¯»</span><button type="button" aria-label="Close" class="el-dialog__headerbtn"><i class="el-dialog__close el-icon el-icon-close"></i></button></div><!----><div class="el-dialog__footer"><span class="dialog-footer"><button disabled="disabled" type="button" class="el-button el-button--danger is-disabled" style="width:100%;"><!----><!----><span>ç¡® å®š</span></button></span></div></div></div> <div class="el-dialog__wrapper" style="display:none;"><div role="dialog" aria-modal="true" aria-label="dialog" class="el-dialog" style="margin-top:15vh;width:30%;"><div class="el-dialog__header"><span class="el-dialog__title"></span><button type="button" aria-label="Close" class="el-dialog__headerbtn"><i class="el-dialog__close el-icon el-icon-close"></i></button></div><!----><!----></div></div> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAU9ElEQVR4Xu1da5Ac1XX+TnfPa1crrQQiMY9YGGHAD6SdEWUjIdjVPiQgNhJa4VRBAgSIXZRRodgJOPED7DiACxts4yoHu0BKVaiYnVkJAkKPfQkBDgnSSmUIhKeEISSW0AO0O6/ue1K3R/uY2Xl0z3TPY3fuH6l2zj3n3HO+vn373nPPIdSbZQtEfnb4BmbxPRAtADAkDN5wzYbT9llmUIWEVIU6VaVKmx84usBQ9XcylBvqXj+/rSoVtqhUHQAWDdXz80OtxBjMJO9eP7+mbVjTylv0nSNkOQBwsHv9fPk6qNlW9QDg4e6rIHCEQuHdlbZyz08PbSHCVWN6EOjGtetP3VhpvUqRX5UA4Dcu9+GjxhsAbADhPAhxOi3p/aCUgTrVV84EkpemawfWbJh7wCm+leJTVQDgV9ecgqiyHky3gnCqaRTGHgqFl1TKQNNdblUAgPevOw8GfxOM60DwZxj9uxQM/2C6O6JS46soAHh4dTOE+iMQbgYouy4aXUgX9vyuUgaa7nIrBgDe030jAOn81FSftfEBCkbOnu5OqOT4yg4A3rvuM4D4FUBLCw6c8SCFwhsK0tUJirZAWQHAe6++F1DusK6tuIyCvc9ap69T2rVAWQBgru5Hlc0gWm5DQYGWsIcIwkafOqlNC7gOAN67ZhGgPAXQmbZ0Y36ZQpHP2+pTJ7ZtAVcBwHuv/nOA5PveZ1sz8GMUjFxrv1+9hx0LuAIA5lYNe0/9KQi32lEmg/ZOCobvK6F/vasFCzgOgJTz524Dqe0W5OcmIb6SWiJbS+JR71zQAo4CgN9p9esfND6v+QPBgpILEajiLFrU+14hsvrvpVnAMQDIA5zE+/yKd3bjOUCpbPkYBSNzSxtavbcVC5TqKVOGfPLjB72ve2fNOosUxYrcQjT7KBhuKURU/710C5QMAH7h4kAsNusdb2PgjxSPt3SNUhy2UTB8uVPM6nzyLLVKMQ4z1Nhg50HV6znD09BQCquMvryJghEZD1BvLlugpBkgvqvrtyz4i745cxxWU9xHwd47HWZaZ5fFAkUDIL571T1GPHlnoHkO4Mx7f0I9xt9TKPyPdY+5b4GiABAb6vqSSOhPepsaofqK2OQrPK5vUjD848JkxVPw3rUylu8qgJrBvBGKsYFathwrnmNt9rQNgNHdy/4Ecf9biqJqvubZbo16PQXDP3eLOe/pvh2EB9L4MzZQKPygWzKrla9tAEQHOt5nQ5zumzMbiqa5My7G1ygU/id3mAOpp5+uz+D/BAXDq92SWS18j3bf3AoiRjJ5cO6WjQdsASC2q+uXIqF/VfV64G1qcnNM7s4Ae7uHAFyWMYBdFAybEb/TtX247qZ9AC0aGx8LXmMZAMnnu1YkR/R+2dk/bw5IUd2zE+FvqCV8v1sCeAYCQD75gqbcbNpnGQCxgc4TwjAaNb8PnsZGt3yT4sv8bQpFfuiWkJkIgMNrb1pNCm3OsOlxSwCID3U+YiQNGcSJwLxmgBzZ7s3jX/EDCvZ+tw4A5yxwdN0tiwV4eDJHZjxREAD87PJPROOe9wFQWZ7+1BTwEAUjtzk3/HROM3EGkBY4vO4vbyCmu0D0Sel8leiuggCIDXXuFknjEvPd3zwHpLr47p/wUy8Fw2udAEBiR+tiHSTjEccvcfpmN0HxeNLYi2QS8Y8+nvgb8wENvMbbNeTY/f/L73vrdgJ/D0AzM4ZIUTds/duzHeNfjL3yAiCxe+UiPZY0FZSffPLTryyN+UUKRb7ohKzRnW1bABq/0Cl5WgJAai1yoKFr0JF7CavueWeBohhp+QUkCJ65c2FF8wvkBUBssOtVoevnS1t4Gxuh+l3Z9cvm5/cpGLYXRJoDLaM7V3DmT5YBAKChc6DgLGkFqKvueaNVUWhKfoGtdyx0hL8VHbLR5BSe3L2yIxlN7hyL7QicIuMzyqirFp1HFz59tNiBjfUb2dG2j2ji29fODMDA8cbOgeZSdZD9cwDg4NY7FlY0v0BOj8YGut4Uhn6OVF7u93tnufzpl2llRaygxb1Tnhi7zhjpa11NrKR9/lidAYhxY6BrwLH7/1fc++YWTMovAIEbt35roWP87dpG0mcFQHxXxwVGwvivsZ+zGawYYbb6OLg3Hx1sXQAdE4vAufMeJEUZ3xEzX/dC7I8fPXL7uI4aDgTahhy//y9ngpQM7cC2b53tOH9bNs4FgNhg14DQdXNxIkO8/HMdmQXt6ca8kUIRc+/B6TZTPwMtrQF4sNUf1dURgM3dHk9jAJo/4LQPCvNjHqZQpPTo4iyS6gCYMMqUV0Di2ZU/1uPJvx4j8c91ed8/NxQSaAkH3LgbWAdAHgDEBjqOCkOk5nwiBOZVMDpbNT5Piza/XHi6sEdRB0AOACSfv7wrORrfPvZzGY5983uO+TYKRR6y597C1Ly3e0sqGiitTfvj4IJrgNhg13NC15eNEXoaAtACFXj/j2vKfRSMdBZ2qT0K3tN9FwhyS3ZymxEBIZmWSlsDRPvbR1nwuMd9c5qgaOl75vZMXSI1wwDTKbSk53iJnNK683B3KzKzfhLaqCUsA0VmVBsHQLyv/UKDef/E6BmBU06pvDFIXEstvY85rQgPr14AoaXuHij6RmrZUvFvcqfHaIXfBAAGOh8xjNSZv2kTTYXz8f5WVMqgYX6cQpGvFNGz3sWCBcYBEB3oeI8NccZYn/Kd/RfQknkUPmUufa4nYWE8dRKbFjABwC+FGqJH5oxM3hg2Y/69ZTv9y682G5dTaPM2m2Ork1uwgAmAxLMrb9HjyYcn05cx+MOCmvwIBSM3WSCsk9i0gAmA+K6VTxiJ5Jcn9y378W8hxUV8Pi35t8OFyOq/27OACYDYYMebQhfm0a/ZSAZ/zrPHyW1qxt0UCt/ltpiZxt8EQOb3P2kq/I7f+C3ZtEfQNHI6nftMvGROdQYTz7pM8BAdCYxOtoni1eBrKlP8nx1nsPgqhXrT1ip2utc6rRngSsr1AC8G85aAB5uobaikC60U7busjVkdmGwc1eeFd9as6rMX89sIRhYSYUqcX/Up66xGPNjaPKrTOyRvM59szLypsWuwpEQaFBvsvF/oxjcmq6v5vfA0ViEApJKML1Eo/JSz5q1+btGdra0MJS1EjsHHGjsHSzqupdhQ13aR1LvSABDww9mUL44aeEae2mUDgLRqqVHLcgYYFrqxuIYAIOP1V1EoMn5s7Si8qpSZawCIDnS+zYaRdvnB0+CHFnAy6ZPTVuX3MF/5NJ3VE3Was1V+rcObmwPMZmBplGj/UMuakhZjheS6CICO/2NDnDZZgeoHgLkY+AkFI2lrl0JGdOr3VcObFzDEMAHmgoyBYwSlZVvLGtdOFN0DQH/7xyw4bcWnVfcaIOVHGSugGYvdCBkrBJRVwxG5IZUZUHL3tpa1rm1UuQaA0Z0rkjJIvWa+AiYrytiDIH2BqMco5DQnf181HJ6SYobBT2xv6XYsxYwZrwDtejDMewRscDMLPW2tJv+ueDwTQSzMx6BgE7VEZMibpUajO1Zw5vUQ1euFt6lKPwMzh+XgBRJLFgOwcjhyOyE9yRQDG7a3rHUkyZRZTY214q/FkX621QAXynZ5suLBoFY9kXoXxKEpF5W7tNzK4fCDxGQ+8Uy8ZXtL98StIlv6TyXm4atvACuPFs3GxrkJje5s48wbYopHg292FW4F57II410wXeh07GDRDiixIw+vXQ2eks7FOlcbs6KcAeT7My3nS9WEg1kfslwU7qBQeKWdLtVMy3u6j4FQXA5eO6+AaF97gpnTQ38VQmBuSTuMFbItf5+CkczVeYV0KU1sqqqqGbRqfmoKXV8gksnM3IYybP/ulCSWyZuOQaEt1NJjOesIRfvaTzDzlLvf5o2gHNVcSxuam72ZAe6iYG+fm1Iqwdu9z8D+9sMQPCX+2zd7FhzM/18+mzGOg/UQLdnyVvmEui/JNQBE+9rfZeazMofgaWyA5s8s5O3+QJ2RwAeg8vLpVHPINQDEBjr2CENMuYat+XzwlDsriDPeP8lleoHATQBEhCGuzrR9zX0KZgXP9AGBawCIDnX+kJPG3021HyEVGVzrbXqAQKa5YV1JSzMH5l0NXYMlJbim+K6Oa4yE+E02N9fsQnDKYKYHCDJzHjKJNY0dQ5b3/bP5mLIi6ySlvBour4hPi8b8FthYWetfB9JfwsDiBhVDpQaESr+aYeHZTgTl32tyRzAfWhkfAbh2JsYU5jLLyXsBHa+zEOdOJeLUBZGa2xDKiwJ59nEvWsLfdiP/UK3NlqmrYf2djxrCyBpeLBNEulQYqrK2YgygwbiGLtj8YWUVqaz01NWwXW1XiAQ9nU2Vqr0j4Ijd+D2wsppCPXscYVeDTFLXw+XtoBOB0ax5QyudKcxtozKSINyPuYe/T2cPxdwWV238xxNEjPa3H4LgU7MpOG1fA5MHy/x7ALfMtHDzcQDEBjufErpxZTYATLuvgfxfCptBia9T8Mn/qban1Q19xgGQ3N3RmoyJnNm5qythhBumSOMps6XchcX0QLkDTl0fWYaA9DRxfR0nmEXWvPC1fzhUjGn5VRDuo5bIpmJ610KfNADEdnVtEQk9M4NmahwyaYSMEppWewKWXSRfBz+DoF9Ol7jDsZGnASAxdNlFelL9j1xm8QQC0KbL1rBl36cRngD4kdStpN6DxbGorl5TsoVH+zqOM4scIcEyefScMtQNrC4jZdWGeTcIYajiX2nR5j9Uu8b8yrp5iOmLKbQ5LRfEFADEBzo2GYb4i1wDmplrgbzuFQA/B0YPNPF4NYGB9375dMAry+9dDcZyKPgatYR/PXk0UwDA25eeFlX8/5uvQpSsICIridRbNgvwswAiUNBPiyOvlNNGvH/NadDVS0AsE34vB+iicfmMwxQKz8/UJ2vNoOhg57+zbnwhl/LTe3vYUZfJyiv7wPSfIAxDNfY6cZmVX143C0kshOBPQcGnwCxD+pYC9Mmc2ueox5y9aFRf+2cMFq/kKxPnb54NUtPulDpquWnLjBEDZFJuOg5CDMwxEKIATfyfKQ7CLMAM128EqBEydJ9oLpjPAZG9LN5Spp/OoM/2HLE0A0iiWH/ny0IYn83liKrNJDZtkVPCwJh/QaHI17NxyFk3MLq7o5Xz7AxKZhWvJ1CCTWZQVwGVFtKinvR4wpMGyFsKNNrf8QYLsTCXsVIl5eT1tTJWFJ1BnnNmqByhYKQ7pw/zCUnsbgvpUXopn3/rC0Jn3OQKF2YdmvI5WtTz30UBQHaKDna9wLp+cT4Fqyq1vCuWrFmm/0DB8HfyaV9w7rayLyAF1PcGqgwkzG9TKDKRADyHegUBYH4RDLb/Suh8c14kqSrkp2F9PVAlQLBYBMsSAE6Wk/0Q4LzJA6umzEyV+KByavBjFIxca0W+JQBIRqN9rd1gpacQU+/sWVA93kJk9d9dswAfQ0AstBrtbBkA5qugf0VECEy5SJo2FoKZX0jR6ruErvk4L2O+iYKRR6zKtgWA1KtAeRfAlEOFTBDIghOkqlb1qNM5YQHm31Ao8md2WNkCgGQc39VxgZEw5DlB/r5E8M+R5wV1ENhxSNG0zMOYPXqx3YoqtgFgrgcGO+6ELu4pqGwdBAVN5BDBIQixiJb0fmCXX1EAkEKi/Sv6WKC9oEATBE31k8OChiqSQOZMVmkpLe7JGcqX9/O9SLFmscnYseZhZv50YR4Ef3MdBIXtVAQF820UijxURE+zS9EzgOws69hEhfI7CJxZUIH666CgiWwTFLHoy5RREgBMEMgQMq3hNQhROJ8MEXxNjbWZfs62d9ztYCQTL6pJdNIlT35ciqSSAWAuCrdfehapnteY8+8UjimaCiyVm4qOiC9l/LXXl4FkLPqah/RltHT7lAgfuwNyzAOxXZeey7pnDwtusqKE/Dz0zW6qB5daMdZJGhYCydGRd71GPERtQ46U0XUMABOvg8B+CP5jq+OSdQlkfYJ6y28BI5FEcnT0iF/TzqdLnznklL0cBYAJgueWNcXi/t+y4JzxhJnKyzL13qb6KyGrU1kgcWIUwjA+9FPyfKee/DFZjgNgjHG0r2OQWVjOYSfDy+S6oH6QNAEDoSeR+HgEikd73XfptvOceuon83ENAMyg6ED74xCcMx4t24DkIZJMSDGzt5AZyZFR6NE4tAbfv3gveeY6N5wveboGgDGFYwPt64WOn4DY1qGAGWvY0ADMsBtIRjyO5GgUzGxoAc/N3mXbNrrl/LIAQAqJ7bj0XKF4BsF8ht3BmCXsAoGCZ092+VYbvZFMIDkSBRsGSFMPKz5a7lu64zW39XR9BhgbAL8U8sQ+mvsoG8a1ticeuT5oCEDuH0y3ZiTkEx8zHS+b6vf2+pZvkxc6y9LKBoCx0cQH2q4SQn2MWdivTaso0Lxes44BqTV8OZUF9HjCnOohi5yksrIeU31qt2fptv6yeP6kkLIDQMqVgSUJ8vyzkTTWFTtYuUiUMYiaz1sz+QrkRo4+GoUej08aNrPi8f7a37r9r4q1RSn9KgKAMYUTz3cuFnH0CMPIefuo8ODYPFuQYDA/ISs6oqnayk85I6FDJBMQ+uQCpwzyaC/5VV5Ly/tklFVFWlWYKz60ap1hJB6GSFXIKqXJz0jF44HqUaFonjIvHhkiqZuOFskkjKSeKi2d0RSP9nvVo13nWbZV5hKoaKsKAIxZIDbQtV6w8Z1cCSuLsZR8VaiaCsXrMQNVSbH1NZpHJMvdObB0tq6bzh5byOXqRKp2SPVpd3iXbS2+KmgxRsjTp6oAMKZnfLDrK8x0nzCSuRMelGQIAilkzg4kQxvH/5X/VfLMGpxyuHS8EJY1UDR1P0Hc5WvrL6m4g2WBNgirEgDja4QXr1giRo17ha4vB7imToyIKK54tIiXlNudPLyx4VtLpFUNgMkjiO1u/1MY2jfkRVVmrsoNAVLUjxRVeUFV+Rfa8h1PWfJAhYlqBgBjdpJnDImhrquY+FaRFMsKXVdz2b5Mmvo+KbQVuv4jf/tAzRWrrDkAZDpUbjMzeS+GSlcCfBELcSYY6bWQHUIBESVIUQ4pqvqaIPG0L4qHaeWOEYfYV4RNzQMgm9VknGJc84dIURaBcYEgkpm0PsECTTI2Fcw+BlQwT76/ppNCMXmISQqNEHACjD8A/CYxDXlZ7KCO/mlXXeT/AQOtWhTnoNDfAAAAAElFTkSuQmCC" class="theme-float-btn"></main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.f60bfc341.js" defer></script><script src="/assets/js/6.7f8a8777.js" defer></script><script src="/assets/js/3.9d86cf58.js" defer></script><script src="/assets/js/73.d56ee920.js" defer></script><script src="/assets/js/11.fb060006.js" defer></script>
  </body>
</html>
