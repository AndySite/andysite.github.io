<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1 åˆè¯† npm script | é¢è¯•æŒ‡å—</title>
    <meta name="description" content="å‰ç«¯é¢è¯•æŒ‡å—ï¼Œå‰ç«¯é¢è¯•é¢˜æ•´ç†ï¼ŒæŒ‰æ¨¡å—åˆ†ç±»æ•´ç†æ€»ç»“ï¼Œæ‰“é€ æœ€å…¨é¢çš„å‰ç«¯é¢è¯•é¢˜">
    <link rel="icon" href="/logo.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
  <meta name="apple-mobile-web-app-status-bar-style">

    <link rel="preload" href="/assets/css/0.styles.9ad7bc48.css" as="style"><link rel="preload" href="/assets/js/app.f60bfc34.js" as="script"><link rel="preload" href="/assets/js/6.7f8a8777.js" as="script"><link rel="preload" href="/assets/js/3.9d86cf58.js" as="script"><link rel="preload" href="/assets/js/17.59c81a6b.js" as="script"><link rel="preload" href="/assets/js/11.fb060006.js" as="script"><link rel="prefetch" href="/assets/js/1.9e1b498f.js"><link rel="prefetch" href="/assets/js/10.fbc04ea9.js"><link rel="prefetch" href="/assets/js/100.c06a0f53.js"><link rel="prefetch" href="/assets/js/101.54402ede.js"><link rel="prefetch" href="/assets/js/102.d3860a7d.js"><link rel="prefetch" href="/assets/js/103.51a83ab2.js"><link rel="prefetch" href="/assets/js/104.4107118f.js"><link rel="prefetch" href="/assets/js/105.aada2418.js"><link rel="prefetch" href="/assets/js/106.4ce7d3b7.js"><link rel="prefetch" href="/assets/js/107.ca87a327.js"><link rel="prefetch" href="/assets/js/108.df939701.js"><link rel="prefetch" href="/assets/js/109.9f0c8605.js"><link rel="prefetch" href="/assets/js/110.016c3eb7.js"><link rel="prefetch" href="/assets/js/111.ff5dbcc4.js"><link rel="prefetch" href="/assets/js/112.ab20caec.js"><link rel="prefetch" href="/assets/js/113.6c12e76f.js"><link rel="prefetch" href="/assets/js/114.48e1a019.js"><link rel="prefetch" href="/assets/js/115.f291caf1.js"><link rel="prefetch" href="/assets/js/116.0188d28e.js"><link rel="prefetch" href="/assets/js/117.9b579bae.js"><link rel="prefetch" href="/assets/js/118.89da516f.js"><link rel="prefetch" href="/assets/js/119.c70b5105.js"><link rel="prefetch" href="/assets/js/12.9774db85.js"><link rel="prefetch" href="/assets/js/120.fcf3186f.js"><link rel="prefetch" href="/assets/js/13.ac14541c.js"><link rel="prefetch" href="/assets/js/14.155007f0.js"><link rel="prefetch" href="/assets/js/15.2d9ec2b2.js"><link rel="prefetch" href="/assets/js/16.aec442e8.js"><link rel="prefetch" href="/assets/js/18.c38ff446.js"><link rel="prefetch" href="/assets/js/19.8203bd99.js"><link rel="prefetch" href="/assets/js/20.103004c4.js"><link rel="prefetch" href="/assets/js/21.1e6e08c9.js"><link rel="prefetch" href="/assets/js/22.5abbfd40.js"><link rel="prefetch" href="/assets/js/23.4cd5fd4d.js"><link rel="prefetch" href="/assets/js/24.602403ee.js"><link rel="prefetch" href="/assets/js/25.da971f83.js"><link rel="prefetch" href="/assets/js/26.43589785.js"><link rel="prefetch" href="/assets/js/27.6d18f825.js"><link rel="prefetch" href="/assets/js/28.843b905f.js"><link rel="prefetch" href="/assets/js/29.81e33cc0.js"><link rel="prefetch" href="/assets/js/30.7a4491ed.js"><link rel="prefetch" href="/assets/js/31.4275e9d2.js"><link rel="prefetch" href="/assets/js/32.6e6c282b.js"><link rel="prefetch" href="/assets/js/33.35641348.js"><link rel="prefetch" href="/assets/js/34.7737e542.js"><link rel="prefetch" href="/assets/js/35.3d539e4d.js"><link rel="prefetch" href="/assets/js/36.78f70288.js"><link rel="prefetch" href="/assets/js/37.ed0997e2.js"><link rel="prefetch" href="/assets/js/38.6d35141d.js"><link rel="prefetch" href="/assets/js/39.3b4241bb.js"><link rel="prefetch" href="/assets/js/4.cda2fc13.js"><link rel="prefetch" href="/assets/js/40.dd7b6d84.js"><link rel="prefetch" href="/assets/js/41.05fcd6ed.js"><link rel="prefetch" href="/assets/js/42.24fc3ac4.js"><link rel="prefetch" href="/assets/js/43.27b59a40.js"><link rel="prefetch" href="/assets/js/44.ac552dd9.js"><link rel="prefetch" href="/assets/js/45.6b1e07c4.js"><link rel="prefetch" href="/assets/js/46.8bf4b340.js"><link rel="prefetch" href="/assets/js/47.57a13e6c.js"><link rel="prefetch" href="/assets/js/48.8ef881a7.js"><link rel="prefetch" href="/assets/js/49.b76df872.js"><link rel="prefetch" href="/assets/js/5.eb1f29dc.js"><link rel="prefetch" href="/assets/js/50.f04492e5.js"><link rel="prefetch" href="/assets/js/51.e000ebea.js"><link rel="prefetch" href="/assets/js/52.bfbd5e6e.js"><link rel="prefetch" href="/assets/js/53.fc0a60dd.js"><link rel="prefetch" href="/assets/js/54.a798cd42.js"><link rel="prefetch" href="/assets/js/55.5ccb6ae1.js"><link rel="prefetch" href="/assets/js/56.1605b000.js"><link rel="prefetch" href="/assets/js/57.79350f4e.js"><link rel="prefetch" href="/assets/js/58.dcff3859.js"><link rel="prefetch" href="/assets/js/59.a366020b.js"><link rel="prefetch" href="/assets/js/60.2c42a67f.js"><link rel="prefetch" href="/assets/js/61.4d471001.js"><link rel="prefetch" href="/assets/js/62.07f7a685.js"><link rel="prefetch" href="/assets/js/63.3774b497.js"><link rel="prefetch" href="/assets/js/64.d8437f45.js"><link rel="prefetch" href="/assets/js/65.eaf10ccb.js"><link rel="prefetch" href="/assets/js/66.74665605.js"><link rel="prefetch" href="/assets/js/67.072c35ca.js"><link rel="prefetch" href="/assets/js/68.764ab8cb.js"><link rel="prefetch" href="/assets/js/69.6a27592a.js"><link rel="prefetch" href="/assets/js/7.9a5c64fa.js"><link rel="prefetch" href="/assets/js/70.2e7f3527.js"><link rel="prefetch" href="/assets/js/71.c6365fbe.js"><link rel="prefetch" href="/assets/js/72.15cfe1be.js"><link rel="prefetch" href="/assets/js/73.d56ee920.js"><link rel="prefetch" href="/assets/js/74.f848ccac.js"><link rel="prefetch" href="/assets/js/75.905f5556.js"><link rel="prefetch" href="/assets/js/76.49d98a04.js"><link rel="prefetch" href="/assets/js/77.4b62003f.js"><link rel="prefetch" href="/assets/js/78.5a4046ff.js"><link rel="prefetch" href="/assets/js/79.eb3ec067.js"><link rel="prefetch" href="/assets/js/8.bccf8145.js"><link rel="prefetch" href="/assets/js/80.c8247597.js"><link rel="prefetch" href="/assets/js/81.69952221.js"><link rel="prefetch" href="/assets/js/82.4439fbe3.js"><link rel="prefetch" href="/assets/js/83.df1321d3.js"><link rel="prefetch" href="/assets/js/84.23d01b47.js"><link rel="prefetch" href="/assets/js/85.c983047a.js"><link rel="prefetch" href="/assets/js/86.29b0f2d4.js"><link rel="prefetch" href="/assets/js/87.12e2e192.js"><link rel="prefetch" href="/assets/js/88.fb19aa58.js"><link rel="prefetch" href="/assets/js/89.ee2be7d8.js"><link rel="prefetch" href="/assets/js/9.ce1180ae.js"><link rel="prefetch" href="/assets/js/90.479f4d9d.js"><link rel="prefetch" href="/assets/js/91.619e0c8d.js"><link rel="prefetch" href="/assets/js/92.ae858703.js"><link rel="prefetch" href="/assets/js/93.f90a7ae1.js"><link rel="prefetch" href="/assets/js/94.8894adb4.js"><link rel="prefetch" href="/assets/js/95.683396f3.js"><link rel="prefetch" href="/assets/js/96.f65dc164.js"><link rel="prefetch" href="/assets/js/97.75bd77e0.js"><link rel="prefetch" href="/assets/js/98.892b530a.js"><link rel="prefetch" href="/assets/js/99.7d033614.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9ad7bc48.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="é¢è¯•æŒ‡å—" class="logo">  </a> <div class="links" style="background: rgb(255, 255, 255); max-width: 1297px;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value="" class="" placeholder=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div><a href="/docs/base.html" class="nav-link">åŸºç¡€
      </a></div></div><div class="nav-item"><div><a href="/docs/simply.html" class="nav-link">âœ¨è¿›é˜¶
      </a></div></div><div class="nav-item"><div><a href="/excellent-docs/1-HTMLæ¨¡å—.html" class="nav-link">ğŸ‘ç²¾é€‰
      </a></div></div><div class="nav-item"><div><a href="/docs/excellent.html" class="nav-link">ğŸ”¥é«˜é¢‘
      </a></div></div><div class="nav-item"><div><a href="/docs/guide.html" class="nav-link">æŒ‡å—
      </a></div></div><div class="nav-item"><div><a href="/docs/performance.html" class="nav-link">æ€§èƒ½
      </a></div></div><div class="nav-item"><div><a href="/docs/detail-expain.html" class="nav-link">ç»¼åˆ
      </a></div></div><div class="nav-item"><div><a href="/principle-docs/comprehensive/01-è™šæ‹ŸDOMåŸç†åˆ†æ.html" class="nav-link">åŸç†
      </a></div></div><div class="nav-item"><div><a href="/docs/handwritten.html" class="nav-link">æ‰‹å†™
      </a></div></div><div class="nav-item"><div><a href="/qa/1-å‰ç«¯100é¢˜è‡ªæ£€.html" class="nav-link">è‡ªæ£€
      </a></div></div><div class="nav-item"><div><a href="/interview-exp/å‰ç«¯é¢ç»æ±‡æ€».html" class="nav-link">â­é¢ç»
      </a></div></div><div class="nav-item"><div><a href="/days/æ¯æ—¥ä¸€é¢˜.html" class="nav-link">ğŸ’¥æ¯æ—¥ä¸€é¢˜
      </a></div></div><div class="nav-item"><div><a href="/docs/design-pattern.html" class="nav-link">è®¾è®¡æ¨¡å¼
      </a></div></div><div class="nav-item"><div><a href="/algorithm-interview/note/01-å¿«é€Ÿä¸Šæ‰‹â€”â€”ä»0åˆ°1æŒæ¡ç®—æ³•é¢è¯•éœ€è¦çš„æ•°æ®ç»“æ„ï¼ˆä¸€ï¼‰.html" class="nav-link">
      </a></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ‹“å±•é˜…è¯»" class="dropdown-title"><span class="title">æ‹“å±•é˜…è¯»</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display: none;"><li class="dropdown-subitem"><div><a href="https://blog.poetries.top/browser-working-principle/guide/part1/lesson01.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
        æµè§ˆå™¨åŸç†
        HTTPåŸºç¡€
      </div></a></div></li><li class="dropdown-subitem"><div><a href="/docs/webpack.html" class="nav-link">webpack
      </a></div></li><li class="dropdown-subitem"><div><a href="/docs/npm-script.html" class="nav-link">npmå·¥ä½œæµ
      </a></div></li><li class="dropdown-subitem"><div><a href="/docs/canvas.html" class="nav-link">Canvas
      </a></div></li><li class="dropdown-subitem"><div><a href="/docs/Taro.html" class="nav-link">TaroåŸç†
      </a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-nodejs-docs/nodejs-docs/base/01-ç¯å¢ƒæ­å»º.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
        Nodeå­¦ä¹ æŒ‡å—
      </div></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-vue-docs/vue-analysis/prepare/" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
        Vueæºç åˆ†æ
      </div></a></div></li></ul></li><li class="dropdown-item"><h4>å…¶ä»–</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-blog-docs/blog-docs/javascript/-Ajaxæ€»ç»“ç¯‡.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
        æ—¥å¸¸ç§¯ç´¯
      </div></a></div></li><li class="dropdown-subitem"><div><a href="http://blog.poetries.top/archives/" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
        åšæ–‡
      </div></a></div></li></ul></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->   <ul class="sidebar-links"><li><a href="/docs/base.html" class="sidebar-link">åŸºç¡€</a></li><li><a href="/docs/simply.html" class="sidebar-link">è¿›é˜¶</a></li><li><a href="/docs/excellent.html" class="sidebar-link">é«˜é¢‘</a></li><li><a href="/docs/guide.html" class="sidebar-link">æŒ‡å—</a></li><li><a href="/docs/performance.html" class="sidebar-link">æ€§èƒ½</a></li><li><a href="/docs/qa.html" class="sidebar-link">è‡ªæ£€</a></li><li><a href="/docs/detail-expain.html" class="sidebar-link">ç»¼åˆ</a></li><li><a href="/docs/handwritten.html" class="sidebar-link">æ‰‹å†™</a></li><li><a href="/docs/design-pattern.html" class="sidebar-link">è®¾è®¡æ¨¡å¼</a></li></ul> </aside> <main class="page"> <div id="container" class="theme-default-content"><div class="content__default"><h2 id="_1-åˆè¯†-npm-script"><a href="#_1-åˆè¯†-npm-script" class="header-anchor">#</a> 1 åˆè¯† npm script</h2> <blockquote><p>é¦–å…ˆä»‹ç»åˆ›å»º <code>package.json</code> æ–‡ä»¶çš„ç§‘å­¦æ–¹æ³•ï¼Œç›®æ ‡æ˜¯æŒæ¡ <code>npm init</code> å‘½ä»¤ã€‚ç„¶åï¼Œé€šè¿‡åœ¨ç»ˆç«¯ä¸­è¿è¡Œè‡ªåŠ¨ç”Ÿæˆçš„ <code>test</code> å‘½ä»¤ï¼Œè¯¦ç»†è®²è§£ <code>npm</code> è„šæœ¬åŸºæœ¬æ‰§è¡Œæµç¨‹ã€‚ ç„¶åï¼ŒåŠ¨æ‰‹ç»™é¡¹ç›®å¢åŠ  <code>eslint</code> å‘½ä»¤ï¼Œç†Ÿæ‚‰åˆ›å»ºè‡ªå®šä¹‰å‘½ä»¤çš„åŸºæœ¬æµç¨‹ã€‚</p></blockquote> <h3 id="ç”¨-npm-init-å¿«é€Ÿåˆ›å»ºé¡¹ç›®"><a href="#ç”¨-npm-init-å¿«é€Ÿåˆ›å»ºé¡¹ç›®" class="header-anchor">#</a> ç”¨ npm init å¿«é€Ÿåˆ›å»ºé¡¹ç›®</h3> <blockquote><p>å¼€å§‹æ¢ç´¢ <code>npm script</code> ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆèŠèŠè¿™äº› <code>scripts</code> æ‰€ä¾èµ–çš„æ–‡ä»¶ <code>package.json</code>ï¼Œä»¥å®ƒä¸ºåŸºç¡€çš„ <code>npm</code> åˆ™æ˜¯ <code>node.js</code> ç¤¾åŒºè“¬å‹ƒå‘å±•çš„é¡¶æ¢æŸ±ã€‚</p></blockquote> <p><code>npm</code> ä¸ºæˆ‘ä»¬æä¾›äº†å¿«é€Ÿåˆ›å»º <code>package.json</code> æ–‡ä»¶çš„å‘½ä»¤ <code>npm init</code>ï¼Œæ‰§è¡Œè¯¥å‘½ä»¤ä¼šé—®å‡ ä¸ªåŸºæœ¬é—®é¢˜ï¼Œå¦‚åŒ…åç§°ã€ç‰ˆæœ¬å·ã€ä½œè€…ä¿¡æ¯ã€å…¥å£æ–‡ä»¶ã€ä»“åº“åœ°å€ã€è®¸å¯åè®®ç­‰ï¼Œå¤šæ•°é—®é¢˜å·²ç»æä¾›äº†é»˜è®¤å€¼ï¼Œä½ å¯ä»¥åœ¨é—®é¢˜åæ•²å›è½¦æ¥å—é»˜è®¤å€¼ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>package name: (hello-npm-script)
version: (0.1.0)
description: hello npm script
entry point: (index.js)
test command:
git repository:
keywords: npm, script
license: (MIT)
</code></pre></div><blockquote><p>ä¸Šé¢çš„ä¾‹å­æŒ‡å®šäº†æè¿°ï¼ˆdescriptionï¼‰å’Œå…³é”®å­—ï¼ˆkeywordsï¼‰ä¸¤ä¸ªå­—æ®µï¼ŒåŸºæœ¬é—®é¢˜é—®å®Œä¹‹å <code>npm</code> ä¼šæŠŠ <code>package.json</code> æ–‡ä»¶å†…å®¹æ‰“å‡ºæ¥ä¾›ä½ ç¡®è®¤ï¼š</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;name&quot;: &quot;hello-npm-script&quot;,
  &quot;version&quot;: &quot;0.1.0&quot;,
  &quot;description&quot;: &quot;hello npm script&quot;,
  &quot;main&quot;: &quot;index.js&quot;,
  &quot;scripts&quot;: {
    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;
  },
  &quot;keywords&quot;: [
    &quot;npm&quot;,
    &quot;script&quot;
  ],
  &quot;author&quot;: &quot;wangshijun &lt;wangshijun2010@gmail.com&gt; (https://github.com/wangshijun)&quot;,
  &quot;license&quot;: &quot;MIT&quot;
}

</code></pre></div><blockquote><p>æŒ‰å›è½¦ç¡®è®¤å°±èƒ½æŠŠ<code>package.json</code> çš„å†…å®¹å†™åˆ°æ–‡ä»¶ç³»ç»Ÿï¼Œå¦‚æœè¦ä¿®æ”¹ <code>package.json</code>ï¼Œå¯ä»¥ç›´æ¥ç”¨ç¼–è¾‘å™¨ç¼–è¾‘ï¼Œæˆ–è€…å†æ¬¡è¿è¡Œ <code>npm init</code>ï¼Œ<code>npm</code> é»˜è®¤ä¸ä¼šè¦†ç›–ä¿®æ”¹é‡Œé¢å·²ç»å­˜åœ¨çš„ä¿¡æ¯ã€‚</p></blockquote> <blockquote><p><strong>TIP#1</strong>: å«Œä¸Šé¢çš„åˆå§‹åŒ–æ–¹å¼å¤ªå•°å—¦ï¼Ÿä½ å¯ä»¥ä½¿ç”¨ <code>npm init -f</code>ï¼ˆæ„æŒ‡ <code>--force</code>ï¼Œæˆ–è€…ä½¿ç”¨ <code>--yes</code>ï¼‰å‘Šè¯‰ <code>npm</code> ç›´æ¥è·³è¿‡å‚æ•°é—®ç­”ç¯èŠ‚ï¼Œå¿«é€Ÿç”Ÿæˆ <code>package.json</code>ã€‚</p></blockquote> <p>åˆå§‹åŒ– <code>package.json</code> æ—¶çš„å­—æ®µé»˜è®¤å€¼æ˜¯å¯ä»¥è‡ªå·±é…ç½®çš„ï¼Œç»†å¿ƒçš„åŒå­¦å¯èƒ½å·²ç»å‘ç°ï¼Œæˆ‘ä¸Šé¢çš„é»˜è®¤ç‰ˆæœ¬å·æ˜¯ 0.1.0ï¼Œè€Œ npm é»˜è®¤çš„ç‰ˆæœ¬å·æ˜¯ 0.0.1ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤å»ä¿®æ”¹é»˜è®¤é…ç½®ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>npm config set init.author.email &quot;wangshijun2010@gmail.com&quot;
npm config set init.author.name &quot;wangshijun&quot;
npm config set init.author.url &quot;http://github.com/wangshijun&quot;
npm config set init.license &quot;MIT&quot;
npm config set init.version &quot;0.1.0&quot;
</code></pre></div><blockquote><p><strong>TIP#2</strong>: å°†é»˜è®¤é…ç½®å’Œ -f å‚æ•°ç»“åˆä½¿ç”¨ï¼Œèƒ½è®©ä½ ç”¨æœ€çŸ­çš„æ—¶é—´åˆ›å»º package.jsonï¼Œå¿«å»è‡ªå·±è¯•è¯•å§ã€‚</p></blockquote> <p>ä¸¥è‚ƒçš„å·¥ç¨‹å¸ˆéƒ½ä¼šä½¿ç”¨ Git å¯¹æºä»£ç è¿›è¡Œç‰ˆæœ¬ç®¡ç†ï¼Œåœ¨ <code>npm init</code> çš„åŸºç¡€ä¸Šï¼Œä½ å¯ä»¥ä½¿ç”¨ git init æ¥åˆå§‹åŒ– git ä»“åº“ï¼Œä¸å†å±•å¼€ã€‚</p> <p>çº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…ï¼Œæƒ³æŒæ¡ <code>npm script</code>ï¼Œè¯·æ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œä¸‹åˆ—å‘½ä»¤ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>cd ~
mkdir hello-npm-script &amp;&amp; cd $_
npm init
npm init -f
</code></pre></div><p><strong>æ‰§è¡Œä¸Šé¢ç¬¬ 3ã€4 è¡Œå‘½ä»¤æ—¶ç»“æœæ˜¯å¦ç¬¦åˆé¢„æœŸï¼Ÿå¦‚æœä¸ç¬¦åˆé¢„æœŸï¼Œè¯·åœ¨ä¸‹é¢ç•™è¨€ï¼Œæˆ–è€…åœ¨è¯»è€…ç¾¤é‡Œåé¦ˆã€‚</strong></p> <h3 id="ç”¨-npm-run-æ‰§è¡Œä»»æ„å‘½ä»¤"><a href="#ç”¨-npm-run-æ‰§è¡Œä»»æ„å‘½ä»¤" class="header-anchor">#</a> ç”¨ npm run æ‰§è¡Œä»»æ„å‘½ä»¤</h3> <p>ä½¿ç”¨ <code>npm init</code> åˆ›å»ºçš„ <code>package.json</code> æ–‡ä»¶ä¸­åŒ…å«äº† <code>scripts</code> å­—æ®µï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>&quot;scripts&quot;: {
  &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;
},

</code></pre></div><ul><li>åœ¨ç»ˆç«¯ä¸­è¿è¡Œ <code>npm run test</code>ï¼Œèƒ½çœ‹åˆ° <code>Error: no test specified</code> çš„è¾“å‡ºã€‚<code>npm run test</code> å¯ä»¥ç®€å†™ä¸º <code>npm test</code>ï¼Œæˆ–æ›´ç®€å•çš„ <code>npm t</code>ï¼Œå¾—åˆ°çš„ç»“æœæ˜¯å‡ ä¹ç›¸åŒçš„ã€‚<code>npm test</code> é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯è¿è¡Œé¡¹ç›®æµ‹è¯•ï¼Œå®é™…ç”¨æ³•åœ¨å®æˆ˜ç¯èŠ‚ä¼šæœ‰ä»‹ç»ã€‚</li> <li>å’Œ <code>test</code> ç±»ä¼¼ï¼Œ<code>start</code> ä¹Ÿæ˜¯ <code>npm</code> å†…ç½®æ”¯æŒçš„å‘½ä»¤ï¼Œä½†æ˜¯éœ€è¦å…ˆåœ¨ <code>scripts</code> å­—æ®µä¸­å£°æ˜è¯¥è„šæœ¬çš„å®é™…å†…å®¹ï¼Œå¦‚æœæ²¡å£°æ˜å°±æ‰§è¡Œ <code>npm start</code>ï¼Œä¼šç›´æ¥æŠ¥é”™ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</li></ul> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/1.png" alt=""></p> <blockquote><p>é‚£ä¹ˆï¼Œ<code>npm</code> æ˜¯å¦‚ä½•ç®¡ç†å’Œæ‰§è¡Œå„ç§ <code>scripts</code> çš„å‘¢ï¼Ÿä½œä¸º <code>npm</code> å†…ç½®çš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ï¼Œ<code>npm run</code> å®é™…ä¸Šæ˜¯ <code>npm run-script</code> å‘½ä»¤çš„ç®€å†™ã€‚å½“æˆ‘ä»¬è¿è¡Œ <code>npm run xxx</code> æ—¶ï¼ŒåŸºæœ¬æ­¥éª¤å¦‚ä¸‹ï¼š</p></blockquote> <ol><li>ä» <code>package.json</code> æ–‡ä»¶ä¸­è¯»å– <code>scripts</code> å¯¹è±¡é‡Œé¢çš„å…¨éƒ¨é…ç½®ï¼›</li> <li>ä»¥ä¼ ç»™ <code>npm run</code> çš„ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºé”®ï¼Œæœ¬ä¾‹ä¸­ä¸º <code>xxx</code>ï¼Œåœ¨ <code>scripts</code> å¯¹è±¡é‡Œé¢è·å–å¯¹åº”çš„å€¼ä½œä¸ºæ¥ä¸‹æ¥è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œå¦‚æœæ²¡æ‰¾åˆ°ç›´æ¥æŠ¥é”™ï¼›</li> <li>åœ¨ç³»ç»Ÿé»˜è®¤çš„ <code>shell</code> ä¸­æ‰§è¡Œä¸Šè¿°å‘½ä»¤ï¼Œç³»ç»Ÿé»˜è®¤ <code>shell</code> é€šå¸¸æ˜¯ <code>bash</code>ï¼Œ<code>windows</code> ç¯å¢ƒä¸‹å¯èƒ½ç•¥æœ‰ä¸åŒï¼Œç¨åå†è®²ã€‚</li></ol> <p>æ³¨æ„ï¼Œä¸Šé¢è¿™æ˜¯ç®€åŒ–çš„æµç¨‹ï¼Œæ›´å¤æ‚çš„é’©å­æœºåˆ¶åé¢ç« èŠ‚å•ç‹¬ä»‹ç»ã€‚</p> <p>ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœ <code>package.json</code> æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;name&quot;: &quot;hello-npm-script&quot;,
  &quot;devDependencies&quot;: {
    &quot;eslint&quot;: &quot;latest&quot;
  },
  &quot;scripts&quot;: {
    &quot;eslint&quot;: &quot;eslint **.js&quot;
  }
}

</code></pre></div><p>å¦‚æœä¸å¸¦ä»»ä½•å‚æ•°æ‰§è¡Œ <code>npm run</code>ï¼Œå®ƒä¼šåˆ—å‡ºå¯æ‰§è¡Œçš„æ‰€æœ‰å‘½ä»¤ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ ·ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>Available scripts in the myproject package:
  eslint
    eslint **.js

</code></pre></div><p>å¦‚æœè¿è¡Œ <code>npm run eslint</code>ï¼Œ<code>npm</code> ä¼šåœ¨ <code>shell</code> ä¸­è¿è¡Œ <code>eslint \*\*.js</code>ã€‚</p> <blockquote><p>æœ‰æ²¡æœ‰å¥½å¥‡è¿‡ä¸Šé¢çš„ eslint å‘½ä»¤æ˜¯ä»å“ªé‡Œæ¥çš„ï¼Ÿå…¶å®ï¼Œnpm åœ¨æ‰§è¡ŒæŒ‡å®š <code>script</code> ä¹‹å‰ä¼šæŠŠ <code>node\_modules/.bin</code> åŠ åˆ°ç¯å¢ƒå˜é‡ <code>$PATH</code> çš„å‰é¢ï¼Œè¿™æ„å‘³ç€ä»»ä½•å†…å«å¯æ‰§è¡Œæ–‡ä»¶çš„ <code>npm</code> ä¾èµ–éƒ½å¯ä»¥åœ¨ <code>npm script</code> ä¸­ç›´æ¥è°ƒç”¨ï¼Œæ¢å¥è¯è¯´ï¼Œä½ ä¸éœ€è¦åœ¨ <code>npm script</code> ä¸­åŠ ä¸Šå¯æ‰§è¡Œæ–‡ä»¶çš„å®Œæ•´è·¯å¾„ï¼Œæ¯”å¦‚ <code>./node_modules/.bin/eslint **.js</code>ã€‚</p></blockquote> <h3 id="åˆ›å»ºè‡ªå®šä¹‰-npm-script"><a href="#åˆ›å»ºè‡ªå®šä¹‰-npm-script" class="header-anchor">#</a> åˆ›å»ºè‡ªå®šä¹‰ npm script</h3> <blockquote><p>çŸ¥é“å¦‚ä½•è¿è¡Œ <code>npm script</code> ä¹‹åï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬åœ¨ <code>hello-npm-script</code> é¡¹ç›®ä¸­æ·»åŠ æœ‰å®é™…ç”¨é€”çš„ <code>eslint</code> è„šæœ¬ï¼Œ<a href="https://eslint.org" target="_blank" rel="noopener noreferrer">eslint<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æ˜¯ç¤¾åŒºä¸­æ¥å—åº¦æ¯”è¾ƒé«˜çš„ javascript é£æ ¼æ£€æŸ¥å·¥å…·ï¼Œæœ‰å¤§æŠŠç°æˆçš„è§„åˆ™é›†å¯ä¾›ä½ é€‰æ‹©ï¼Œæ¯”å¦‚ <a href="https://github.com/google/eslint-config-google" target="_blank" rel="noopener noreferrer">google<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€ <a href="https://www.npmjs.com/package/eslint-config-airbnb" target="_blank" rel="noopener noreferrer">airbnb<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p></blockquote> <p>åœ¨æ–°é¡¹ç›®æˆ–è€…ä»»ä½•ç°æœ‰é¡¹ç›®ä¸­æ·»åŠ  eslint è‡ªå®šä¹‰è„šæœ¬çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p> <p><strong>1. å‡†å¤‡è¢«æ£€æŸ¥çš„ä»£ç </strong></p> <p>è¦åšä»£ç æ£€æŸ¥ï¼Œæˆ‘ä»¬å¿…é¡»æœ‰ä»£ç ï¼Œåˆ›å»º <code>index.js</code> æ–‡ä»¶ï¼Œè¾“å…¥å¦‚ä¸‹å†…å®¹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>const str = 'some value';

function fn(){
    console.log('some log');
}

</code></pre></div><p><strong>2. æ·»åŠ  eslint ä¾èµ–</strong></p> <p>æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å°† <code>eslint</code> æ·»åŠ ä¸º <code>devDependencies</code>ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>npm install eslint -D

</code></pre></div><p><strong>3. åˆå§‹åŒ– eslint é…ç½®</strong></p> <p>ç”¨ <code>eslint</code> åšæ£€æŸ¥éœ€è¦é…ç½®è§„åˆ™é›†ï¼Œå­˜æ”¾è§„åˆ™é›†çš„æ–‡ä»¶å°±æ˜¯é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨å¦‚ä¸‹æ–‡ä»¶ç”Ÿæˆé…ç½®æ–‡ä»¶ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>./node_modules/.bin/eslint --init
</code></pre></div><blockquote><p><strong>TIP#3</strong>: æŠŠ eslint å®‰è£…ä¸ºé¡¹ç›®ä¾èµ–è€Œéå…¨å±€å‘½ä»¤ï¼Œé¡¹ç›®å¯ç§»æ¤æ€§æ›´é«˜ã€‚</p></blockquote> <p>åœ¨å‘½ä»¤è¡Œæç¤ºä¸­é€‰æ‹© <code>Answer questions about your style</code>ï¼Œå¦‚ä¸‹å›¾å›ç­”å‡ ä¸ªé—®é¢˜ï¼Œç­”æ¡ˆå¯ä»¥æ ¹æ®è‡ªå·±çš„åå¥½ï¼š</p> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/2.png" alt=""></p> <p>å›è½¦åæ ¹ç›®å½•ä¸‹å°±æœ‰äº† <code>.eslintrc.js</code> é…ç½®æ–‡ä»¶ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  env<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    es6<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    node<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">extends</span><span class="token punctuation">:</span> <span class="token string">'eslint:recommended'</span><span class="token punctuation">,</span>
  rules<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    indent<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'linebreak-style'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token string">'unix'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    quotes<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token string">'single'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    semi<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token string">'always'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>4. æ·»åŠ  eslint å‘½ä»¤</strong></p> <blockquote><p>åœ¨ <code>package.json</code> çš„ <code>scripts</code> å­—æ®µä¸­æ–°å¢å‘½ä»¤ <code>eslint</code>ï¼š</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;scripts&quot;: {
    &quot;eslint&quot;: &quot;eslint *.js&quot;,
    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;
  },
}

</code></pre></div><p><strong>æ‰‹åŠ¨ä¿®æ”¹ package.json æ—¶ä¸€å®šè¦æ³¨æ„è¯­æ³•æ­£ç¡®ã€‚</strong></p> <p><strong>5. è¿è¡Œ eslint å‘½ä»¤</strong></p> <blockquote><p>æ‰§è¡Œ <code>npm run eslint</code>ï¼Œå¯ä»¥çœ‹åˆ°ï¼ŒæŒ‰ç…§å®˜æ–¹æ¨èè§„åˆ™ä»£ç é‡Œæœ‰ 3 å¤„ä¸ç¬¦åˆè§„èŒƒçš„åœ°æ–¹ï¼š</p></blockquote> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/3.png" alt=""></p> <p>å¦‚æœè¯»åˆ°è¿™é‡Œï¼Œç›¸ä¿¡ä½ å·²ç»å®Œæˆ <code>npm script</code> ä¸Šæ‰‹ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å»æ¢ç´¢æ›´é«˜çº§çš„è¯é¢˜ã€‚</p> <p><strong>6. eslint å®Œæˆ reactã€vue.js ä»£ç çš„æ£€æŸ¥</strong></p> <blockquote><p>å¦‚æœéœ€è¦ç»“åˆ <code>eslint</code> æ£€æŸ¥ä¸»æµå‰ç«¯æ¡†æ¶ reactã€vue.jsï¼Œä¸‹é¢æä¾›ä¸¤æ¡çº¿ç´¢ï¼Œå› ä¸ºå®˜æ–¹ä»“åº“çš„ README å°±å¯ä»¥ä½œä¸ºå…¥é—¨æ–‡æ¡£ï¼Œä»”ç»†è¯»è¯»ç›¸ä¿¡ç»å¤§å¤šæ•°åŒå­¦éƒ½èƒ½é…ç½®å¥½ã€‚</p></blockquote> <ul><li>ä½¿ç”¨ <a href="https://github.com/yannickcr/eslint-plugin-react" target="_blank" rel="noopener noreferrer">eslint-plugin-react<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æ£€æŸ¥ react ä»£ç </li> <li>ä½¿ç”¨ <a href="https://github.com/Intellicode/eslint-plugin-react-native" target="_blank" rel="noopener noreferrer">react-plugin-react-native<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æ£€æŸ¥ react-native ä»£ç ï¼Œå¦‚æœä½ æ¯”è¾ƒæ‡’ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ <a href="https://www.npmjs.com/package/eslint-config-airbnb" target="_blank" rel="noopener noreferrer">eslint-config-airbnb<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œé‡Œé¢å†…ç½®äº† eslint-plugin-reactï¼Œæ–°äººå¸¸é‡åˆ° peerDependencies å®‰è£…å¤±è´¥é—®é¢˜å¯å‚ç…§ npmjs ä¸»é¡µä¸Šçš„å¦‚ä¸‹æ–¹æ³•è§£å†³ï¼š</li></ul> <div class="language- extra-class"><pre class="language-text"><code>(
  export PKG=eslint-config-airbnb;
  npm info &quot;$PKG@latest&quot; peerDependencies --json | command sed 's/[\{\},]//g ; s/: /@/g' | xargs npm install --save-dev &quot;$PKG@latest&quot;
)
</code></pre></div><ul><li>æ¨èä½¿ç”¨ vue.js å®˜æ–¹çš„ eslint æ’ä»¶ï¼š<a href="https://github.com/vuejs/eslint-plugin-vue" target="_blank" rel="noopener noreferrer">eslint-plugin-vue<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æ¥æ£€æŸ¥ vue.js ä»£ç ï¼Œå…·ä½“çš„é…ç½®æ–¹æ³•å®˜æ–¹ README å†™çš„æ¸…æ™°æ˜äº†ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚</li> <li>ä¸Šé¢çš„å‡ ç§ eslint è§„åˆ™é›†çš„å®˜æ–¹ä»“åº“éƒ½åˆ—å‡ºäº†å„è‡ªæ”¯æŒçš„è§„åˆ™ï¼Œå¦‚æœä½ éœ€è¦å…³é—­æŸäº›è§„åˆ™ï¼Œå¯ä»¥ç›´æ¥åœ¨è‡ªå·±çš„ .eslintrc* é‡Œé¢çš„ rules ä¸­é…ç½®ï¼Œæ¯”å¦‚æˆ‘ä»¬ä»“åº“é‡Œé¢çš„ï¼š</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  env<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    es6<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    node<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">extends</span><span class="token punctuation">:</span> <span class="token string">'eslint:recommended'</span><span class="token punctuation">,</span>
  rules<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    indent<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'linebreak-style'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token string">'unix'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    quotes<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token string">'single'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    semi<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token string">'always'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_2-è¿è¡Œå¤šä¸ª-npm-script-çš„å„ç§å§¿åŠ¿"><a href="#_2-è¿è¡Œå¤šä¸ª-npm-script-çš„å„ç§å§¿åŠ¿" class="header-anchor">#</a> 2 è¿è¡Œå¤šä¸ª npm script çš„å„ç§å§¿åŠ¿</h2> <blockquote><p>å‰ç«¯é¡¹ç›®é€šå¸¸ä¼šåŒ…æ‹¬å¤šä¸ª <code>npm script</code>ï¼Œå¯¹å¤šä¸ªå‘½ä»¤è¿›è¡Œç¼–æ’æ˜¯å¾ˆè‡ªç„¶çš„éœ€æ±‚ï¼Œæœ‰æ—¶å€™éœ€è¦å°†å¤šä¸ªå‘½ä»¤ä¸²è¡Œï¼Œå³è„šæœ¬éµå¾ªä¸¥æ ¼çš„æ‰§è¡Œé¡ºåºï¼›æœ‰æ—¶å€™åˆ™éœ€è¦è®©å®ƒä»¬å¹¶è¡Œæ¥æé«˜é€Ÿåº¦ï¼Œæ¯”å¦‚ä¸ç›¸äº’é˜»å¡çš„ <code>npm script</code>ã€‚ç¤¾åŒºä¸­ä¹Ÿæœ‰æ¯” <code>npm</code> å†…ç½®çš„å¤šå‘½ä»¤è¿è¡Œæœºåˆ¶æ›´å¥½ç”¨çš„è§£å†³æ–¹æ¡ˆï¼š<code>npm-run-all</code>ã€‚</p></blockquote> <h3 id="å“ªæ¥é‚£ä¹ˆå¤šå‘½ä»¤ï¼Ÿ"><a href="#å“ªæ¥é‚£ä¹ˆå¤šå‘½ä»¤ï¼Ÿ" class="header-anchor">#</a> å“ªæ¥é‚£ä¹ˆå¤šå‘½ä»¤ï¼Ÿ</h3> <blockquote><p>é€šå¸¸æ¥è¯´ï¼Œå‰ç«¯é¡¹ç›®ä¼šåŒ…å« <code>js</code>ã€<code>css</code>ã€<code>less</code>ã€<code>scss</code>ã€<code>json</code>ã€<code>markdown</code> ç­‰æ ¼å¼çš„æ–‡ä»¶ï¼Œä¸ºä¿éšœä»£ç è´¨é‡ï¼Œç»™ä¸åŒçš„ä»£ç æ·»åŠ æ£€æŸ¥æ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼Œä»£ç æ£€æŸ¥ä¸ä»…ä¿éšœä»£ç æ²¡æœ‰ä½çº§çš„è¯­æ³•é”™è¯¯ï¼Œè¿˜å¯ç¡®ä¿ä»£ç éƒ½éµå®ˆç¤¾åŒºçš„æœ€ä½³å®è·µå’Œä¸€è‡´çš„ç¼–ç é£æ ¼ï¼Œåœ¨å›¢é˜Ÿåä½œä¸­å°¤å…¶æœ‰ç”¨ï¼Œå³ä½¿æ˜¯ä¸ªäººé¡¹ç›®ï¼ŒåŠ ä¸Šä»£ç æ£€æŸ¥ï¼Œä¹Ÿä¼šæé«˜ä½ çš„æ•ˆç‡å’Œè´¨é‡ã€‚</p></blockquote> <p>æˆ‘é€šå¸¸ä¼šç»™å‰ç«¯é¡¹ç›®åŠ ä¸Šä¸‹é¢ 4 ç§ä»£ç æ£€æŸ¥ï¼š</p> <ul><li><a href="https://eslint.org" target="_blank" rel="noopener noreferrer">eslint<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œå¯å®šåˆ¶çš„ js ä»£ç æ£€æŸ¥</li> <li><a href="https://stylelint.io" target="_blank" rel="noopener noreferrer">stylelint<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œå¯å®šåˆ¶çš„æ ·å¼æ–‡ä»¶æ£€æŸ¥ï¼Œæ”¯æŒ <code>css</code>ã€<code>less</code>ã€<code>scss</code>ï¼›</li> <li><a href="https://github.com/zaach/jsonlint" target="_blank" rel="noopener noreferrer">jsonlint<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œ<code>json</code> æ–‡ä»¶è¯­æ³•æ£€æŸ¥ï¼Œè¸©è¿‡å‘çš„åŒå­¦ä¼šæ¸…æ¥šï¼Œ<code>json</code> æ–‡ä»¶è¯­æ³•é”™è¯¯ä¼šçŸ¥é“å¯¼è‡´å„ç§å¤±è´¥ï¼›</li> <li><a href="https://github.com/igorshubovych/markdownlint-cli" target="_blank" rel="noopener noreferrer">markdownlint-cli<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼ŒMarkdown æ–‡ä»¶æœ€ä½³å®è·µæ£€æŸ¥ï¼Œä¸ªäººåå¥½ï¼›</li></ul> <p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>html</code> ä»£ç ä¹Ÿåº”è¯¥æ£€æŸ¥ï¼Œä½†æ˜¯å·¥å…·æ”¯æŒè–„å¼±ï¼Œå°±ç•¥è¿‡ä¸è¡¨ã€‚æ­¤å¤–ï¼Œä¸ºä»£ç æ·»åŠ å¿…è¦çš„å•å…ƒæµ‹è¯•ä¹Ÿæ˜¯è´¨é‡ä¿éšœçš„é‡è¦æ‰‹æ®µï¼Œå¸¸ç”¨çš„å•æµ‹æŠ€æœ¯æ ˆæ˜¯ï¼š</p> <ul><li><a href="https://mochajs.org" target="_blank" rel="noopener noreferrer">mocha<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œæµ‹è¯•ç”¨ä¾‹ç»„ç»‡ï¼Œæµ‹è¯•ç”¨ä¾‹è¿è¡Œå’Œç»“æœæ”¶é›†çš„æ¡†æ¶ï¼›</li> <li><a href="http://chaijs.com" target="_blank" rel="noopener noreferrer">chai<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œæµ‹è¯•æ–­è¨€åº“ï¼Œå¿…è¦çš„æ—¶å€™å¯ä»¥ç»“åˆ <a href="http://sinonjs.org" target="_blank" rel="noopener noreferrer">sinon<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ä½¿ç”¨ï¼›</li></ul> <blockquote><p><strong>TIP#4</strong>ï¼šæµ‹è¯•å·¥å…·å¦‚ <a href="http://www.node-tap.org" target="_blank" rel="noopener noreferrer">tap<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€<a href="https://github.com/avajs/ava" target="_blank" rel="noopener noreferrer">ava<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ä¹Ÿéƒ½æä¾›äº†å‘½ä»¤è¡Œæ¥å£ï¼Œèƒ½å¾ˆå¥½çš„é›†æˆåˆ° <code>npm script</code> ä¸­ï¼ŒåŸç†æ˜¯ç›¸é€šçš„ã€‚</p></blockquote> <p>åŒ…å«äº†åŸºæœ¬çš„ä»£ç æ£€æŸ¥ã€å•å…ƒæµ‹è¯•å‘½ä»¤çš„ <code>package.json</code> å¦‚ä¸‹ï¼š</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;hello-npm-script&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.1.0&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;main&quot;</span><span class="token operator">:</span> <span class="token string">&quot;index.js&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;lint:js&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eslint *.js&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;lint:css&quot;</span><span class="token operator">:</span> <span class="token string">&quot;stylelint *.less&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;lint:json&quot;</span><span class="token operator">:</span> <span class="token string">&quot;jsonlint --quiet *.json&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;lint:markdown&quot;</span><span class="token operator">:</span> <span class="token string">&quot;markdownlint --config .markdownlint.json *.md&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mocha tests/&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;chai&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.1.2&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;eslint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.11.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;jsonlint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.6.2&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;markdownlint-cli&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^0.5.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;mocha&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.0.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;stylelint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^8.2.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;stylelint-config-standard&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^17.0.0&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="è®©å¤šä¸ª-npm-script-ä¸²è¡Œï¼Ÿ"><a href="#è®©å¤šä¸ª-npm-script-ä¸²è¡Œï¼Ÿ" class="header-anchor">#</a> è®©å¤šä¸ª npm script ä¸²è¡Œï¼Ÿ</h3> <blockquote><p>åœ¨æˆ‘ä»¬è¿è¡Œæµ‹è¯•ä¹‹å‰ç¡®ä¿æˆ‘ä»¬çš„ä»£ç éƒ½é€šè¿‡ä»£ç æ£€æŸ¥ä¼šæ˜¯æ¯”è¾ƒä¸é”™çš„å®è·µï¼Œè¿™ä¹Ÿæ˜¯è®©å¤šä¸ª <code>npm script</code> ä¸²è¡Œçš„å…¸å‹ç”¨ä¾‹ï¼Œå®ç°æ–¹å¼ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œåªéœ€è¦ç”¨ <code>&amp;&amp;</code> ç¬¦å·æŠŠå¤šæ¡ <code>npm script</code> æŒ‰å…ˆåé¡ºåºä¸²èµ·æ¥å³å¯ï¼Œå…·ä½“åˆ°æˆ‘ä»¬çš„é¡¹ç›®ï¼Œä¿®æ”¹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>diff --git a/package.json b/package.json
index c904250..023d71e 100644
--- a/package.json
+++ b/package.json
@@ -8,7 +8,7 @@
-    &quot;test&quot;: &quot;mocha tests/&quot;
+    &quot;test&quot;: &quot;npm run lint:js &amp;&amp; npm run lint:css &amp;&amp; npm run lint:json &amp;&amp; npm run lint:markdown &amp;&amp; mocha tests/&quot;
   },

</code></pre></div><blockquote><p>ç„¶åç›´æ¥æ‰§è¡Œ <code>npm test</code> æˆ– <code>npm t</code>ï¼Œä»è¾“å‡ºå¯ä»¥çœ‹åˆ°å­å‘½ä»¤çš„æ‰§è¡Œé¡ºåºæ˜¯ä¸¥æ ¼æŒ‰ç…§æˆ‘ä»¬åœ¨ <code>scripts</code> ä¸­å£°æ˜çš„å…ˆåé¡ºåºæ¥çš„ï¼š</p></blockquote> <blockquote><p><code>eslint ==&gt; stylelint ==&gt; jsonlint ==&gt; markdownlint ==&gt; mocha</code></p></blockquote> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/4.png" alt=""></p> <p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸²è¡Œæ‰§è¡Œçš„æ—¶å€™å¦‚æœå‰åºå‘½ä»¤å¤±è´¥ï¼ˆé€šå¸¸è¿›ç¨‹é€€å‡ºç é0ï¼‰ï¼Œåç»­å…¨éƒ¨å‘½ä»¤éƒ½ä¼šç»ˆæ­¢ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•åœ¨ <code>index.js</code> ä¸­å¼•å…¥é”™è¯¯ï¼ˆåˆ æ‰è¡Œæœ«çš„åˆ†å·ï¼‰ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>diff --git a/index.js b/index.js
index ab8bd0e..b817ea4 100644
--- a/index.js
+++ b/index.js
@@ -4,7 +4,7 @@ const add = (a, b) =&gt; {
   }

   return NaN;
-};
+}

 module.exports = { add  };
</code></pre></div><p>ç„¶åé‡æ–°è¿è¡Œ <code>npm t</code>ï¼Œç»“æœå¦‚ä¸‹ï¼Œ<code>npm run lint:js</code> å¤±è´¥ä¹‹åï¼Œåç»­å‘½ä»¤éƒ½æ²¡æœ‰æ‰§è¡Œï¼š</p> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/5.png" alt=""></p> <h3 id="è®©å¤šä¸ª-npm-script-å¹¶è¡Œï¼Ÿ"><a href="#è®©å¤šä¸ª-npm-script-å¹¶è¡Œï¼Ÿ" class="header-anchor">#</a> è®©å¤šä¸ª npm script å¹¶è¡Œï¼Ÿ</h3> <blockquote><p>åœ¨ä¸¥æ ¼ä¸²è¡Œçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¿…é¡»è¦ç¡®ä¿ä»£ç ä¸­æ²¡æœ‰ç¼–ç è§„èŒƒé—®é¢˜æ‰èƒ½è¿è¡Œæµ‹è¯•ï¼Œåœ¨æŸäº›æ—¶å€™å¯èƒ½å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œå› ä¸ºæˆ‘ä»¬çœŸæ­£éœ€è¦çš„æ˜¯ï¼Œä»£ç å˜æ›´æ—¶åŒæ—¶ç»™å‡ºæµ‹è¯•ç»“æœå’Œæµ‹è¯•è¿è¡Œç»“æœã€‚è¿™å°±éœ€è¦æŠŠå­å‘½ä»¤çš„è¿è¡Œä»ä¸²è¡Œæ”¹æˆå¹¶è¡Œï¼Œå®ç°æ–¹å¼æ›´ç®€å•ï¼ŒæŠŠè¿æ¥å¤šæ¡å‘½ä»¤çš„ <code>&amp;&amp;</code> ç¬¦å·æ›¿æ¢æˆ <code>&amp;</code> å³å¯ã€‚</p></blockquote> <p>ä»£ç å˜æ›´å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>diff --git a/package.json b/package.json
index 023d71e..2d9bd6f 100644
--- a/package.json
+++ b/package.json
@@ -8,7 +8,7 @@
-    &quot;test&quot;: &quot;npm run lint:js &amp;&amp; npm run lint:css &amp;&amp; npm run lint:json &amp;&amp; npm run lint:markdown &amp;&amp; mocha tests/&quot;
+    &quot;test&quot;: &quot;npm run lint:js &amp; npm run lint:css &amp; npm run lint:json &amp; npm run lint:markdown &amp; mocha tests/&quot;
   },

</code></pre></div><p>é‡æ–°è¿è¡Œ <code>npm t</code>ï¼Œæˆ‘ä»¬å¾—åˆ°å¦‚ä¸‹ç»“æœï¼š</p> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/6.png" alt=""></p> <blockquote><p>ç»†å¿ƒçš„åŒå­¦å¯èƒ½å·²ç»å‘ç°ä¸Šå›¾ä¸­å“ªé‡Œä¸å¯¹ï¼Œ<code>npm run lint:js</code> çš„ç»“æœåœ¨è¿›ç¨‹é€€å‡ºä¹‹åæ‰è¾“å‡ºï¼Œå¦‚æœä½ è‡ªå·±è¿è¡Œï¼Œä¸ä¸€å®šèƒ½ç¨³å®šå¤ç°è¿™ä¸ªé—®é¢˜ï¼Œä½† <code>npm</code> å†…ç½®æ”¯æŒçš„å¤šæ¡å‘½ä»¤å¹¶è¡Œè·Ÿ <code>js</code> é‡Œé¢åŒæ—¶å‘èµ·å¤šä¸ªå¼‚æ­¥è¯·æ±‚éå¸¸ç±»ä¼¼ï¼Œå®ƒåªè´Ÿè´£è§¦å‘å¤šæ¡å‘½ä»¤ï¼Œè€Œä¸ç®¡ç»“æœçš„æ”¶é›†ï¼Œå¦‚æœå¹¶è¡Œçš„å‘½ä»¤æ‰§è¡Œæ—¶é—´å·®å¼‚éå¸¸å¤§ï¼Œä¸Šé¢çš„é—®é¢˜å°±ä¼šç¨³å®šå¤ç°ã€‚æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</p></blockquote> <p>ç­”æ¡ˆä¹Ÿå¾ˆç®€å•ï¼Œåœ¨å‘½ä»¤çš„å¢åŠ  <code>&amp; wait</code> å³å¯ï¼Œè¿™æ ·æˆ‘ä»¬çš„ test å‘½ä»¤é•¿è¿™æ ·ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>npm run lint:js &amp; npm run lint:css &amp; npm run lint:json &amp; npm run lint:markdown &amp; mocha tests/ &amp; wait
</code></pre></div><blockquote><p>åŠ ä¸Š <code>wait</code> çš„é¢å¤–å¥½å¤„æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ä»»ä½•å­å‘½ä»¤ä¸­å¯åŠ¨äº†é•¿æ—¶é—´è¿è¡Œçš„è¿›ç¨‹ï¼Œæ¯”å¦‚å¯ç”¨äº† <code>mocha</code> çš„ <code>--watch</code> é…ç½®ï¼Œå¯ä»¥ä½¿ç”¨ <code>ctrl + c</code> æ¥ç»“æŸè¿›ç¨‹ï¼Œå¦‚æœæ²¡åŠ çš„è¯ï¼Œä½ å°±æ²¡åŠæ³•ç›´æ¥ç»“æŸå¯åŠ¨åˆ°åå°çš„è¿›ç¨‹ã€‚</p></blockquote> <h3 id="æœ‰æ²¡æœ‰æ›´å¥½çš„ç®¡ç†æ–¹å¼ï¼Ÿ"><a href="#æœ‰æ²¡æœ‰æ›´å¥½çš„ç®¡ç†æ–¹å¼ï¼Ÿ" class="header-anchor">#</a> æœ‰æ²¡æœ‰æ›´å¥½çš„ç®¡ç†æ–¹å¼ï¼Ÿ</h3> <ul><li>æœ‰å¼ºè¿«ç—‡çš„åŒå­¦å¯èƒ½ä¼šè§‰å¾—åƒä¸Šé¢è¿™æ ·ç”¨åŸç”Ÿæ–¹å¼æ¥è¿è¡Œå¤šæ¡å‘½ä»¤å¾ˆè‡ƒè‚¿ï¼Œå¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>npm-run-all</code> å®ç°æ›´è½»é‡å’Œç®€æ´çš„å¤šå‘½ä»¤è¿è¡Œã€‚</li> <li>ç”¨å¦‚ä¸‹å‘½ä»¤å°† <code>npm-run-all</code> æ·»åŠ åˆ°é¡¹ç›®ä¾èµ–ä¸­ï¼š</li></ul> <div class="language- extra-class"><pre class="language-text"><code>npm i npm-run-all -D
</code></pre></div><p>ç„¶åä¿®æ”¹ <code>package.json</code> å®ç°å¤šå‘½ä»¤çš„ä¸²è¡Œæ‰§è¡Œï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>diff --git a/package.json b/package.json
index b3b1272..83974d6 100644
--- a/package.json
+++ b/package.json
@@ -8,7 +8,8 @@
-    &quot;test&quot;: &quot;npm run lint:js &amp; npm run lint:css &amp; npm run lint:json &amp; npm run lint:markdown &amp; mocha tests/ &amp; wait&quot;
+    &quot;mocha&quot;: &quot;mocha tests/&quot;,
+    &quot;test&quot;: &quot;npm-run-all lint:js lint:css lint:json lint:markdown mocha&quot;
   },

</code></pre></div><blockquote><p><code>npm-run-all</code> è¿˜æ”¯æŒé€šé…ç¬¦åŒ¹é…åˆ†ç»„çš„ <code>npm script</code>ï¼Œä¸Šé¢çš„è„šæœ¬å¯ä»¥è¿›ä¸€æ­¥ç®€åŒ–æˆï¼š</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>diff --git a/package.json b/package.json
index 83974d6..7b327cd 100644
--- a/package.json
+++ b/package.json
@@ -9,7 +9,7 @@
-    &quot;test&quot;: &quot;npm-run-all lint:js lint:css lint:json lint:markdown mocha&quot;
+    &quot;test&quot;: &quot;npm-run-all lint:* mocha&quot;
   },

</code></pre></div><blockquote><p>å¦‚ä½•è®©å¤šä¸ª <code>npm script</code> å¹¶è¡Œæ‰§è¡Œï¼Ÿä¹Ÿå¾ˆç®€å•ï¼š</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>diff --git a/package.json b/package.json
index 7b327cd..c32da1c 100644
--- a/package.json
+++ b/package.json
@@ -9,7 +9,7 @@
-    &quot;test&quot;: &quot;npm-run-all lint:* mocha&quot;
+    &quot;test&quot;: &quot;npm-run-all --parallel lint:* mocha&quot;
   },

</code></pre></div><blockquote><p>å¹¶è¡Œæ‰§è¡Œçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦åœ¨åé¢å¢åŠ  <code>&amp; wait</code>ï¼Œå› ä¸º npm-run-all å·²ç»å¸®æˆ‘ä»¬åšäº†ã€‚</p></blockquote> <blockquote><p><strong>TIP#5</strong>ï¼šnpm-run-all è¿˜æä¾›äº†å¾ˆå¤šé…ç½®é¡¹æ”¯æŒæ›´å¤æ‚çš„å‘½ä»¤ç¼–æ’ï¼Œæ¯”å¦‚å¤šä¸ªå‘½ä»¤å¹¶è¡Œä¹‹åæ¥ä¸²è¡Œçš„å‘½ä»¤ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦è¯·é˜…è¯»<a href="https://github.com/mysticatea/npm-run-all/blob/HEAD/docs/npm-run-all.md" target="_blank" rel="noopener noreferrer">æ–‡æ¡£<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œè‡ªå·±ç©å„¿ã€‚</p></blockquote> <h2 id="_3-ç»™-npm-script-ä¼ é€’å‚æ•°å’Œæ·»åŠ æ³¨é‡Š"><a href="#_3-ç»™-npm-script-ä¼ é€’å‚æ•°å’Œæ·»åŠ æ³¨é‡Š" class="header-anchor">#</a> 3 ç»™ npm script ä¼ é€’å‚æ•°å’Œæ·»åŠ æ³¨é‡Š</h2> <p>æœ¬å°èŠ‚ä¼šä»‹ç» 3 ä¸ªçŸ¥è¯†ç‚¹ï¼šç»™ <code>npm script</code> ä¼ é€’å‚æ•°ä»¥å‡å°‘é‡å¤çš„ <code>npm script</code>ï¼›å¢åŠ æ³¨é‡Šæé«˜ <code>npm script</code> è„šæœ¬çš„å¯è¯»æ€§ï¼›æ§åˆ¶è¿è¡Œæ—¶æ—¥å¿—è¾“å‡ºèƒ½è®©ä½ ä¸“æ³¨åœ¨é‡è¦ä¿¡æ¯ä¸Šã€‚</p> <h3 id="ç»™-npm-script-ä¼ é€’å‚æ•°"><a href="#ç»™-npm-script-ä¼ é€’å‚æ•°" class="header-anchor">#</a> ç»™ npm script ä¼ é€’å‚æ•°</h3> <blockquote><p><code>eslint</code> å†…ç½®äº†ä»£ç é£æ ¼è‡ªåŠ¨ä¿®å¤æ¨¡å¼ï¼Œåªéœ€ç»™å®ƒä¼ å…¥ <code>--fix</code> å‚æ•°å³å¯ï¼Œåœ¨ <code>scripts</code> ä¸­å£°æ˜æ£€æŸ¥ä»£ç å‘½ä»¤çš„åŒæ—¶ä½ å¯èƒ½ä¹Ÿéœ€è¦å£°æ˜ä¿®å¤ä»£ç çš„å‘½ä»¤ï¼Œé¢å¯¹è¿™ç§éœ€æ±‚ï¼Œå¤§å¤šæ•°åŒå­¦å¯èƒ½ä¼šå¿ä¸ä½å¤åˆ¶ç²˜è´´ï¼Œå¦‚ä¸‹ï¼š</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>diff --git a/package.json b/package.json
index c32da1c..b6fb03e 100644
--- a/package.json
+++ b/package.json
@@ -5,6 +5,7 @@
     &quot;lint:js&quot;: &quot;eslint *.js&quot;,
+    &quot;lint:js:fix&quot;: &quot;eslint *.js --fix&quot;,
</code></pre></div><blockquote><p>åœ¨ <code>lint:js</code> å‘½ä»¤æ¯”è¾ƒçŸ­çš„æ—¶å€™å¤åˆ¶ç²˜è´´çš„æ–¹æ³•ç®€å•ç²—æš´æœ‰æ•ˆï¼Œä½†æ˜¯å½“ <code>lint:js</code> å‘½ä»¤å˜çš„å¾ˆé•¿ä¹‹åï¼Œéš¾å…åç»­ä¼šæœ‰äººæ”¹äº† <code>lint:js</code> è€Œå¿˜è®°ä¿®æ”¹ <code>lint:js:fix</code>ï¼ˆ<strong>åˆ«é—®æˆ‘ä¸ºå•¥ï¼Œæˆ‘å°±æ˜¯è¸©ç€å‘è¿‡æ¥çš„</strong>ï¼‰ï¼Œæ›´å¥å£®çš„åšæ³•æ˜¯ï¼Œåœ¨è¿è¡Œ <code>npm script</code> æ—¶ç»™å®šé¢å¤–çš„å‚æ•°ï¼Œä»£ç ä¿®æ”¹å¦‚ä¸‹ï¼š</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>diff --git a/package.json b/package.json
--- a/package.json
+++ b/package.json
@@ -5,6 +5,7 @@
     &quot;lint:js&quot;: &quot;eslint *.js&quot;,
+    &quot;lint:js:fix&quot;: &quot;npm run lint:js -- --fix&quot;,
</code></pre></div><blockquote><p>è¦æ ¼å¤–æ³¨æ„ <code>--fix</code> å‚æ•°å‰é¢çš„ <code>--</code> åˆ†éš”ç¬¦ï¼Œæ„æŒ‡è¦ç»™ <code>npm run lint:js</code> å®é™…æŒ‡å‘çš„å‘½ä»¤ä¼ é€’é¢å¤–çš„å‚æ•°ã€‚</p></blockquote> <p>è¿è¡Œæ•ˆæœå¦‚ä¸‹å›¾ï¼š</p> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/7.png" alt=""></p> <p>ä¸Šå›¾ç¬¬2ä¸ªçº¢è‰²æ¡†é‡Œé¢æ˜¯å®é™…æ‰§è¡Œçš„å‘½ä»¤ï¼Œå¯ä»¥çœ‹åˆ° <code>--fix</code> å‚æ•°é™„åŠ åœ¨äº†åé¢ã€‚</p> <blockquote><p><strong>TIP#6</strong>ï¼šå¦‚æœä½ ä¸æƒ³å•ç‹¬å£°æ˜ <code>lint:js:fix</code> å‘½ä»¤ï¼Œåœ¨éœ€è¦çš„æ—¶å€™ç›´æ¥è¿è¡Œï¼š <code>npm run lint:js -- --fix</code> æ¥å®ç°åŒæ ·çš„æ•ˆæœã€‚</p></blockquote> <blockquote><p>é—®é¢˜æ¥äº†ï¼Œå¦‚æœæˆ‘æƒ³ä¸º mocha å‘½ä»¤å¢åŠ  <code>--watch</code> æ¨¡å¼æ–¹ä¾¿åœ¨å¼€å‘æ—¶ç«‹å³çœ‹åˆ°æµ‹è¯•ç»“æœï¼Œè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿç›¸ä¿¡è¯»åˆ°è¿™é‡Œä½ å¿ƒä¸­å·²ç»æœ‰äº†ç­”æ¡ˆã€‚</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>:stuck\_out\_tongue:
</code></pre></div><h3 id="ç»™-npm-script-æ·»åŠ æ³¨é‡Š"><a href="#ç»™-npm-script-æ·»åŠ æ³¨é‡Š" class="header-anchor">#</a> ç»™ npm script æ·»åŠ æ³¨é‡Š</h3> <ul><li>å¦‚æœ <code>package.json</code> ä¸­çš„ <code>scripts</code> è¶Šæ¥è¶Šå¤šï¼Œæˆ–è€…å‡ºç°å¤æ‚çš„ç¼–æ’å‘½ä»¤ï¼Œä½ å¯èƒ½éœ€è¦ç»™å®ƒä»¬æ·»åŠ æ³¨é‡Šä»¥ä¿éšœä»£ç å¯è¯»æ€§ï¼Œä½† <code>json</code> å¤©ç„¶æ˜¯ä¸æ”¯æŒæ·»åŠ æ³¨é‡Šçš„ï¼Œä¸‹é¢æ˜¯ 2 ç§æ¯”è¾ƒ <code>trick</code> çš„æ–¹å¼ã€‚</li> <li>ç¬¬ä¸€ç§æ–¹å¼æ˜¯ï¼Œ<code>package.json</code> ä¸­å¯ä»¥å¢åŠ  <code>//</code> ä¸ºé”®çš„å€¼ï¼Œæ³¨é‡Šå°±å¯ä»¥å†™åœ¨å¯¹åº”çš„å€¼é‡Œé¢ï¼Œnpm ä¼šå¿½ç•¥è¿™ç§é”®ï¼Œæ¯”å¦‚ï¼Œæˆ‘ä»¬æƒ³è¦ç»™ <code>test</code> å‘½ä»¤æ·»åŠ æ³¨é‡Šï¼ŒæŒ‰å¦‚ä¸‹æ–¹å¼æ·»åŠ ï¼š</li></ul> <div class="language- extra-class"><pre class="language-text"><code>diff --git a/package.json b/package.json
--- a/package.json
+++ b/package.json
@@ -10,6 +10,7 @@
+    &quot;//&quot;: &quot;è¿è¡Œæ‰€æœ‰ä»£ç æ£€æŸ¥å’Œå•å…ƒæµ‹è¯•&quot;,
     &quot;test&quot;: &quot;npm-run-all --parallel lint:* mocha&quot;
</code></pre></div><p>è¿™ç§æ–¹å¼çš„æ˜æ˜¾ä¸è¶³æ˜¯ï¼Œ<code>npm run</code> åˆ—å‡ºæ¥çš„å‘½ä»¤åˆ—è¡¨ä¸èƒ½æŠŠæ³¨é‡Šå’Œå®é™…å‘½ä»¤å¯¹åº”ä¸Šï¼Œå¦‚æœä½ å£°æ˜äº†å¤šä¸ªï¼Œ<code>npm run</code> åªä¼šåˆ—å‡ºæœ€åé‚£ä¸ªï¼Œå¦‚ä¸‹å›¾ï¼š</p> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/8.png" alt=""></p> <blockquote><p>å¦å¤–ä¸€ç§æ–¹å¼æ˜¯ç›´æ¥åœ¨ <code>script</code> å£°æ˜ä¸­åšæ‰‹è„šï¼Œå› ä¸ºå‘½ä»¤çš„æœ¬è´¨æ˜¯ <code>shell</code> å‘½ä»¤ï¼ˆé€‚ç”¨äº linux å¹³å°ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å‘½ä»¤å‰é¢åŠ ä¸Šæ³¨é‡Šï¼Œå…·ä½“åšæ³•å¦‚ä¸‹ï¼š</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>diff --git a/package.json b/package.json
--- a/package.json
+++ b/package.json
@@ -10,8 +10,7 @@
-    &quot;//&quot;: &quot;è¿è¡Œæ‰€æœ‰ä»£ç æ£€æŸ¥å’Œå•å…ƒæµ‹è¯•&quot;,
-    &quot;test&quot;: &quot;npm-run-all --parallel lint:* mocha&quot;
+    &quot;test&quot;: &quot;# è¿è¡Œæ‰€æœ‰ä»£ç æ£€æŸ¥å’Œå•å…ƒæµ‹è¯• \n    npm-run-all --parallel lint:* mocha&quot;
</code></pre></div><blockquote><p>æ³¨æ„æ³¨é‡Šåé¢çš„æ¢è¡Œç¬¦ <code>\n</code> å’Œå¤šä½™çš„ç©ºæ ¼ï¼Œæ¢è¡Œç¬¦æ˜¯ç”¨äºå°†æ³¨é‡Šå’Œå‘½ä»¤åˆ†éš”å¼€ï¼Œè¿™æ ·å‘½ä»¤å°±ç›¸å½“äºå¾®å‹çš„ shell è„šæœ¬ï¼Œå¤šä½™çš„ç©ºæ ¼æ˜¯ä¸ºäº†æ§åˆ¶ç¼©è¿›ï¼Œä¹Ÿå¯ä»¥ç”¨åˆ¶è¡¨ç¬¦ <code>\t</code> æ›¿ä»£ã€‚è¿™ç§åšæ³•èƒ½è®© <code>npm run</code> åˆ—å‡ºæ¥çš„å‘½ä»¤æ›´ç¾è§‚ï¼Œä½†æ˜¯ <code>scripts</code> å£°æ˜é˜…è¯»èµ·æ¥ä¸é‚£ä¹ˆæ•´é½ç¾è§‚ã€‚</p></blockquote> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/9.png" alt=""></p> <p>ä¸Šé¢ä¸¤ç§æ–¹å¼éƒ½æœ‰æ˜æ˜¾çš„ç¼ºé™·ï¼Œä¸ªäººå»ºè®®çš„æ›´ä¼˜æ–¹æ¡ˆè¿˜æ˜¯æŠŠå¤æ‚çš„å‘½ä»¤å‰¥ç¦»åˆ°å•ç‹¬çš„æ–‡ä»¶ä¸­ç®¡ç†ï¼Œåœ¨å•ç‹¬çš„æ–‡ä»¶ä¸­å¯ä»¥è‡ªç”±ç»™å®ƒæ·»åŠ æ³¨é‡Šï¼Œè¯¦è§åç»­ç« èŠ‚ã€‚</p> <h3 id="è°ƒæ•´-npm-script-è¿è¡Œæ—¶æ—¥å¿—è¾“å‡º"><a href="#è°ƒæ•´-npm-script-è¿è¡Œæ—¶æ—¥å¿—è¾“å‡º" class="header-anchor">#</a> è°ƒæ•´ npm script è¿è¡Œæ—¶æ—¥å¿—è¾“å‡º</h3> <blockquote><p>åœ¨è¿è¡Œ <code>npm script</code> å‡ºç°é—®é¢˜æ—¶ä½ éœ€è¦æœ‰èƒ½åŠ›å»è°ƒè¯•å®ƒï¼ŒæŸäº›æƒ…å†µä¸‹ä½ éœ€è¦è®© <code>npm script</code> ä»¥é™é»˜çš„æ–¹å¼è¿è¡Œï¼Œè¿™ç±»éœ€æ±‚å¯é€šè¿‡æ§åˆ¶è¿è¡Œæ—¶æ—¥å¿—è¾“å‡ºçº§åˆ«æ¥å®ç°ã€‚</p></blockquote> <p>æ—¥å¿—çº§åˆ«æ§åˆ¶å‚æ•°æœ‰å¥½å‡ ä¸ªï¼Œç®€å•ä¸¾ä¾‹å¦‚ä¸‹ï¼š</p> <p><strong>1. é»˜è®¤æ—¥å¿—è¾“å‡ºçº§åˆ«</strong></p> <p>å³ä¸åŠ ä»»ä½•æ—¥å¿—æ§åˆ¶å‚æ•°å¾—åˆ°çš„è¾“å‡ºï¼Œå¯èƒ½æ˜¯ä½ æœ€å¸¸ç”¨çš„ï¼Œèƒ½çœ‹åˆ°æ‰§è¡Œçš„å‘½ä»¤ã€å‘½ä»¤æ‰§è¡Œçš„ç»“æœã€‚</p> <p><strong>2. æ˜¾ç¤ºå°½å¯èƒ½å°‘çš„æœ‰ç”¨ä¿¡æ¯</strong></p> <blockquote><p>ç»“åˆå…¶ä»–å·¥å…·è°ƒç”¨ <code>npm script</code> çš„æ—¶å€™æ¯”è¾ƒæœ‰ç”¨ï¼Œéœ€è¦ä½¿ç”¨ <code>--loglevel silent</code>ï¼Œæˆ–è€… <code>--silent</code>ï¼Œæˆ–è€…æ›´ç®€å•çš„ <code>-s</code> æ¥æ§åˆ¶ï¼Œè¿™ä¸ªæ—¥å¿—çº§åˆ«çš„è¾“å‡ºå®ä¾‹å¦‚ä¸‹ï¼ˆåªæœ‰å‘½ä»¤æœ¬èº«çš„è¾“å‡ºï¼Œè¯»èµ·æ¥éå¸¸çš„ç®€æ´ï¼‰ï¼š</p></blockquote> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/10.png" alt=""></p> <blockquote><p>å¦‚æœæ‰§è¡Œå„ç§ <code>lint script</code> çš„æ—¶å€™å¯ç”¨äº† <code>-s</code> é…ç½®ï¼Œä»£ç éƒ½ç¬¦åˆè§„èŒƒçš„è¯ï¼Œä½ ä¸ä¼šçœ‹åˆ°ä»»ä½•è¾“å‡ºï¼Œè¿™å°±æ˜¯<strong>æ²¡æœ‰æ¶ˆæ¯æ˜¯æœ€å¥½çš„æ¶ˆæ¯</strong>çš„ç”±æ¥ï¼Œå“ˆå“ˆï¼</p></blockquote> <p><strong>3. æ˜¾ç¤ºå°½å¯èƒ½å¤šçš„è¿è¡Œæ—¶çŠ¶æ€</strong></p> <blockquote><p>æ’æŸ¥è„šæœ¬é—®é¢˜çš„æ—¶å€™æ¯”è¾ƒæœ‰ç”¨ï¼Œéœ€è¦ä½¿ç”¨ <code>--loglevel verbose</code>ï¼Œæˆ–è€… <code>--verbose</code>ï¼Œæˆ–è€…æ›´ç®€å•çš„ <code>-d</code> æ¥æ§åˆ¶ï¼Œè¿™ä¸ªæ—¥å¿—çº§åˆ«çš„è¾“å‡ºå®ä¾‹å¦‚ä¸‹ï¼ˆè¯¦ç»†æ‰“å°å‡ºäº†æ¯ä¸ªæ­¥éª¤çš„å‚æ•°ã€è¿”å›å€¼ï¼Œä¸‹é¢çš„æˆªå›¾åªæ˜¯éƒ¨åˆ†ï¼‰ï¼š</p></blockquote> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/11.png" alt=""></p> <h2 id="_4-ä½¿ç”¨-npm-script-çš„é’©å­"><a href="#_4-ä½¿ç”¨-npm-script-çš„é’©å­" class="header-anchor">#</a> 4 ä½¿ç”¨ npm script çš„é’©å­</h2> <blockquote><p>ä¸ºäº†æ–¹ä¾¿å¼€å‘è€…è‡ªå®šä¹‰ï¼Œ<code>npm script</code> çš„è®¾è®¡è€…ä¸ºå‘½ä»¤çš„æ‰§è¡Œå¢åŠ äº†ç±»ä¼¼ç”Ÿå‘½å‘¨æœŸçš„æœºåˆ¶ï¼Œå…·ä½“æ¥è¯´å°±æ˜¯ <code>pre</code> å’Œ <code>post</code> é’©å­è„šæœ¬ã€‚è¿™ç§ç‰¹æ€§åœ¨æŸäº›æ“ä½œå‰éœ€è¦åšæ£€æŸ¥ã€æŸäº›æ“ä½œåéœ€è¦åšæ¸…ç†çš„æƒ…å†µä¸‹éå¸¸æœ‰ç”¨ã€‚</p></blockquote> <p><strong>ä¸¾ä¾‹æ¥è¯´ï¼Œè¿è¡Œ npm run test çš„æ—¶å€™ï¼Œåˆ† 3 ä¸ªé˜¶æ®µï¼š</strong></p> <ol><li>æ£€æŸ¥ <code>scripts</code> å¯¹è±¡ä¸­æ˜¯å¦å­˜åœ¨ <code>pretest</code> å‘½ä»¤ï¼Œå¦‚æœæœ‰ï¼Œå…ˆæ‰§è¡Œè¯¥å‘½ä»¤ï¼›</li> <li>æ£€æŸ¥æ˜¯å¦æœ‰ <code>test</code> å‘½ä»¤ï¼Œæœ‰çš„è¯è¿è¡Œ <code>test</code> å‘½ä»¤ï¼Œæ²¡æœ‰çš„è¯æŠ¥é”™ï¼›</li> <li>æ£€æŸ¥æ˜¯å¦å­˜åœ¨ <code>posttest</code> å‘½ä»¤ï¼Œå¦‚æœæœ‰ï¼Œæ‰§è¡Œ <code>posttest</code> å‘½ä»¤ï¼›</li></ol> <blockquote><p>åˆ°ç›®å‰ä¸ºæ­¢æˆ‘ä»¬æ‰€è¦†ç›–çš„å‰ç«¯å·¥ä½œæµåŒ…å«äº†ä»£ç æ£€æŸ¥å’Œæµ‹è¯•è‡ªåŠ¨åŒ–è¿è¡Œç¯èŠ‚ï¼Œ<strong>è¡¡é‡æµ‹è¯•æ•ˆæœçš„é‡è¦æŒ‡æ ‡æ˜¯æµ‹è¯•è¦†ç›–ç‡</strong>ï¼Œè€Œæ”¶é›†è¦†ç›–ç‡ä¹Ÿéå¸¸çš„ç®€å•ï¼Œ<strong>ä¸‹é¢é€æ­¥è®²è§£å¦‚ä½•æŠŠä»£ç æ£€æŸ¥ã€æµ‹è¯•è¿è¡Œã€è¦†ç›–ç‡æ”¶é›†è¿™äº›æ­¥éª¤ä¸²èµ·æ¥</strong>ã€‚</p></blockquote> <h3 id="æ”¹é€ -test-å‘½ä»¤"><a href="#æ”¹é€ -test-å‘½ä»¤" class="header-anchor">#</a> æ”¹é€  test å‘½ä»¤</h3> <p>é¦–å…ˆï¼Œæˆ‘ä»¬åŸºäºé’©å­æœºåˆ¶å¯¹ç°æœ‰çš„ <code>scripts</code> åšä»¥ä¸‹ 3 ç‚¹é‡æ„ï¼ŒæŠŠä»£ç æ£€æŸ¥å’Œæµ‹è¯•è¿è¡Œä¸²èµ·æ¥ï¼š</p> <ul><li>å¢åŠ ç®€å•çš„ <code>lint</code> å‘½ä»¤ï¼Œå¹¶è¡Œè¿è¡Œæ‰€æœ‰çš„ <code>lint</code> å­å‘½ä»¤ï¼›</li> <li>å¢åŠ  <code>pretest</code> é’©å­ï¼Œåœ¨å…¶ä¸­è¿è¡Œ <code>lint</code> å‘½ä»¤ï¼›</li> <li>æŠŠ <code>test</code> æ›¿æ¢ä¸ºæ›´ç®€å•çš„ <code>mocha tests/</code>ï¼›</li></ul> <p>ä»£ç  <code>diff</code> å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>diff --git a/package.json b/package.json
index 8f67810..d297f2e 100644
--- a/package.json
+++ b/package.json
@@ -4,13 +4,17 @@
+    &quot;lint&quot;: &quot;npm-run-all --parallel lint:*&quot;,
     &quot;lint:js&quot;: &quot;eslint *.js&quot;,
     &quot;lint:js:fix&quot;: &quot;npm run lint:js -- --fix&quot;,
     &quot;lint:css&quot;: &quot;stylelint *.less&quot;,
     &quot;lint:json&quot;: &quot;jsonlint --quiet *.json&quot;,
     &quot;lint:markdown&quot;: &quot;markdownlint --config .markdownlint.json *.md&quot;,
-    &quot;mocha&quot;: &quot;mocha tests/&quot;,
-    &quot;test&quot;: &quot;# è¿è¡Œæ‰€æœ‰ä»£ç æ£€æŸ¥å’Œå•å…ƒæµ‹è¯• \n    npm-run-all --parallel lint:* mocha&quot;
+    &quot;pretest&quot;: &quot;npm run lint&quot;,
+    &quot;test&quot;: &quot;mocha tests/&quot;,
</code></pre></div><blockquote><p>å½“æˆ‘ä»¬è¿è¡Œ <code>npm test</code> çš„æ—¶å€™ï¼Œä¼šå…ˆè‡ªåŠ¨æ‰§è¡Œ <code>pretest</code> é‡Œé¢çš„ <code>lint</code>ï¼Œå®é™…è¾“å‡ºå¦‚ä¸‹ï¼š</p></blockquote> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/12.png" alt=""></p> <h3 id="å¢åŠ è¦†ç›–ç‡æ”¶é›†"><a href="#å¢åŠ è¦†ç›–ç‡æ”¶é›†" class="header-anchor">#</a> å¢åŠ è¦†ç›–ç‡æ”¶é›†</h3> <blockquote><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æŠŠè¿è¡Œæµ‹è¯•å’Œè¦†ç›–ç‡æ”¶é›†ä¸²èµ·æ¥ï¼Œå…·ä½“åšæ³•æ˜¯ï¼šå¢åŠ è¦†ç›–ç‡æ”¶é›†çš„å‘½ä»¤ï¼Œå¹¶ä¸”è¦†ç›–ç‡æ”¶é›†å®Œæ¯•ä¹‹åè‡ªåŠ¨æ‰“å¼€ <code>html</code> ç‰ˆæœ¬çš„è¦†ç›–ç‡æŠ¥å‘Šã€‚è¦å®ç°ç›®æ ‡ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥ä¸¤ä¸ªæ–°å·¥å…·ï¼š</p></blockquote> <ol><li>è¦†ç›–ç‡æ”¶é›†å·¥å…· <a href="https://github.com/istanbuljs/nyc" target="_blank" rel="noopener noreferrer">nyc<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œæ˜¯è¦†ç›–ç‡æ”¶é›†å·¥å…· <a href="https://istanbul.js.org" target="_blank" rel="noopener noreferrer">istanbul<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> çš„å‘½ä»¤è¡Œç‰ˆæœ¬ï¼Œ<code>istanbul</code> æ”¯æŒç”Ÿæˆå„ç§æ ¼å¼çš„è¦†ç›–ç‡æŠ¥å‘Šï¼Œæˆ‘å·²ç»ä½¿ç”¨å¤šå¹´ï¼›</li> <li>æ‰“å¼€ <code>html</code> æ–‡ä»¶çš„å·¥å…· <a href="https://github.com/sindresorhus/opn-cli" target="_blank" rel="noopener noreferrer">opn-cli<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œæ˜¯èƒ½å¤Ÿæ‰“å¼€ä»»æ„ç¨‹åºçš„å·¥å…· <a href="https://github.com/sindresorhus/opn" target="_blank" rel="noopener noreferrer">opn<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> çš„å‘½ä»¤è¡Œç‰ˆæœ¬ï¼Œä½œè€…æ˜¯å‰ç«¯ç¤¾åŒºéå¸¸é«˜äº§çš„ <a href="https://github.com/sindresorhus" target="_blank" rel="noopener noreferrer">Sindre Sorhus<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œå®ƒåœ¨ npm ä¸Šå‘å¸ƒäº†è¶…è¿‡ 1000 ä¸ªåŒ…ï¼Œå¹¶ä¸”è´¨é‡éƒ½å¾ˆä¸é”™ã€‚</li></ol> <p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å®‰è£…ä¾èµ–ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>npm i nyc opn-cli -D
</code></pre></div><blockquote><p>ç„¶ååœ¨ <code>package.json</code> å¢åŠ  <code>nyc</code> çš„é…ç½®ï¼Œå‘Šè¯‰ <code>nyc</code> è¯¥å¿½ç•¥å“ªäº›æ–‡ä»¶ã€‚æœ€åæ˜¯åœ¨ <code>scripts</code> ä¸­æ–°å¢ 3 æ¡å‘½ä»¤ï¼š</p></blockquote> <ol><li><code>precover</code>ï¼Œæ”¶é›†è¦†ç›–ç‡ä¹‹å‰æŠŠä¹‹å‰çš„è¦†ç›–ç‡æŠ¥å‘Šç›®å½•æ¸…ç†æ‰ï¼›</li> <li><code>cover</code>ï¼Œç›´æ¥è°ƒç”¨ <code>nyc</code>ï¼Œè®©å…¶ç”Ÿæˆ <code>html</code> æ ¼å¼çš„è¦†ç›–ç‡æŠ¥å‘Šï¼›</li> <li><code>postcover</code>ï¼Œæ¸…ç†æ‰ä¸´æ—¶æ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨æµè§ˆå™¨ä¸­é¢„è§ˆè¦†ç›–ç‡æŠ¥å‘Šï¼›</li></ol> <p>å…·ä½“ <code>diff</code> å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>diff --git a/package.json b/package.json
index 8f67810..d297f2e 100644
--- a/package.json
+++ b/package.json
@@ -4,13 +4,17 @@
   scripts: {
+    &quot;precover&quot;: &quot;rm -rf coverage&quot;,
+    &quot;cover&quot;: &quot;nyc --reporter=html npm test&quot;,
+    &quot;postcover&quot;: &quot;rm -rf .nyc_output &amp;&amp; opn coverage/index.html&quot;
   },
@@ -22,7 +26,15 @@
   &quot;devDependencies&quot;: {
     &quot;npm-run-all&quot;: &quot;^4.1.2&quot;,
+    &quot;nyc&quot;: &quot;^11.3.0&quot;,
+    &quot;opn-cli&quot;: &quot;^3.1.0&quot;,
     &quot;stylelint&quot;: &quot;^8.2.0&quot;,
     &quot;stylelint-config-standard&quot;: &quot;^17.0.0&quot;
+  },
+  &quot;nyc&quot;: {
+    &quot;exclude&quot;: [
+      &quot;**/*.spec.js&quot;,
+      &quot;.*.js&quot;
+    ]
   }
 }
</code></pre></div><blockquote><p>æ”¹å®Œä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è¿è¡Œ <code>npm run cover</code>ï¼Œè¿è¡Œçš„è¯¦ç»†æˆªå›¾å¦‚ä¸‹ï¼š</p></blockquote> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/13.png" alt=""></p> <blockquote><p><strong>TIP#7</strong>ï¼šåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çš„å·¥ä½œæµä¸­å·²ç»åŒ…å«ä»£ç æ£€æŸ¥ã€æµ‹è¯•è¿è¡Œã€è¦†ç›–ç‡æ”¶é›†ã€è¦†ç›–ç‡æŸ¥çœ‹ç­‰åŠŸèƒ½ï¼Œä½ æ˜¯ä¸æ˜¯å¯ä»¥ç”¨æ¥æ”¹è¿›ä¸‹è‡ªå·±çš„å·¥ä½œæµå‘¢ï¼Ÿ</p></blockquote> <blockquote><p>æœ¬èŠ‚ç”¨åˆ°çš„ä»£ç è§ <a href="https://github.com/wangshijun/automated-workflow-with-npm-script/tree/04-pre-and-post-hooks" target="_blank" rel="noopener noreferrer">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œæƒ³è¾¹çœ‹è¾¹åŠ¨æ‰‹ç»ƒä¹ çš„åŒå­¦å¯ä»¥æ‹‰ä¸‹æ¥è‡ªå·±æ”¹ï¼Œæ³¨æ„åˆ‡æ¢åˆ°æ­£ç¡®çš„åˆ†æ”¯ <code>04-pre-and-post-hooks</code>ã€‚</p></blockquote> <h2 id="_5-åœ¨-npm-script-ä¸­ä½¿ç”¨å˜é‡"><a href="#_5-åœ¨-npm-script-ä¸­ä½¿ç”¨å˜é‡" class="header-anchor">#</a> 5 åœ¨ npm script ä¸­ä½¿ç”¨å˜é‡</h2> <blockquote><p><code>npm</code> ä¸ºåŠ é«˜æ•ˆçš„æ‰§è¡Œ <code>npm script</code> åšäº†å¤§é‡çš„ä¼˜åŒ–ï¼Œ<a href="https://juejin.im/book/5a1212bc51882531ea64df07/section/5a1213d4f265da4335625b4a" target="_blank" rel="noopener noreferrer">åˆ›å»ºå¹¶è¿è¡Œ npm script å‘½ä»¤<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> é‡Œé¢è®²åˆ°çš„ç¯å¢ƒå˜é‡ç‰¹æ€§èƒ½è®©æˆ‘ä»¬åœ¨ npm script ä¸­ç›´æ¥è°ƒç”¨ä¾èµ–åŒ…é‡Œçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ›´å¼ºå¤§çš„æ˜¯ï¼Œnpm è¿˜æä¾›äº† <code>$PATH</code> ä¹‹å¤–çš„æ›´å¤šçš„å˜é‡ï¼Œæ¯”å¦‚å½“å‰æ­£åœ¨æ‰§è¡Œçš„å‘½ä»¤ã€åŒ…çš„åç§°å’Œç‰ˆæœ¬å·ã€æ—¥å¿—è¾“å‡ºçš„çº§åˆ«ç­‰ã€‚</p></blockquote> <p>DRYï¼ˆDon't Repeat Yourselfï¼‰æ˜¯åŸºæœ¬çš„ç¼–ç¨‹åŸåˆ™ï¼Œåœ¨ <code>npm script</code> ä¸­ä½¿ç”¨é¢„å®šä¹‰å˜é‡å’Œè‡ªå®šä¹‰å˜é‡è®©æˆ‘ä»¬æ›´å®¹æ˜“éµä» DRY åŸåˆ™ï¼Œå› ä¸ºä½¿ç”¨è¿™äº›å˜é‡ä¹‹åï¼Œ<code>npm script</code> å°±å…·å¤‡äº†è‡ªé€‚åº”çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠç§¯ç´¯èµ·æ¥çš„ <code>npm script</code> ä½¿ç”¨åˆ°å…¶ä»–é¡¹ç›®é‡Œé¢ï¼Œè€Œä¸ç”¨åšä»»ä½•ä¿®æ”¹ã€‚</p> <h3 id="ä½¿ç”¨é¢„å®šä¹‰å˜é‡"><a href="#ä½¿ç”¨é¢„å®šä¹‰å˜é‡" class="header-anchor">#</a> ä½¿ç”¨é¢„å®šä¹‰å˜é‡</h3> <blockquote><p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹é¢„å®šä¹‰å˜é‡ï¼Œé€šè¿‡è¿è¡Œ <code>npm run env</code> å°±èƒ½æ‹¿åˆ°å®Œæ•´çš„å˜é‡åˆ—è¡¨ï¼Œè¿™ä¸ªåˆ—è¡¨éå¸¸é•¿ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨ <code>npm run env | grep npm_package | sort</code> æ‹¿åˆ°éƒ¨åˆ†æ’åºåçš„é¢„å®šä¹‰ç¯å¢ƒå˜é‡ï¼š</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>// ä½œè€…ä¿¡æ¯...
npm_package_author_email=wangshijun2010@gmail.com
npm_package_author_name=wangshijun
npm_package_author_url=http://github.com/wangshijun
// ä¾èµ–ä¿¡æ¯...
npm_package_devDependencies_markdownlint_cli=^0.5.0
npm_package_devDependencies_mocha=^4.0.1
npm_package_devDependencies_npm_run_all=^4.1.2
// å„ç§ npm script
npm_package_scripts_lint=npm-run-all --parallel lint:*
npm_package_scripts_lint_css=stylelint *.less
npm_package_scripts_lint_js=eslint *.js
npm_package_scripts_lint_js_fix=npm run lint:js -- --fix
npm_package_scripts_lint_json=jsonlint --quiet *.json
// åŸºæœ¬ä¿¡æ¯
npm_package_version=0.1.0
npm_package_gitHead=3796e548cfe406ec33ab837ac00bcbd6ee8a38a0
npm_package_license=MIT
npm_package_main=index.js
npm_package_name=hello-npm-script
npm_package_readmeFilename=README.md
// ä¾èµ–çš„é…ç½®
npm_package_nyc_exclude_0=**/*.spec.js
npm_package_nyc_exclude_1=.*.js
</code></pre></div><p>å˜é‡çš„ä½¿ç”¨æ–¹æ³•éµå¾ª <code>shell</code> é‡Œé¢çš„è¯­æ³•ï¼Œç›´æ¥åœ¨ <code>npm script</code> ç»™æƒ³è¦å¼•ç”¨çš„å˜é‡å‰é¢åŠ ä¸Š <code>$</code> ç¬¦å·å³å¯ã€‚æ¯”å¦‚ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;dummy&quot;: &quot;echo $npm_package_name&quot;
}
</code></pre></div><p>å›åˆ°æˆ‘ä»¬çš„é¡¹ç›®ï¼Œæµ‹è¯•è¦†ç›–ç‡å½’æ¡£æ˜¯æ¯”è¾ƒå¸¸è§çš„éœ€æ±‚ï¼Œå› ä¸ºå®ƒæ–¹ä¾¿æˆ‘ä»¬è¿½è¸ªè¦†ç›–ç‡çš„å˜åŒ–è¶‹åŠ¿ï¼Œæœ€å½»åº•çš„åšæ³•æ˜¯å½’æ¡£åˆ° CI ç³»ç»Ÿé‡Œé¢ï¼Œå¯¹äºç®€å•é¡¹ç›®ï¼Œåˆ™å¯ä»¥ç›´æ¥å½’æ¡£åˆ°æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œå³æŠŠæ”¶é›†åˆ°çš„è¦†ç›–ç‡æŠ¥å‘ŠæŒ‰ç‰ˆæœ¬å·å»å­˜æ”¾ã€‚</p> <p>æ¯”å¦‚ï¼Œæˆ‘ä»¬åœ¨æ ¹ç›®å½•ä¸‹æ–°å»º <code>coverage\_archive</code> ç›®å½•å­˜å‚¨è¦†ç›–ç‡å½’æ¡£ï¼Œå¹¶åˆ©ç”¨å˜é‡æœºåˆ¶æŠŠå½’æ¡£å’Œç‰ˆæœ¬å·å…³è”èµ·æ¥ã€‚å…·ä½“çš„ <code>npm script</code> ä¿®æ”¹å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>diff --git a/package.json b/package.json
index d297f2e..d86f65c 100644
--- a/package.json
+++ b/package.json
@@ -12,9 +12,10 @@
   &quot;scripts&quot;: {
-    &quot;precover&quot;: &quot;rm -rf coverage&quot;,
     &quot;cover&quot;: &quot;nyc --reporter=html npm test&quot;,
-    &quot;postcover&quot;: &quot;rm -rf .nyc_output &amp;&amp; opn coverage/index.html&quot;
+    &quot;cover:cleanup&quot;: &quot;rm -rf coverage &amp;&amp; rm -rf .nyc_output&quot;,
+    &quot;cover:archive&quot;: &quot;mkdir -p coverage_archive/$npm_package_version &amp;&amp; cp -r coverage/* coverage_archive/$npm_package_version&quot;,
+    &quot;postcover&quot;: &quot;npm run cover:archive &amp;&amp; npm run cover:cleanup &amp;&amp; opn coverage_archive/$npm_package_version/index.html&quot;
   },
</code></pre></div><blockquote><p>ä¸»è¦æ”¹åŠ¨æ˜¯ï¼šå¢åŠ  <code>cover:cleanup</code> å’Œ <code>cover:archive</code>å‘½ä»¤ï¼Œå¹¶ä¸”ä¿®æ”¹ <code>postcover</code> å‘½ä»¤ã€‚ä¸‹é¢å¯¹ä½¿ç”¨äº†ç¯å¢ƒå˜é‡çš„ <code>npm script</code> ç¨ä½œè§£é‡Šï¼š</p></blockquote> <p><strong>cover:archive åšäº† 2 ä»¶äº‹æƒ…ï¼š</strong></p> <ol><li><code>mkdir -p coverage_archive/$npm_package_version</code> å‡†å¤‡å½“å‰ç‰ˆæœ¬å·çš„å½’æ¡£ç›®å½•ï¼›</li> <li><code>cp -r coverage/* coverage_archive/$npm_package_version</code>ï¼Œç›´æ¥å¤åˆ¶æ–‡ä»¶æ¥å½’æ¡£ï¼›</li></ol> <p><strong>è€Œ postcover åšäº† 3 ä»¶äº‹æƒ…ï¼š</strong></p> <ol><li><code>npm run cover:archive</code>ï¼Œå½’æ¡£æœ¬æ¬¡è¦†ç›–ç‡æŠ¥å‘Šï¼›</li> <li><code>npm run cover:cleanup</code>ï¼Œæ¸…ç†æœ¬æ¬¡è¦†ç›–ç‡æŠ¥å‘Šï¼›</li> <li><code>opn coverage_archive/$npm_package_version/index.html</code>ï¼Œç›´æ¥é¢„è§ˆè¦†ç›–ç‡æŠ¥å‘Šï¼›</li></ol> <p>é…ç½®å¥½ä¹‹åï¼Œæˆ‘ä»¬ç›´æ¥è¿è¡Œ <code>npm run cover</code>ï¼Œæœ€åçš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/14.png" alt=""></p> <h3 id="ä½¿ç”¨è‡ªå®šä¹‰å˜é‡"><a href="#ä½¿ç”¨è‡ªå®šä¹‰å˜é‡" class="header-anchor">#</a> ä½¿ç”¨è‡ªå®šä¹‰å˜é‡</h3> <ul><li>é™¤äº†é¢„å®šä¹‰å˜é‡å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åœ¨ <code>package.json</code> ä¸­æ·»åŠ è‡ªå®šä¹‰å˜é‡ï¼Œå¹¶ä¸”åœ¨ <code>npm script</code> ä¸­ä½¿ç”¨è¿™äº›å˜é‡ã€‚</li> <li>ä¸ºæŠŠæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Šåˆ†äº«ç»™å…¶ä»–åŒäº‹æµè§ˆï¼Œæˆ‘ä»¬å°±ä¸èƒ½ä½¿ç”¨ <code>opn-cli</code> æ‰“å¼€æ–‡ä»¶äº†ï¼Œéœ€è¦å¯åŠ¨ç®€å•çš„ <code>http</code> æœåŠ¡ï¼ŒæŠŠç½‘å€å‘ç»™åˆ«äººæµè§ˆï¼Œæ¯”å¦‚æˆ‘ä»¬çº¦å®šç½‘å€ <code>http://IP:3000</code>ï¼Œè¿™é‡Œçš„ <code>IP</code> éœ€è¦æ›¿æ¢æˆè‡ªå·±çš„å®é™… <code>IP</code>ã€‚</li></ul> <p><a href="https://www.npmjs.com/package/http-server" target="_blank" rel="noopener noreferrer">http-server<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æä¾›äº†éå¸¸è½»é‡çš„ http æœåŠ¡ï¼Œæˆ‘ä»¬å…ˆæŠŠå®ƒåŠ åˆ° devDependencies ä¸­ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>npm i http-server -D    # ç­‰ä»·å‘½ä»¤ npm install http-server --save-dev
</code></pre></div><p>æ¥ä¸‹æ¥ï¼Œåœ¨ <code>package.json</code> å¢åŠ è‡ªå®šä¹‰ç«¯å£é…ç½®å’Œç›¸åº”çš„ <code>npm script</code> å‘½ä»¤ï¼Œå®Œæ•´çš„ <code>diff</code> å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>diff --git a/package.json b/package.json
index d86f65c..abc9d01 100644
--- a/package.json
+++ b/package.json
@@ -3,6 +3,9 @@
   &quot;version&quot;: &quot;0.1.0&quot;,
+  &quot;config&quot;: {
+    &quot;port&quot;: 3000
+  },
   &quot;scripts&quot;: {
@@ -15,7 +18,9 @@
     &quot;cover&quot;: &quot;nyc --reporter=html npm test&quot;,
-    &quot;postcover&quot;: &quot;npm run cover:archive &amp;&amp; npm run cover:cleanup &amp;&amp; opn coverage_archive/$npm_package_version/index.html&quot;
+    &quot;cover:serve&quot;: &quot;http-server coverage_archive/$npm_package_version -p $npm_package_config_port&quot;,
+    &quot;cover:open&quot;: &quot;opn http://localhost:$npm_package_config_port&quot;,
+    &quot;postcover&quot;: &quot;npm-run-all cover:archive cover:cleanup --parallel cover:serve cover:open&quot;
   },
@@ -23,6 +28,7 @@
   &quot;devDependencies&quot;: {
     &quot;chai&quot;: &quot;^4.1.2&quot;,
+    &quot;http-server&quot;: &quot;^0.10.0&quot;,
     &quot;mocha&quot;: &quot;^4.0.1&quot;,
</code></pre></div><p><strong>å…³äºæ”¹åŠ¨åšä»¥ä¸‹å‡ ç‚¹è§£é‡Šï¼š</strong></p> <ul><li>æ–°å¢çš„å‘½ä»¤ <code>cover:serve</code> ä¸­åŒæ—¶ä½¿ç”¨äº†é¢„å®šä¹‰å˜é‡ <code>$npm_package_version</code> å’Œè‡ªå®šä¹‰å˜é‡ <code>$npm_package_config_port</code>ï¼›</li> <li>é¢„è§ˆè¦†ç›–ç‡æŠ¥å‘Šçš„æ–¹å¼ä»ç›´æ¥æ‰“å¼€æ–‡ä»¶ä¿®æ”¹ä¸ºæ‰“å¼€ç½‘å€ï¼š <code>http://localhost:$npm_package_config_port</code>ï¼›</li> <li><code>postcover</code> å‘½ä»¤è¦åšçš„äº‹æƒ…æ¯”è¾ƒå¤šï¼Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨ <code>npm-run-all</code> æ¥ç¼–æ’å­å‘½ä»¤ã€‚</li></ul> <blockquote><p><strong>TIP#8</strong>ï¼šæ³¨æ„è¿™é‡Œç»™ <code>cover:serve</code> å’Œ <code>cover:open</code> å¢åŠ äº†å¹¶è¡Œå‚æ•° <code>--parallel</code>ï¼Œå› ä¸º <code>cover:serve</code> ä¸ä¼šè‡ªåŠ¨é€€å‡ºã€‚</p> <p><strong>TIP#9</strong>ï¼šå¯èƒ½æœ‰åŒå­¦ä¼šå¥½å¥‡ï¼Œæ˜¯å¦å¯ä»¥åœ¨è‡ªå®šä¹‰å˜é‡çš„å£°æ˜ä¸­ä½¿ç”¨é¢„å®šä¹‰å˜é‡ï¼Œç¬”è€…ä¹Ÿæœ‰è¿™ç§å¥½å¥‡ï¼Œå¹¶ä¸”åšè¿‡å°è¯•ï¼Œç»“æœæ˜¯ä¸æ”¯æŒã€‚</p></blockquote> <p>ä¿®æ”¹å®Œä¹‹åï¼Œæˆ‘ä»¬å†æ¬¡è¿è¡Œ <code>npm run cover</code>ï¼Œç»ˆç«¯ä¼šåœ¨ <code>cover:serve</code> ä¹‹åè¿›å…¥ç­‰å¾…çŠ¶æ€ï¼š</p> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/15.png" alt=""></p> <p>åŒæ—¶æµè§ˆå™¨ä¼šæ‰“å¼€è¦†ç›–ç‡æŠ¥å‘Šï¼Œå¦‚ä¸‹å›¾ï¼š</p> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/16.png" alt=""></p> <p><strong>å¥½ï¼Œå…³äº npm script é‡Œé¢çš„å˜é‡ä½¿ç”¨å°±ä»‹ç»åˆ°è¿™é‡Œï¼Œç•™ç»™ä½ çš„é—®é¢˜æ˜¯ï¼Œåœ¨ä½ çš„é¡¹ç›®é‡Œé¢æ€ä¹ˆç”¨èµ·æ¥å‘¢ï¼Ÿå¦‚æœæƒ³åˆ°äº†ï¼Œä»€ä¹ˆæ—¶å€™è½åœ°ï¼Ÿ</strong></p> <blockquote><p>æœ¬èŠ‚ç”¨åˆ°çš„ä»£ç è§ <a href="https://github.com/wangshijun/automated-workflow-with-npm-script/tree/05-use-config-variables" target="_blank" rel="noopener noreferrer">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œæƒ³è¾¹çœ‹è¾¹åŠ¨æ‰‹ç»ƒä¹ çš„åŒå­¦å¯ä»¥æ‹‰ä¸‹æ¥è‡ªå·±æ”¹ï¼Œæ³¨æ„åˆ‡æ¢åˆ°æ­£ç¡®çš„åˆ†æ”¯ <code>05-use-config-variables</code>ã€‚</p></blockquote> <h2 id="_6-å®ç°å‘½ä»¤è¡Œè‡ªåŠ¨è¡¥å…¨"><a href="#_6-å®ç°å‘½ä»¤è¡Œè‡ªåŠ¨è¡¥å…¨" class="header-anchor">#</a> 6 å®ç°å‘½ä»¤è¡Œè‡ªåŠ¨è¡¥å…¨</h2> <blockquote><p>å½“ <code>npm script</code> é‡Œé¢ç§¯ç´¯çš„å‘½ä»¤è¶Šæ¥è¶Šå¤šæ—¶ï¼Œé‡åº¦å‘½ä»¤è¡Œç”¨æˆ·è‚¯å®šä¼šå¥½å¥‡ï¼Œèƒ½ä¸èƒ½å®ç°ç±»ä¼¼ <code>bash</code>ã€<code>zsh</code> é‡Œé¢çš„å‘½ä»¤è‡ªåŠ¨è¡¥å…¨ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œä¸‹é¢æ¥é€ä¸€ä»‹ç»ã€‚</p></blockquote> <h3 id="ä½¿ç”¨-npm-run-ç›´æ¥åˆ—å‡º"><a href="#ä½¿ç”¨-npm-run-ç›´æ¥åˆ—å‡º" class="header-anchor">#</a> ä½¿ç”¨ npm run ç›´æ¥åˆ—å‡º</h3> <blockquote><p>ä¸å¸¦ä»»ä½•å‚æ•°è¿è¡Œ <code>npm run</code> èƒ½åˆ—å‡º <code>scripts</code> å¯¹è±¡ä¸­å®šä¹‰çš„æ‰€æœ‰å‘½ä»¤ï¼Œå†ç»“åˆç®¡é“æ“ä½œç¬¦ã€<code>less</code> å‘½ä»¤ï¼ˆè¿™é‡Œçš„ <code>less</code> ä¸æ˜¯ <code>css</code> é¢†åŸŸçš„ <code>less</code>ï¼Œè€Œæ˜¯ <code>linux</code> é‡Œé¢çš„å·¥å…·ï¼‰ï¼Œå³ä½¿ <code>scripts</code> å­å‘½ä»¤å¾ˆå¤šæˆ‘ä»¬ä¹Ÿèƒ½ç§»åŠ¨è‡ªå¦‚ã€‚</p></blockquote> <blockquote><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬åœ¨é¡¹ç›®ä¸­æ‰§è¡Œï¼š<code>npm run | less</code>ï¼Œå¾—åˆ°å¦‚ä¸‹ç»“æœï¼Œæ³¨æ„æˆªå›¾å·¦ä¸‹æ–¹çš„çº¢æ¡†ï¼ŒæŒ‰ç©ºæ ¼èƒ½ç¿»é¡µï¼š</p></blockquote> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/17.png" alt=""></p> <p>åœ¨è¿™ä¸ªç»“æœé‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œç±»ä¼¼äº Vim ä¸­çš„æœç´¢ï¼Œå…ˆæŒ‰ <code>/</code> è¿›å…¥æœç´¢æ¨¡å¼ï¼Œç„¶åè¾“å…¥ <code>markdown</code>ï¼Œæœç´¢ç»“æœå¦‚ä¸‹å›¾ï¼š</p> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/18.png" alt=""></p> <h3 id="æŠŠ-npm-completion-é›†æˆåˆ°-shell-ä¸­"><a href="#æŠŠ-npm-completion-é›†æˆåˆ°-shell-ä¸­" class="header-anchor">#</a> æŠŠ npm completion é›†æˆåˆ° shell ä¸­</h3> <p>npm è‡ªèº«æä¾›äº†è‡ªåŠ¨å®Œæˆå·¥å…· <a href="https://docs.npmjs.com/cli/completion" target="_blank" rel="noopener noreferrer">completion<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œå°†å…¶é›†æˆåˆ° <a href="https://www.gnu.org/software/bash" target="_blank" rel="noopener noreferrer">bash<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æˆ–è€… <a href="https://github.com/robbyrussell/oh-my-zsh" target="_blank" rel="noopener noreferrer">zsh<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> é‡Œä¹Ÿéå¸¸å®¹æ˜“ï¼ˆé¡ºä¾¿è¯´ä¸€å¥ï¼Œæ—©æœŸæˆ‘æ˜¯ bash çš„å¿ å®ç”¨æˆ·ï¼Œä¸¤å¹´å‰åˆ‡æ¢åˆ° zshï¼Œå°±å†ä¹Ÿæ²¡å›å¤´ï¼‰ã€‚</p> <p>å®˜æ–¹æ–‡æ¡£é‡Œé¢çš„é›†æˆæ–¹æ³•å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>npm completion &gt;&gt; ~/.bashrc
npm completion &gt;&gt; ~/.zshrc
</code></pre></div><blockquote><p><strong>TIP#10</strong>ï¼šå¦‚æœä½ å¥½å¥‡ä¸Šé¢çš„å‘½ä»¤ç©¶ç«Ÿåšäº†ä»€ä¹ˆï¼Œå°è¯•ç›´æ¥è¿è¡Œ <code>npm completion</code>ï¼Œå°±èƒ½çœ‹åˆ°å®ƒå…¶å®åœ¨ä½ çš„é…ç½®æ–‡ä»¶ä¸­è¿½åŠ äº†ä¸€å¤§å¨ shellã€‚ä¸Šé¢å‘½ä»¤ä¸­çš„ <code>&gt;&gt;</code> æ„æ€æ˜¯æŠŠå‰é¢å‘½ä»¤çš„è¾“å‡ºè¿½åŠ åˆ°åé¢çš„æ–‡ä»¶ä¸­ã€‚</p></blockquote> <blockquote><p>å¦‚æœä½ ä¹Ÿæœ‰ä»£ç æ´ç™–ï¼Œä¸ºäº†ä¿æŒ .<code>zshrc</code> æˆ–è€… <code>.bashrc</code> æ–‡ä»¶çš„æ•´æ´ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„æ–¹æ³•ï¼š</p></blockquote> <p><strong>ç¬¬ 1 æ­¥ï¼ŒæŠŠ npm completion äº§ç”Ÿçš„é‚£å¨å‘½ä»¤æ”¾åœ¨å•ç‹¬çš„æ–‡ä»¶ä¸­ï¼š</strong></p> <div class="language- extra-class"><pre class="language-text"><code>npm completion &gt;&gt; ~/.npm-completion.bash

</code></pre></div><p><strong>ç¬¬ 2 æ­¥ï¼Œåœ¨ .bashrc æˆ–è€… .zshrc ä¸­å¼•å…¥è¿™ä¸ªæ–‡ä»¶ï¼š</strong></p> <div class="language- extra-class"><pre class="language-text"><code>echo &quot;[ -f ~/.npm-completion.bash ] &amp;&amp; source ~/.npm-completion.bash;&quot; &gt;&gt; ~/.bashrc
echo &quot;[ -f ~/.npm-completion.bash ] &amp;&amp; source ~/.npm-completion.bash;&quot; &gt;&gt; ~/.zshrc

</code></pre></div><blockquote><p><strong>TIP#11</strong>ï¼šæ‰§è¡Œå®Œä¸Šé¢çš„å‘½ä»¤ä¸€å®šè¦è®°å¾— <code>source ~/.zshrc</code> æˆ–è€… <code>source ~/.bashrc</code>ï¼Œæ¥è®©è‡ªåŠ¨å®Œæˆç”Ÿæ•ˆã€‚</p></blockquote> <blockquote><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥å°½æƒ…äº«å—è‡ªåŠ¨å®Œæˆå¸¦æ¥çš„ä¾¿åˆ©äº†ï¼Œå°è¯•åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ <code>npm run</code>ï¼Œ<strong>ç„¶åé”®å…¥ç©ºæ ¼ï¼ˆç©ºæ ¼å¾ˆé‡è¦ï¼‰</strong>ï¼Œç„¶åé”®å…¥ tab é”®ï¼Œå‘ç°å‘½ä»¤è¡Œæœ‰ä»€ä¹ˆååº”äº†ä¹ˆï¼Ÿåœ¨åˆ—å‡ºå¤‡é€‰é¡¹ä¹‹åï¼Œç»§ç»­æŒ‰ tabï¼Œå°±èƒ½åœ¨ä¸åŒçš„é€‰é¡¹ä¹‹é—´åˆ‡æ¢ï¼Œæ‰¾åˆ°è‡ªå·±æƒ³è¦çš„ï¼Œç›´æ¥å›è½¦å°±èƒ½å®Œæˆå‘½ä»¤è¡¥å…¨ã€‚å¤šç»ƒä¹ å‡ æ¬¡ï¼Œä½ çš„æ‰‹æŒ‡å’Œå¤§è„‘å°±èƒ½ç†Ÿç»ƒæŒæ¡è¿™ä¸ªè¿‡ç¨‹ã€‚</p></blockquote> <ul><li>åœ¨æˆ‘ä»¬çš„é¡¹ç›®ç›®å½•é‡Œé¢é”®å…¥ <code>npm run cov</code> å†é”®å…¥ tab é”®ï¼Œå‘½ä»¤è¡Œåˆæœ‰ä»€ä¹ˆååº”ï¼Ÿ</li> <li>éœ€è¦å•ç‹¬è¯´æ˜çš„æ˜¯ï¼Œ<code>npm completion</code> èƒ½å®ç°çš„è‡ªåŠ¨å®Œæˆä¸ä»…ä»…æ˜¯ <code>scripts</code> é‡Œé¢çš„å­è‡ªå‘½ä»¤ï¼Œ<code>npm</code> çš„å­å‘½ä»¤ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œå¯ä»¥ä¾æ¬¡è¾“å…¥ <code>npm</code>ã€ç©ºæ ¼ã€<code>tab</code>ï¼Œçœ‹çœ‹å‘½ä»¤è¡Œçš„ååº”ã€‚</li></ul> <h3 id="æ›´é«˜çº§çš„è‡ªåŠ¨å®Œæˆ"><a href="#æ›´é«˜çº§çš„è‡ªåŠ¨å®Œæˆ" class="header-anchor">#</a> æ›´é«˜çº§çš„è‡ªåŠ¨å®Œæˆ</h3> <ul><li>äººç±»å¯¹äºæ•ˆç‡çš„è¿½æ±‚æ˜¯æ°¸æ— æ­¢å¢ƒçš„ï¼Œå·¥ç¨‹å¸ˆæ›´æ˜¯å¦‚æ­¤ï¼Œnpm å‘½ä»¤è¡¥å…¨åˆ°ç›®å‰ä¸ºæ­¢æ˜¾ç„¶è¿˜ä¸å¤Ÿé«˜æ•ˆï¼Œèƒ½ä¸èƒ½è¡¥å…¨ <code>package.json</code> é‡Œé¢çš„ä¾èµ–åç§°ï¼Ÿèƒ½ä¸èƒ½åœ¨è¡¥å…¨ <code>npm script</code> çš„æ—¶å€™åˆ—å‡ºè¿™ä¸ªå‘½ä»¤æ˜¯å¹²å•¥çš„ï¼Ÿ</li> <li>æœ‰äººå·²ç»å¸®æˆ‘ä»¬è§£å†³äº†è¿™ä¸ªç—›ç‚¹ï¼Œè¿˜å†™æˆäº† <code>zsh</code> æ’ä»¶ï¼ˆbash çš„åŒå­¦æ— ç¦æ¶ˆå—äº†ï¼‰ï¼š<a href="https://github.com/lukechilds/zsh-better-npm-completion" target="_blank" rel="noopener noreferrer">zsh-better-npm-completion<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œå®ƒæœ‰ä»¥ä¸‹å‡ ä¸ªè®©äººæ— æ³•æ‹’ç»çš„ä¾¿åˆ©ï¼š</li></ul> <p><strong>1. åœ¨ npm install æ—¶è‡ªåŠ¨æ ¹æ®å†å²å®‰è£…è¿‡çš„åŒ…ç»™å‡ºè¡¥å…¨å»ºè®®</strong></p> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/19.png" alt=""></p> <p><strong>2. åœ¨ npm uninstall æ—¶å€™æ ¹æ® package.json é‡Œé¢çš„å£°æ˜ç»™å‡ºè¡¥å…¨å»ºè®®</strong></p> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/20.png" alt=""></p> <p><strong>3. åœ¨ npm run æ—¶è¡¥å…¨å»ºè®®ä¸­åˆ—å‡ºå‘½ä»¤ç»†èŠ‚</strong></p> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/21.png" alt=""> <img src="https://poetries1.gitee.io/img-repo/2020/07/npm/22.png" alt=""></p> <p>çœ‹åˆ°è¿™é‡Œï¼Œæ˜¯ä¸æ˜¯å¿ƒç—’ç—’ï¼Ÿå…·ä½“çš„å®‰è£…æ–¹æ³•å‚ç…§å®˜æ–¹ <a href="https://github.com/lukechilds/zsh-better-npm-completion" target="_blank" rel="noopener noreferrer">README.md<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æ–‡ä»¶å°±å¥½ï¼Œæˆ‘å°±ä¸åœ¨è¿™é‡Œå•°å—¦äº†ã€‚</p> <blockquote><p><strong>TIP#12</strong>ï¼šå¦‚æœä½ è¦ä½¿ç”¨ <code>zsh-better-npm-completion</code> æ’ä»¶ï¼Œéœ€è¦æŠŠ <code>.bashrc</code>ã€<code>.zshrc</code> æ–‡ä»¶é‡Œé¢ <code>npm completion</code> éƒ¨åˆ†çš„é…ç½®åˆ æ‰ï¼Œé¿å…å†²çªã€‚</p></blockquote> <h3 id="å¦‚ä½•å®ç°-yarn-çš„å‘½ä»¤è‡ªåŠ¨è¡¥å…¨ï¼Ÿ"><a href="#å¦‚ä½•å®ç°-yarn-çš„å‘½ä»¤è‡ªåŠ¨è¡¥å…¨ï¼Ÿ" class="header-anchor">#</a> å¦‚ä½•å®ç° yarn çš„å‘½ä»¤è‡ªåŠ¨è¡¥å…¨ï¼Ÿ</h3> <blockquote><p>å·²ç»æœ‰äººå¸®æˆ‘ä»¬åšå¥½äº† <a href="https://github.com/mklabs/yarn-completions" target="_blank" rel="noopener noreferrer">yarn-completions<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œèƒ½å®ç°ç±»ä¼¼äº zsh-better-npm-completion çš„å‘½ä»¤è¡¥å…¨ï¼Œå‚ç…§å®˜æ–¹ README.md å®‰è£…å³å¯ã€‚</p></blockquote> <h2 id="_7-å®ç°-npm-script-è·¨å¹³å°å…¼å®¹"><a href="#_7-å®ç°-npm-script-è·¨å¹³å°å…¼å®¹" class="header-anchor">#</a> 7 å®ç° npm script è·¨å¹³å°å…¼å®¹</h2> <blockquote><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå¦‚æœä½ åœ¨ Linuxã€Mac å¹³å°åšå¼€å‘ï¼Œæ‰€æœ‰çš„ npm script éƒ½ä¼šé¡ºåˆ©è¿è¡Œï¼Œä½†æ˜¯ Windows ä¸‹é¢çš„åŒå­¦å¯èƒ½å°±æ¯”è¾ƒç—›è‹¦äº†ï¼Œå› ä¸ºä¸æ˜¯æ‰€æœ‰çš„ shell å‘½ä»¤éƒ½æ˜¯è·¨å¹³å°å…¼å®¹çš„ï¼Œç”šè‡³å„ç§å¸¸è§çš„æ–‡ä»¶ç³»ç»Ÿæ“ä½œä¹Ÿæ˜¯ä¸å…¼å®¹çš„ã€‚</p></blockquote> <p>å¯èƒ½æœ‰éƒ¨åˆ†åŒå­¦å¤„ç†è¿‡ <code>npm script</code> è·¨å¹³å°å…¼å®¹çš„é—®é¢˜ï¼Œæ¯”å¦‚ç²—æš´çš„ä¸ºä¸¤ç§å¹³å°å„å†™ä¸€ä»½ <code>npm script</code>ï¼Œåƒä¸‹é¢è¿™æ ·ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;name&quot;: &quot;hello-npm-script&quot;,
  &quot;scripts&quot;: {
    &quot;bash-script&quot;: &quot;echo Hello $npm_package_name&quot;,
    &quot;win-script&quot;: &quot;echo Hello %npm_package_name%&quot;
  }
}

</code></pre></div><p>æœ‰æŠ€æœ¯è¿½æ±‚çš„å·¥ç¨‹å¸ˆè‚¯å®šä¸ä¼šæ»¡è¶³ä¸Šé¢çš„è§£å†³æ–¹æ¡ˆï¼Œå®é™…ä¸Šç¤¾åŒºä¸­å·²ç»æœ‰éå¸¸å¤šçš„å°å·¥å…·å¯ä»¥å¸®æˆ‘ä»¬ä¼˜é›…çš„å®ç°è·¨å¹³å°çš„ npm scriptï¼Œä¸‹é¢æˆ‘ä»¬æ¢ç´¢ä¸‹å¦‚ä½•å®ç°è·¨å¹³å°çš„æ–‡ä»¶ç³»ç»Ÿæ“ä½œã€å˜é‡å¼•ç”¨ã€ç¯å¢ƒå˜é‡è®¾ç½®ã€‚</p> <p><strong>ç‰¹åˆ«è¯´æ˜ï¼Œwindows ç¯å¢ƒçš„åŒå­¦å»ºè®®ä½¿ç”¨ git bash æ¥è¿è¡Œ npm scriptï¼Œä½¿ç”¨ windows è‡ªå¸¦çš„ cmd å¯èƒ½ä¼šé‡åˆ°æ¯”è¾ƒå¤šçš„é—®é¢˜</strong></p> <h3 id="æ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„è·¨å¹³å°å…¼å®¹"><a href="#æ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„è·¨å¹³å°å…¼å®¹" class="header-anchor">#</a> æ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„è·¨å¹³å°å…¼å®¹</h3> <blockquote><p><code>npm script</code> ä¸­æ¶‰åŠåˆ°çš„æ–‡ä»¶ç³»ç»Ÿæ“ä½œåŒ…æ‹¬æ–‡ä»¶å’Œç›®å½•çš„åˆ›å»ºã€åˆ é™¤ã€ç§»åŠ¨ã€å¤åˆ¶ç­‰æ“ä½œï¼Œè€Œç¤¾åŒºä¸ºè¿™äº›åŸºæœ¬æ“ä½œä¹Ÿæä¾›äº†è·¨å¹³å°å…¼å®¹çš„åŒ…ï¼Œåˆ—ä¸¾å¦‚ä¸‹ï¼š</p></blockquote> <ul><li><a href="https://github.com/isaacs/rimraf" target="_blank" rel="noopener noreferrer">rimraf<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æˆ– <a href="https://www.npmjs.com/package/del-cli" target="_blank" rel="noopener noreferrer">del-cli<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œç”¨æ¥åˆ é™¤æ–‡ä»¶å’Œç›®å½•ï¼Œå®ç°ç±»ä¼¼äº <code>rm -rf</code> çš„åŠŸèƒ½ï¼›</li> <li><a href="https://www.npmjs.com/package/cpr" target="_blank" rel="noopener noreferrer">cpr<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œç”¨äºæ‹·è´ã€å¤åˆ¶æ–‡ä»¶å’Œç›®å½•ï¼Œå®ç°ç±»ä¼¼äº <code>cp -r</code> çš„åŠŸèƒ½ï¼›</li> <li><a href="https://www.npmjs.com/package/make-dir-cli" target="_blank" rel="noopener noreferrer">make-dir-cli<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œç”¨äºåˆ›å»ºç›®å½•ï¼Œå®ç°ç±»ä¼¼äº <code>mkdir -p</code> çš„åŠŸèƒ½ï¼›</li></ul> <p>ä½¿ç”¨ä¸Šé¢è¿™å‡ ä¸ªå°å·¥å…·æ”¹é€  npm script çš„å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p> <p><strong>ç¬¬ 1 æ­¥ï¼Œæ·»åŠ å¼€å‘ä¾èµ–ï¼š</strong></p> <div class="language- extra-class"><pre class="language-text"><code>npm i rimraf cpr make-dir-cli -D
# npm install rimraf cpr make-dir-cli --save-dev
# yarn add rimraf cpr make-dir-cli -D

</code></pre></div><p><strong>ç¬¬ 2 æ­¥ï¼Œæ”¹é€ æ¶‰åŠæ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„ npm scriptï¼š</strong></p> <div class="language- extra-class"><pre class="language-text"><code>  &quot;scripts&quot;: {
-    &quot;cover:cleanup&quot;: &quot;rm -rf coverage &amp;&amp; rm -rf .nyc_output&quot;,
-    &quot;cover:archive&quot;: &quot;cross-var \&quot;mkdir -p coverage_archive/$npm_package_version &amp;&amp; cp -r coverage/* coverage_archive/$npm_package_version\&quot;&quot;,
+    &quot;cover:cleanup&quot;: &quot;rimraf coverage &amp;&amp; rimraf .nyc_output&quot;,
+    &quot;cover:archive&quot;: &quot;cross-var \&quot;make-dir coverage_archive/$npm_package_version &amp;&amp; cpr coverage/* coverage_archive/$npm_package_version -o\&quot;&quot;,
     &quot;cover:serve&quot;: &quot;cross-var http-server coverage_archive/$npm_package_version -p $npm_package_config_port&quot;,
     &quot;cover:open&quot;: &quot;cross-var opn http://localhost:$npm_package_config_port&quot;,
-    &quot;postcover&quot;: &quot;npm-run-all cover:archive cover:cleanup --parallel cover:serve cover:open&quot;
+    &quot;precover&quot;: &quot;npm run cover:cleanup&quot;,
+    &quot;postcover&quot;: &quot;npm-run-all cover:archive --parallel cover:serve cover:open&quot;
  },

</code></pre></div><p>å¯¹æ”¹åŠ¨çš„å‡ ç‚¹è¯´æ˜ï¼š</p> <ul><li><code>rm -rf</code> ç›´æ¥æ›¿æ¢æˆ <code>rimraf</code>ï¼›</li> <li><code>mkdir -p</code> ç›´æ¥æ›¿æ¢æˆ <code>make-dir</code>ï¼›</li> <li><code>cp -r</code> çš„æ›¿æ¢éœ€ç‰¹åˆ«è¯´æ˜ä¸‹ï¼Œ<code>cpr</code> é»˜è®¤æ˜¯ä¸è¦†ç›–çš„ï¼Œéœ€è¦æ˜¾ç¤ºä¼ å…¥ <code>-o</code> é…ç½®é¡¹ï¼Œå¹¶ä¸”å‚æ•°å¿…é¡»ä¸¥æ ¼æ˜¯ <code>cpr &lt;source&gt; &lt;destination&gt; [options]</code> çš„æ ¼å¼ï¼Œå³é…ç½®é¡¹æ”¾åœ¨æœ€åé¢ï¼›</li> <li>æŠŠ <code>cover:cleanup</code> ä» <code>postcover</code> æŒªåˆ° <code>precover</code> é‡Œé¢å»æ‰§è¡Œï¼Œè§„é¿ <code>cpr</code> æ²¡å½’æ¡£å®Œæ¯•è¦†ç›–ç‡æŠ¥å‘Šå°±è¢«æ¸…ç©ºçš„é—®é¢˜ï¼›</li></ul> <blockquote><p><strong>TIP#13</strong>ï¼šä»»ä½•æ”¹åŠ¨ä¹‹åè®°å¾—é‡æ–°è¿è¡Œ <code>npm run cover</code>ï¼Œç¡®ä¿æ‰€æœ‰çš„ <code>npm script</code> è¿˜æ˜¯æŒ‰é¢„æœŸå·¥ä½œçš„</p></blockquote> <h3 id="ç”¨-cross-var-å¼•ç”¨å˜é‡"><a href="#ç”¨-cross-var-å¼•ç”¨å˜é‡" class="header-anchor">#</a> ç”¨ cross-var å¼•ç”¨å˜é‡</h3> <blockquote><p><a href="https://juejin.im/book/5a1212bc51882531ea64df07/section/5a12146951882531bb6c68fe" target="_blank" rel="noopener noreferrer">2.2 åœ¨ npm script ä¸­ä½¿ç”¨å˜é‡<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨å†…ç½®å’Œé¢„å®šä¹‰å˜é‡å‡å°‘ä»£ç é‡å¤çš„æŠ€å·§ï¼Œå¦‚æœ¬èŠ‚å¼€å¤´çš„ä¾‹å­ï¼ŒLinux å’Œ Windows ä¸‹å¼•ç”¨å˜é‡çš„æ–¹å¼æ˜¯ä¸åŒçš„ï¼ŒLinux ä¸‹ç›´æ¥å¯ä»¥ç”¨ <code>$npm_package_name</code>ï¼Œè€Œ Windows ä¸‹å¿…é¡»ä½¿ç”¨ <code>%npm_package_name%</code>ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <a href="https://www.npmjs.com/package/cross-var" target="_blank" rel="noopener noreferrer">cross-var<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> å®ç°è·¨å¹³å°çš„å˜é‡å¼•ç”¨ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p></blockquote> <p><strong>ç¬¬1 æ­¥ï¼Œå®‰è£… cross-var ä¸ºå¼€å‘ä¾èµ–ï¼š</strong></p> <div class="language- extra-class"><pre class="language-text"><code>npm i cross-var -D
# npm install cross-var --save-dev
# yarn add cross-var -D

</code></pre></div><p><strong>ç¬¬ 2 æ­¥ï¼Œæ”¹å†™å¼•ç”¨å˜é‡ npm scriptï¼Œå…·ä½“ diff å¦‚ä¸‹ï¼š</strong></p> <div class="language- extra-class"><pre class="language-text"><code>  &quot;scripts&quot;: {
     &quot;cover:cleanup&quot;: &quot;rm -rf coverage &amp;&amp; rm -rf .nyc_output&quot;,
-    &quot;cover:archive&quot;: &quot;mkdir -p coverage_archive/$npm_package_version &amp;&amp; cp -r coverage/* coverage_archive/$npm_package_version&quot;,
-    &quot;cover:serve&quot;: &quot;http-server coverage_archive/$npm_package_version -p $npm_package_config_port&quot;,
-    &quot;cover:open&quot;: &quot;opn http://localhost:$npm_package_config_port&quot;,
+    &quot;cover:archive&quot;: &quot;cross-var \&quot;mkdir -p coverage_archive/$npm_package_version &amp;&amp; cp -r coverage/* coverage_archive/$npm_package_version\&quot;&quot;,
+    &quot;cover:serve&quot;: &quot;cross-var http-server coverage_archive/$npm_package_version -p $npm_package_config_port&quot;,
+    &quot;cover:open&quot;: &quot;cross-var opn http://localhost:$npm_package_config_port&quot;,
     &quot;postcover&quot;: &quot;npm-run-all cover:archive cover:cleanup --parallel cover:serve cover:open&quot;
   },

</code></pre></div><blockquote><p>å› ä¸º <code>cover:serve</code> å’Œ <code>cover:open</code> å‘½ä»¤éƒ½æ¯”è¾ƒç®€å•ï¼Œç›´æ¥åœ¨åŸå§‹å‘½ä»¤å‰å¢åŠ  <code>cross-var</code> å‘½ä»¤å³å¯ï¼Œè€Œ <code>cover:archive</code> å†…å«äº†ä¸¤æ¡å­å‘½ä»¤ï¼Œæˆ‘ä»¬éœ€è¦ç”¨å¼•å·æŠŠæ•´ä¸ªå‘½ä»¤åŒ…èµ·æ¥ï¼ˆæ³¨æ„è¿™é‡Œæ˜¯ç”¨çš„åŒå¼•å·ï¼Œä¸”å¿…é¡»è½¬ä¹‰ï¼‰ï¼Œç„¶ååœ¨å‰é¢åŠ ä¸Š <code>cross-var</code>ã€‚</p></blockquote> <p>æ­¤å¤–ï¼Œç»†å¿ƒçš„åŒå­¦å¯èƒ½å‘ç°å¼•å…¥ <code>cross-var</code> ä¹‹åï¼Œå®ƒç«Ÿç„¶ç»™æˆ‘ä»¬å®‰è£…äº† <code>babel</code>ï¼Œå¦‚æœæƒ³ä¿æŒä¾èµ–æ›´è½»é‡çš„è¯ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ <a href="https://www.npmjs.com/package/cross-var-no-babel" target="_blank" rel="noopener noreferrer">cross-var-no-babel<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p> <h3 id="ç”¨-cross-env-è®¾ç½®ç¯å¢ƒå˜é‡"><a href="#ç”¨-cross-env-è®¾ç½®ç¯å¢ƒå˜é‡" class="header-anchor">#</a> ç”¨ cross-env è®¾ç½®ç¯å¢ƒå˜é‡</h3> <blockquote><p>åœ¨ <code>node.js</code> è„šæœ¬å’Œ <code>npm script</code> ä½¿ç”¨ç¯å¢ƒå˜é‡ä¹Ÿæ˜¯æ¯”è¾ƒå¸¸è§çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨è¿è¡Œæµ‹è¯•æ—¶ï¼Œéœ€è¦åŠ ä¸Š <code>NODE_ENV=test</code>ï¼Œæˆ–è€…åœ¨å¯åŠ¨é™æ€èµ„æºæœåŠ¡å™¨æ—¶è‡ªå®šä¹‰ç«¯å£å·ã€‚å› ä¸ºä¸åŒå¹³å°çš„ç¯å¢ƒå˜é‡è¯­æ³•ä¸åŒï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <a href="https://www.npmjs.com/package/cross-env" target="_blank" rel="noopener noreferrer">cross-env<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æ¥å®ç° <code>npm script</code> çš„è·¨å¹³å°å…¼å®¹ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p></blockquote> <p><strong>ç¬¬ 1 æ­¥ï¼Œæ·»åŠ  cross-env åˆ°å¼€å‘ä¾èµ–ï¼š</strong></p> <div class="language- extra-class"><pre class="language-text"><code>npm i cross-env -D
# npm install cross-env --save-dev
# yarn add cross-env -D

</code></pre></div><p><strong>ç¬¬ 2 æ­¥ï¼Œæ”¹å†™ä½¿ç”¨äº†ç¯å¢ƒå˜é‡çš„ npm scriptï¼š</strong></p> <div class="language- extra-class"><pre class="language-text"><code>  &quot;scripts&quot;: {
-    &quot;test&quot;: &quot;NODE_ENV=test mocha tests/&quot;,
+    &quot;test&quot;: &quot;cross-env NODE_ENV=test mocha tests/&quot;,
  },

</code></pre></div><blockquote><p>ä¸Šé¢çš„æ”¹åŠ¨æ›´ç®€å•ï¼Œç›´æ¥åœ¨è®¾ç½®äº†ç¯å¢ƒå˜é‡çš„å‘½ä»¤å‰é¢åŠ ä¸Š <code>cross-env</code> å³å¯ã€‚</p></blockquote> <h3 id="å†å¤šè¯´å‡ å¥"><a href="#å†å¤šè¯´å‡ å¥" class="header-anchor">#</a> å†å¤šè¯´å‡ å¥</h3> <p><strong>å…³äº <code>npm script</code> çš„è·¨å¹³å°å…¼å®¹ï¼Œè¿˜æœ‰å‡ ç‚¹éœ€è¦å¤§å®¶æ³¨æ„ï¼š</strong></p> <ul><li>æ‰€æœ‰ä½¿ç”¨å¼•å·çš„åœ°æ–¹ï¼Œå»ºè®®ä½¿ç”¨åŒå¼•å·ï¼Œå¹¶ä¸”åŠ ä¸Šè½¬ä¹‰ï¼›</li> <li>æ²¡åšç‰¹æ®Šå¤„ç†çš„å‘½ä»¤æ¯”å¦‚ <code>eslint</code>ã€<code>stylelint</code>ã€<code>mocha</code>ã€<code>opn</code> ç­‰å·¥å…·æœ¬èº«éƒ½æ˜¯è·¨å¹³å°å…¼å®¹çš„ï¼›</li> <li>è¿˜æ˜¯å¼ºçƒˆå»ºè®®æœ‰èƒ½åŠ›çš„åŒå­¦èƒ½ä½¿ç”¨ Linux åšå¼€å‘ï¼Œåªè¦ä½ å…¥é—¨å¹¶ä¸”ç†Ÿç»ƒäº†ï¼Œæ•ˆç‡æå‡ä¼šæƒŠäººï¼›</li> <li>çŸ­æ—¶é—´å†…ç»§ç»­æ‹¥æŠ± Windows çš„åŒå­¦ï¼Œå¯ä»¥è€ƒè™‘çœ‹çœ‹ Windows 10 é‡Œé¢å¼•å…¥çš„ <a href="https://msdn.microsoft.com/en-us/commandline/wsl/about" target="_blank" rel="noopener noreferrer">Subsystem<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œè®©ä½ ä¸ç”¨è™šæ‹Ÿæœºå³å¯åœ¨ Windows ä¸‹ä½¿ç”¨å¤§å¤šæ•° Linux å‘½ä»¤ã€‚</li></ul> <blockquote><p><strong>TIP#14</strong>ï¼šå¦‚æœä½ åœ¨ç¼–å†™ <code>npm script</code> è¿‡ç¨‹ä¸­æœ‰æ›´å¤šçš„è·¨å¹³å°å…¼å®¹éœ€æ±‚ï¼ŒåŸºæœ¬æ€è·¯æ˜¯å» <a href="https://www.npmjs.com/search?q=cross%20platform" target="_blank" rel="noopener noreferrer">npmjs.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ä¸Šæ‰¾å¯¹åº”çš„åŒ…ï¼Œå…³é”®è¯è‡ªç„¶å°‘ä¸äº† <code>cross platform</code>ï¼Œä½ é‡åˆ°çš„é—®é¢˜ï¼Œè‚¯å®šå¾ˆå¤šå…¶ä»–äººé‡åˆ°è¿‡ï¼Œç›¸ä¿¡æˆ‘ï¼Œä½ å¹¶ä¸å­¤ç‹¬ï¼</p></blockquote> <blockquote><p>æœ¬èŠ‚ç”¨åˆ°çš„ä»£ç è§ <a href="https://github.com/wangshijun/automated-workflow-with-npm-script/tree/06-add-cross-platform-support" target="_blank" rel="noopener noreferrer">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œæƒ³è¾¹çœ‹è¾¹åŠ¨æ‰‹ç»ƒä¹ çš„åŒå­¦å¯ä»¥æ‹‰ä¸‹æ¥è‡ªå·±æ”¹ï¼Œæ³¨æ„åˆ‡æ¢åˆ°æ­£ç¡®çš„åˆ†æ”¯ <code>06-add-cross-platform-support</code>ã€‚</p></blockquote> <h2 id="_8-æŠŠåºå¤§çš„-npm-script-æ‹†åˆ°å•ç‹¬æ–‡ä»¶ä¸­"><a href="#_8-æŠŠåºå¤§çš„-npm-script-æ‹†åˆ°å•ç‹¬æ–‡ä»¶ä¸­" class="header-anchor">#</a> 8 æŠŠåºå¤§çš„ npm script æ‹†åˆ°å•ç‹¬æ–‡ä»¶ä¸­</h2> <blockquote><p>å½“ <code>npm script</code> ä¸æ–­ç´¯ç§¯ã€è†¨èƒ€çš„æ—¶å€™ï¼Œå…¨éƒ¨æ”¾åœ¨ <code>package.json</code> é‡Œé¢å¯èƒ½å¹¶ä¸æ˜¯ä¸ªå¥½ä¸»æ„ï¼Œå› ä¸ºè¿™æ ·ä¼šå¯¼è‡´ package.json ç³Ÿä¹±ï¼Œå¯è¯»æ€§é™ä½ã€‚</p></blockquote> <blockquote><p>å€ŸåŠ© <a href="https://github.com/testdouble/scripty" target="_blank" rel="noopener noreferrer">scripty<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æˆ‘ä»¬å¯ä»¥å°† <code>npm script</code> å‰¥ç¦»åˆ°å•ç‹¬çš„æ–‡ä»¶ä¸­ï¼Œä»è€ŒæŠŠå¤æ‚æ€§éš”åˆ°å•ç‹¬çš„æ¨¡å—é‡Œé¢ï¼Œè®©ä»£ç æ•´ä½“çœ‹èµ·æ¥æ›´åŠ æ¸…æ™°ã€‚</p></blockquote> <p>ç¤ºä¾‹é¡¹ç›®ä¸­çš„è¦†ç›–ç‡ç›¸å…³çš„ <code>npm script</code> å æ®äº†å¾ˆå¤§çš„ç¯‡å¹…ï¼Œå¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>  &quot;scripts&quot;: {
    &quot;cover&quot;: &quot;nyc --reporter=html npm test&quot;,
    &quot;cover:cleanup&quot;: &quot;rimraf coverage &amp;&amp; rimraf .nyc_output&quot;,
    &quot;cover:archive&quot;: &quot;cross-var \&quot;make-dir coverage_archive/$npm_package_version &amp;&amp; cpr coverage/* coverage_archive/$npm_package_version -o\&quot;&quot;,
    &quot;cover:serve&quot;: &quot;cross-var http-server coverage_archive/$npm_package_version -p $npm_package_config_port&quot;,
    &quot;cover:open&quot;: &quot;cross-var opn http://localhost:$npm_package_config_port&quot;,
    &quot;precover&quot;: &quot;npm run cover:cleanup&quot;,
    &quot;postcover&quot;: &quot;npm-run-all cover:archive --parallel cover:serve cover:open&quot;
  },

</code></pre></div><p>å¦‚æœè¦éš”ç¦»å¤æ‚æ€§ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä» <code>cover</code> ç›¸å…³çš„ <code>script</code> å…¥æ‰‹ï¼Œå…·ä½“æ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š</p> <h3 id="å®‰è£…ä¾èµ–"><a href="#å®‰è£…ä¾èµ–" class="header-anchor">#</a> å®‰è£…ä¾èµ–</h3> <div class="language- extra-class"><pre class="language-text"><code>npm i scripty -D
# npm install scripty --save-dev
# yarn add scripty -D

</code></pre></div><h3 id="å‡†å¤‡ç›®å½•å’Œæ–‡ä»¶"><a href="#å‡†å¤‡ç›®å½•å’Œæ–‡ä»¶" class="header-anchor">#</a> å‡†å¤‡ç›®å½•å’Œæ–‡ä»¶</h3> <div class="language- extra-class"><pre class="language-text"><code>mkdir -p scripts/cover

</code></pre></div><blockquote><p>å…ˆåˆ›å»ºä¸¤å±‚çš„ç›®å½•ï¼Œå› ä¸ºæˆ‘ä»¬è®¡åˆ’æŠŠ <code>cover</code> è„šæœ¬å†™æˆå¤šä¸ªï¼Œæ–¹ä¾¿å•ç‹¬å»æ‰§è¡Œï¼Œè¿™é‡Œå‘½åä¸º <code>scripts</code> æ˜¯ <code>scripty</code> é»˜è®¤çš„ï¼Œå®é™…ä¸Šæ˜¯å¯ä»¥è‡ªå®šä¹‰çš„ã€‚</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>touch scripts/cover.sh
touch scripts/cover/serve.sh
touch scripts/cover/open.sh

</code></pre></div><blockquote><p>ç„¶ååˆ›å»ºç©ºç™½çš„è„šæœ¬æ–‡ä»¶ï¼Œå› ä¸ºæœ‰äº†å•ç‹¬çš„è„šæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåŸæ¥çš„ <code>precover</code>ã€<code>cover</code>ã€<code>postcover</code>ã€<code>cover:archive</code>ã€<code>cover:cleanup</code> åˆå¹¶åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚</p></blockquote> <p><strong>ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œç»™æ‰€æœ‰è„šæœ¬å¢åŠ å¯æ‰§è¡Œæƒé™æ˜¯å¿…é¡»çš„ï¼Œå¦åˆ™ scripty æ‰§è¡Œæ—¶ä¼šæŠ¥é”™</strong>ï¼Œæˆ‘ä»¬å¯ä»¥ç»™æ‰€æœ‰çš„è„šæœ¬å¢åŠ å¯æ‰§è¡Œæƒé™ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>chmod -R a+x scripts/**/*.sh
</code></pre></div><h3 id="ä¿®æ”¹-scripty-è„šæœ¬"><a href="#ä¿®æ”¹-scripty-è„šæœ¬" class="header-anchor">#</a> ä¿®æ”¹ scripty è„šæœ¬</h3> <blockquote><p>å‡†å¤‡å¥½ç›®å½•å’Œæ–‡ä»¶ä¹‹åï¼Œæ¥ä¸‹æ¥éœ€è¦ç»™è„šæœ¬å¡«å……å†…å®¹ï¼Œè„šæœ¬å†…å®¹å¦‚ä¸‹ï¼ˆå› ä¸ºè„šæœ¬ä½¿ç”¨çš„æ˜¯ <code>bash</code>ï¼Œæ‰€ä»¥ç›´æ¥å¿½ç•¥äº†è·¨å¹³å°å…¼å®¹çš„å¤„ç†ï¼Œè·¨å¹³å°å…¼å®¹è„šæœ¬æœ€å¥½ä½¿ç”¨ <code>Node.js</code> ç¼–å†™ï¼Œä¸‹èŠ‚ä¼šä»‹ç»ï¼‰ï¼š</p></blockquote> <blockquote><p><code>scripts/cover.sh</code> å†…å®¹å¦‚ä¸‹ï¼ˆ<code>cleanup</code> --&gt; <code>cover</code> --&gt; <code>archive</code> --&gt; <code>preview</code>ï¼‰ï¼š</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>#!/usr/bin/env bash

# remove old coverage reports
rimraf coverage &amp;&amp; rimraf .nyc_output

# run test and collect new coverage
nyc --reporter=html npm run test

# achive coverage report by version
mkdir -p coverage_archive/$npm_package_version
cp -r coverage/* coverage_archive/$npm_package_version

# open coverage report for preview
npm-run-all --parallel cover:serve cover:open

</code></pre></div><blockquote><p><code>scripts/cover/serve.sh</code> å†…å®¹å¦‚ä¸‹ï¼š</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>#!/usr/bin/env bash

http-server coverage_archive/$npm_package_version -p $npm_package_config_port

</code></pre></div><p><code>scripts/cover/open.sh</code> å†…å®¹å¦‚ä¸‹ï¼ˆè¿™é‡Œæœ‰ä¸ª sleepï¼Œæ˜¯ä¸ºäº†ç¡®ä¿æ–‡ä»¶ç³»ç»Ÿå†™å…¥å®Œæˆï¼‰ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>#!/usr/bin/env bash

sleep 1
opn http://localhost:$npm_package_config_port

</code></pre></div><p>ç»†å¿ƒçš„åŒå­¦å¯èƒ½æ³¨æ„åˆ°äº†ï¼Œåœ¨ <code>shell</code> è„šæœ¬é‡Œé¢æ˜¯å¯ä»¥éšæ„ä½¿ç”¨ <code>npm</code> çš„å†…ç½®å˜é‡å’Œè‡ªå®šä¹‰å˜é‡çš„ã€‚</p> <h3 id="ä¿®æ”¹-package-json"><a href="#ä¿®æ”¹-package-json" class="header-anchor">#</a> ä¿®æ”¹ package.json</h3> <blockquote><p>ä¸»è¦æ”¹åŠ¨æ˜¯æ¸…ç† <code>cover:\*</code> å‘½ä»¤ï¼Œæ¥å…¥ <code>scripty</code>ï¼Œå…·ä½“çš„ <code>diff</code> å¦‚ä¸‹ï¼š</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>   &quot;scripts&quot;: {
     &quot;test&quot;: &quot;cross-env NODE_ENV=test mocha tests/&quot;,
-    &quot;cover&quot;: &quot;nyc --reporter=html npm test&quot;,
-    &quot;cover:cleanup&quot;: &quot;rimraf coverage &amp;&amp; rimraf .nyc_output&quot;,
-    &quot;cover:archive&quot;: &quot;cross-var \&quot;make-dir coverage_archive/$npm_package_version &amp;&amp; cpr coverage/* coverage_archive/$npm_package_version -o\&quot;&quot;,
-    &quot;cover:serve&quot;: &quot;cross-var http-server coverage_archive/$npm_package_version -p $npm_package_config_port&quot;,
-    &quot;cover:open&quot;: &quot;cross-var opn http://localhost:$npm_package_config_port&quot;,
-    &quot;precover&quot;: &quot;npm run cover:cleanup&quot;,
-    &quot;postcover&quot;: &quot;npm-run-all cover:archive --parallel cover:serve cover:open&quot;
+    &quot;cover&quot;: &quot;scripty&quot;,
+    &quot;cover:serve&quot;: &quot;scripty&quot;,
+    &quot;cover:open&quot;: &quot;scripty&quot;
   },

</code></pre></div><p>è¿™é‡Œæˆ‘ä»¬åªä¿ç•™äº† <code>cover</code>ã€<code>cover:serve</code>ã€<code>cover:open</code> ç­‰ 3 ä¸ªå‘½ä»¤ï¼Œè®©å®ƒä»¬éƒ½æŒ‡å‘ <code>scripty</code>ï¼Œè°ƒç”¨å“ªä¸ªè„šæœ¬éƒ½ç”± scripty æ¥å¤„ç†ã€‚</p> <h3 id="å®é™…æµ‹è¯•"><a href="#å®é™…æµ‹è¯•" class="header-anchor">#</a> å®é™…æµ‹è¯•</h3> <p>ä¿®æ”¹å®Œæ¯•ä¹‹åï¼Œé‡æ–°è¿è¡Œ <code>npm run cover</code>ï¼Œä¸å‡ºæ„å¤–çš„è¯ï¼Œæˆ‘ä»¬èƒ½å¾—åˆ°å’ŒåŸæ¥å®Œå…¨ç›¸åŒçš„ç»“æœï¼Œä»”ç»†è§‚å¯Ÿè¿è¡Œçš„æ—¥å¿—ï¼Œä¼šå‘ç°åœ¨ä»£ç æ‰§è¡Œå‰æœ‰æ®µé¢å¤–çš„è¾“å‡ºï¼Œå¦‚ä¸‹å›¾ä¸­çº¢è‰²æ¡†ä¸­çš„å†…å®¹ï¼Œ<code>scripty</code> åœ¨å®é™…æ‰§è¡Œçš„æ—¶å€™ä¼šæŠŠæ‰§è¡Œçš„å‘½ä»¤å†…å®¹æ‰“å°å‡ºæ¥ï¼Œæ–¹ä¾¿è°ƒè¯•ï¼š</p> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/23.png" alt=""></p> <h3 id="é«˜çº§æŠ€å·§"><a href="#é«˜çº§æŠ€å·§" class="header-anchor">#</a> é«˜çº§æŠ€å·§</h3> <blockquote><p><code>scripty</code> æ¯”ä¸Šé¢æ¼”ç¤ºçš„è¦æ›´å¼ºå¤§ï¼Œä¹Ÿæ”¯æŒé€šé…ç¬¦è¿è¡Œã€è„šæœ¬å¹¶è¡Œç­‰ç‰¹æ€§ã€é™é»˜æ¨¡å¼ï¼Œå¦‚æœæœ‰éœ€æ±‚å¯ä»¥é˜…è¯»å®˜æ–¹çš„ <a href="https://github.com/testdouble/scripty#advanced-usage" target="_blank" rel="noopener noreferrer">README.md<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œæ¯•ç«Ÿå’±ä»¬å·²ç»å…¥é—¨äº†ï¼Œä¸æ˜¯ä¹ˆï¼Ÿ</p></blockquote> <blockquote><p>æœ¬èŠ‚ç”¨åˆ°çš„ä»£ç è§ <a href="https://github.com/wangshijun/automated-workflow-with-npm-script/tree/07-manage-complexity-using-scripty" target="_blank" rel="noopener noreferrer">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œæƒ³è¾¹çœ‹è¾¹åŠ¨æ‰‹ç»ƒä¹ çš„åŒå­¦å¯ä»¥æ‹‰ä¸‹æ¥è‡ªå·±æ”¹ï¼Œæ³¨æ„åˆ‡æ¢åˆ°æ­£ç¡®çš„åˆ†æ”¯ <code>07-manage-complexity-using-scripty</code>ã€‚</p></blockquote> <h2 id="_9-ç”¨-node-js-è„šæœ¬æ›¿ä»£å¤æ‚çš„-npm-script"><a href="#_9-ç”¨-node-js-è„šæœ¬æ›¿ä»£å¤æ‚çš„-npm-script" class="header-anchor">#</a> 9 ç”¨ node.js è„šæœ¬æ›¿ä»£å¤æ‚çš„ npm script</h2> <blockquote><p><a href="https://nodejs.org/en/" target="_blank" rel="noopener noreferrer">Node.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ä¸°å¯Œçš„ç”Ÿæ€èƒ½èµ‹äºˆæˆ‘ä»¬æ›´å¼ºçš„èƒ½åŠ›ï¼Œå¯¹äºå‰ç«¯å·¥ç¨‹å¸ˆæ¥è¯´ï¼Œä½¿ç”¨ Node.js æ¥ç¼–å†™å¤æ‚çš„ npm script å…·æœ‰æ˜æ˜¾çš„ 2 ä¸ªä¼˜åŠ¿ï¼šé¦–å…ˆï¼Œç¼–å†™ç®€å•çš„å·¥å…·è„šæœ¬å¯¹å‰ç«¯å·¥ç¨‹å¸ˆæ¥è¯´é¢å¤–çš„å­¦ä¹ æˆæœ¬å¾ˆä½ç”šè‡³å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œå…¶æ¬¡ï¼Œå› ä¸º Node.js æœ¬èº«æ˜¯è·¨å¹³å°çš„ï¼Œç”¨å®ƒç¼–å†™çš„è„šæœ¬å‡ºç°è·¨å¹³å°å…¼å®¹é—®é¢˜çš„æ¦‚ç‡å¾ˆå°ã€‚</p></blockquote> <p>ä¸‹é¢æˆ‘ä»¬å°±ä¸€èµ·æ¢ç´¢ä¸‹ï¼Œå¦‚ä½•æŠŠä¸ŠèŠ‚ä¸­ä½¿ç”¨ shell ç¼–å†™çš„ <code>cover</code> è„šæœ¬æ”¹å†™æˆ Node.js è„šæœ¬ï¼Œåœ¨ <code>Node.js</code> è„šæœ¬ä¸­æˆ‘ä»¬ä¹Ÿèƒ½ä½“å‘³åˆ° <a href="https://www.npmjs.com/package/shelljs" target="_blank" rel="noopener noreferrer">shelljs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> è¿™ä¸ªå·¥å…·åŒ…çš„å¼ºå¤§ã€‚</p> <h3 id="å®‰è£…-shelljs-ä¾èµ–"><a href="#å®‰è£…-shelljs-ä¾èµ–" class="header-anchor">#</a> å®‰è£… shelljs ä¾èµ–</h3> <p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å®‰è£… <code>shelljs</code> åˆ°é¡¹ç›®ä¾èµ–ä¸­ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>npm i shelljs -D
# npm install shelljs --save-dev
# yarn add shelljs -D

</code></pre></div><blockquote><p>æ­¤å¤–ï¼Œæˆ‘ä»¬è®¡åˆ’ä½¿ç”¨ <a href="https://www.npmjs.com/package/chalk" target="_blank" rel="noopener noreferrer">chalk<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æ¥ç»™è¾“å‡ºåŠ ç‚¹é¢œè‰²ï¼Œè®©è„šæœ¬å˜çš„æ›´æœ‰è¶£ï¼ŒåŒæ ·å®‰è£…åˆ° <code>devDependencies</code> é‡Œé¢ï¼š</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>npm i chalk -D
# npm install chalk --save-dev
# yarn add chalk -D

</code></pre></div><h3 id="åˆ›å»º-node-js-è„šæœ¬"><a href="#åˆ›å»º-node-js-è„šæœ¬" class="header-anchor">#</a> åˆ›å»º Node.js è„šæœ¬</h3> <div class="language- extra-class"><pre class="language-text"><code>touch scripts/cover.js
</code></pre></div><h3 id="ç”¨-node-js-å®ç°åŒç­‰åŠŸèƒ½"><a href="#ç”¨-node-js-å®ç°åŒç­‰åŠŸèƒ½" class="header-anchor">#</a> ç”¨ Node.js å®ç°åŒç­‰åŠŸèƒ½</h3> <blockquote><p><code>shelljs</code> ä¸ºæˆ‘ä»¬æä¾›äº†å„ç§å¸¸è§å‘½ä»¤çš„è·¨å¹³å°æ”¯æŒï¼Œæ¯”å¦‚ <code>cp</code>ã€<code>mkdir</code>ã€<code>rm</code>ã€<code>cd</code> ç­‰å‘½ä»¤ï¼Œæ­¤å¤–ï¼Œç†è®ºä¸Šä½ å¯ä»¥åœ¨ Node.js è„šæœ¬ä¸­ä½¿ç”¨ä»»ä½• <a href="https://www.npmjs.com" target="_blank" rel="noopener noreferrer">npmjs.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ä¸Šèƒ½æ‰¾åˆ°çš„åŒ…ã€‚æ¸…ç†å½’æ¡£ç›®å½•ã€è¿è¡Œæµ‹è¯•ã€å½’æ¡£å¹¶é¢„è§ˆè¦†ç›–ç‡æŠ¥å‘Šçš„å®Œæ•´ Node.js ä»£ç å¦‚ä¸‹ï¼š</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>const { rm, cp, mkdir, exec, echo } = require('shelljs');
const chalk = require('chalk');

console.log(chalk.green('1. remove old coverage reports...'));
rm('-rf', 'coverage');
rm('-rf', '.nyc_output');

console.log(chalk.green('2. run test and collect new coverage...'));
exec('nyc --reporter=html npm run test');

console.log(chalk.green('3. archive coverage report by version...'));
mkdir('-p', 'coverage_archive/$npm_package_version');
cp('-r', 'coverage/*', 'coverage_archive/$npm_package_version');

console.log(chalk.green('4. open coverage report for preview...'));
exec('npm-run-all --parallel cover:serve cover:open');

</code></pre></div><p>å…³äºæ”¹åŠ¨çš„å‡ ç‚¹è¯´æ˜ï¼š</p> <ul><li>ç®€å•çš„æ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼Œå»ºè®®ç›´æ¥ä½¿ç”¨ shelljs æä¾›çš„ cpã€rm ç­‰æ›¿æ¢ï¼›</li> <li>éƒ¨åˆ†ç¨å¤æ‚çš„å‘½ä»¤ï¼Œæ¯”å¦‚ nyc å¯ä»¥ä½¿ç”¨ exec æ¥æ‰§è¡Œï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ istanbul åŒ…æ¥å®Œæˆï¼›</li> <li>åœ¨ exec ä¸­ä¹Ÿå¯ä»¥å¤§èƒ†çš„ä½¿ç”¨ npm script è¿è¡Œæ—¶çš„ç¯å¢ƒå˜é‡ï¼Œæ¯”å¦‚ <code>$npm_package_version</code>ï¼›</li></ul> <h3 id="è®©-package-json-æŒ‡å‘æ–°è„šæœ¬"><a href="#è®©-package-json-æŒ‡å‘æ–°è„šæœ¬" class="header-anchor">#</a> è®© package.json æŒ‡å‘æ–°è„šæœ¬</h3> <p>å‡†å¤‡å¥½ Node.js è„šæœ¬ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ <code>package.json</code> é‡Œé¢çš„å‘½ä»¤ï¼Œä½¿å…¶è¿è¡Œè¯¥è„šæœ¬ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>   &quot;scripts&quot;: {
     &quot;test&quot;: &quot;cross-env NODE_ENV=test mocha tests/&quot;,
-    &quot;cover&quot;: &quot;scripty&quot;,
+    &quot;cover&quot;: &quot;node scripts/cover.js&quot;,
     &quot;cover:open&quot;: &quot;scripty&quot;
   },

</code></pre></div><h3 id="æµ‹è¯•-cover-å‘½å"><a href="#æµ‹è¯•-cover-å‘½å" class="header-anchor">#</a> æµ‹è¯• cover å‘½å</h3> <p>é‡æ–°è¿è¡Œ <code>npm run cover</code> å‘½ä»¤ï¼Œä¸å‡ºæ„å¤–çš„è¯ï¼ŒåŸºæœ¬åŠŸèƒ½æ˜¯æ­£å¸¸çš„ï¼Œé™¤äº†æˆ‘ä»¬æ–°åŠ çš„ç»¿è‰²è¾“å‡ºï¼Œå¦‚ä¸‹å›¾ï¼š</p> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/24.png" alt=""></p> <p>ä»¥ä¸Šï¼Œæœ¬å°èŠ‚å®Œï¼Œè¿™é‡Œåªæ˜¯ç®€å•å±•ç¤ºäº†å¦‚ä½•ç»„ç»‡ Node.js è„šæœ¬å¹¶ä¸”è®©å…¶ä¸ npm script å…³è”èµ·æ¥ï¼Œè‡³äºå…·ä½“åœ¨è„šæœ¬ä¸­åšä»€ä¹ˆäº‹æƒ…ï¼Œè¯·ä½ è‡ªç”±å‘æŒ¥å§ã€‚</p> <blockquote><p>æœ¬èŠ‚ç”¨åˆ°çš„ä»£ç è§ <a href="https://github.com/wangshijun/automated-workflow-with-npm-script/tree/08-using-nodejs-script-as-replacement" target="_blank" rel="noopener noreferrer">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œæƒ³è¾¹çœ‹è¾¹åŠ¨æ‰‹ç»ƒä¹ çš„åŒå­¦å¯ä»¥æ‹‰ä¸‹æ¥è‡ªå·±æ”¹ï¼Œæ³¨æ„åˆ‡æ¢åˆ°æ­£ç¡®çš„åˆ†æ”¯ <code>08-using-nodejs-script-as-replacement</code>ã€‚</p></blockquote> <h2 id="_10-å®æˆ˜1-æ–‡ä»¶å˜åŒ–æ—¶è‡ªåŠ¨è¿è¡Œ-npm-script"><a href="#_10-å®æˆ˜1-æ–‡ä»¶å˜åŒ–æ—¶è‡ªåŠ¨è¿è¡Œ-npm-script" class="header-anchor">#</a> 10 å®æˆ˜1 æ–‡ä»¶å˜åŒ–æ—¶è‡ªåŠ¨è¿è¡Œ npm script</h2> <p>è½¯ä»¶å·¥ç¨‹å¸ˆåšçš„äº‹æƒ…åŸºæœ¬éƒ½æ˜¯åœ¨å®ç°è‡ªåŠ¨åŒ–ï¼Œæ¯”å¦‚å„ç§ä¸šåŠ¡ç³»ç»Ÿæ˜¯ä¸ºäº†ä¸šåŠ¡è¿è½¬çš„è‡ªåŠ¨åŒ–ï¼Œéƒ¨ç½²ç³»ç»Ÿæ˜¯ä¸ºäº†è¿ç»´çš„è‡ªåŠ¨åŒ–ï¼Œå¯¹äºå¼€å‘è€…æœ¬èº«ï¼Œè‡ªåŠ¨åŒ–ä¹Ÿæ˜¯æå‡æ•ˆç‡çš„å…³é”®ç¯èŠ‚ï¼Œåœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­ä¹Ÿæœ‰ä¸å°‘äº‹æƒ…æ˜¯å¯ä»¥è‡ªåŠ¨åŒ–çš„ã€‚</p> <p>æ‹¥æŠ±ç°ä»£å‰ç«¯å·¥ä½œæµçš„åŒå­¦éƒ½ä¼šæœ‰ä»£ç é£æ ¼æ£€æŸ¥ã€å•å…ƒæµ‹è¯•ç­‰ç¯èŠ‚ï¼Œè¿™æ ·å°±å¾ˆéœ€è¦åœ¨ä»£ç å˜æ›´ä¹‹åç«‹å³å¾—åˆ°åé¦ˆï¼Œå¦‚ä»£ç æ”¹åŠ¨å¯¼è‡´äº†é‚£ä¸ª Case å¤±è´¥ï¼Œå“ªå—ä¸ç¬¦åˆå›¢é˜Ÿçš„ç¼–ç è§„èŒƒç­‰ã€‚</p> <p>ä½¿ç”¨ gulpã€grunt çš„åŒå­¦ï¼Œå¯èƒ½å¯¹è¿™ç§åŠŸèƒ½éå¸¸ç†Ÿæ‚‰ï¼Œä¸å°±æ˜¯ watch ä¹ˆï¼Ÿç¡®å®æ˜¯ï¼Œä½¿ç”¨ npm script æˆ‘ä»¬ä¹Ÿå¯ä»¥å®ç°ç±»ä¼¼çš„åŠŸèƒ½ã€‚ä¸‹é¢è¯¦ç»†ä»‹ç»å¦‚ä½•æ”¹é€ æˆ‘ä»¬çš„é¡¹ç›®å®ç°å•æµ‹ã€ä»£ç æ£€æŸ¥çš„è‡ªåŠ¨åŒ–ã€‚</p> <h3 id="å•å…ƒæµ‹è¯•è‡ªåŠ¨åŒ–"><a href="#å•å…ƒæµ‹è¯•è‡ªåŠ¨åŒ–" class="header-anchor">#</a> å•å…ƒæµ‹è¯•è‡ªåŠ¨åŒ–</h3> <blockquote><p>å¹¸è¿çš„æ˜¯ï¼Œ<code>mocha</code> æœ¬èº«æ”¯æŒ <code>--watch</code> å‚æ•°ï¼Œå³åœ¨ä»£ç å˜åŒ–æ—¶è‡ªåŠ¨é‡è·‘æ‰€æœ‰çš„æµ‹è¯•ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ scripts å¯¹è±¡ä¸­æ–°å¢ä¸€æ¡å‘½ä»¤å³å¯ï¼š</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>     &quot;test&quot;: &quot;cross-env NODE_ENV=test mocha tests/&quot;,
+    &quot;watch:test&quot;: &quot;npm t -- --watch&quot;,
     &quot;cover&quot;: &quot;node scripts/cover.js&quot;,

</code></pre></div><p>å°è¯•è¿è¡Œ <code>npm run watch:test</code>ï¼Œæˆ‘ä»¬ä¼šå‘ç°è¿›ç¨‹å¹¶æ²¡æœ‰é€€å‡ºï¼Œæ¥ä¸‹æ¥å°è¯•å»ä¿®æ”¹æµ‹è¯•ä»£ç ï¼Œæµ‹è¯•æ˜¯ä¸æ˜¯è‡ªåŠ¨é‡è·‘äº†å‘¢ï¼Ÿè‡ªå·±è¯•è¯•çœ‹ã€‚</p> <h3 id="ä»£ç æ£€æŸ¥è‡ªåŠ¨åŒ–"><a href="#ä»£ç æ£€æŸ¥è‡ªåŠ¨åŒ–" class="header-anchor">#</a> ä»£ç æ£€æŸ¥è‡ªåŠ¨åŒ–</h3> <blockquote><p>æˆ‘ä»¬ä½¿ç”¨çš„ä»£ç æ£€æŸ¥å·¥å…· <a href="https://stylelint.io" target="_blank" rel="noopener noreferrer">stylelint<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€<a href="https://eslint.org" target="_blank" rel="noopener noreferrer">eslint<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€<a href="https://github.com/zaach/jsonlint" target="_blank" rel="noopener noreferrer">jsonlint<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ä¸å…¨æ”¯æŒ watch æ¨¡å¼ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦å€ŸåŠ© <a href="https://github.com/Qard/onchange" target="_blank" rel="noopener noreferrer">onchange<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> å·¥å…·åŒ…æ¥å®ç°ï¼Œonchange å¯ä»¥æ–¹ä¾¿çš„è®©æˆ‘ä»¬åœ¨æ–‡ä»¶è¢«ä¿®æ”¹ã€æ·»åŠ ã€åˆ é™¤æ—¶è¿è¡Œéœ€è¦çš„å‘½ä»¤ã€‚</p></blockquote> <p><strong>1. å®‰è£…é¡¹ç›®ä¾èµ–</strong></p> <p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å®‰è£… <code>onchange</code> åˆ°é¡¹ç›®ä¾èµ–ä¸­ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>npm i onchange -D
# npm install onchange --save-dev
# yarn add onchange -D

</code></pre></div><p><strong>2. æ·»åŠ  npm script</strong></p> <p>æŒ‰ç…§å¦‚ä¸‹æç¤ºæ·»åŠ  <code>watch:lint</code> å’Œ <code>watch</code> ä¸¤ä¸ªå­å‘½ä»¤ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>+    &quot;watch&quot;: &quot;npm-run-all --parallel watch:*&quot;,
+    &quot;watch:lint&quot;: &quot;onchange -i \&quot;**/*.js\&quot; \&quot;**/*.less\&quot; -- npm run lint&quot;,
     &quot;watch:test&quot;: &quot;npm t -- --watch&quot;,
</code></pre></div><p><strong>å…³äºæ”¹åŠ¨çš„å‡ ç‚¹è¯´æ˜ï¼š</strong></p> <ul><li><code>watch:lint</code> é‡Œé¢çš„æ–‡ä»¶åŒ¹é…æ¨¡å¼å¯ä»¥ä½¿ç”¨é€šé…ç¬¦ï¼Œä½†æ˜¯æ¨¡å¼ä¸¤è¾¹ä½¿ç”¨äº†è½¬ä¹‰çš„åŒå¼•å·ï¼Œè¿™æ ·æ˜¯è·¨å¹³å°å…¼å®¹çš„ï¼›</li> <li><code>watch:lint</code> é‡Œé¢çš„ <code>-i</code> å‚æ•°æ˜¯è®© <code>onchange</code> åœ¨å¯åŠ¨æ—¶å°±è¿è¡Œä¸€æ¬¡ <code>--</code> ä¹‹åçš„å‘½ä»¤ï¼Œå³ä»£ç æ²¡å˜åŒ–çš„æ—¶å€™ï¼Œå˜åŒ–å‰åçš„å¯¹æ¯”å¤§å¤šæ•°æ—¶å€™è¿˜æ˜¯æœ‰ä»·å€¼çš„ï¼›</li> <li><code>watch</code> å‘½ä»¤å®é™…ä¸Šæ˜¯ä½¿ç”¨äº† <code>npm-run-all</code> æ¥è¿è¡Œæ‰€æœ‰çš„ <code>watch</code> å­å‘½ä»¤ï¼›</li></ul> <blockquote><p><strong>TIP#15</strong>ï¼šæœ‰æ²¡æœ‰å¥½å¥‡è¿‡ onchange æ˜¯æ€ä¹ˆå®ç°æ–‡ä»¶ç³»ç»Ÿç›‘å¬çš„ï¼Ÿæ‰€æœ‰çš„é­”æ³•éƒ½è—åœ¨å®ƒçš„æºä»£ç é‡Œé¢ï¼Œå®é™…ä¸Šå®ƒä½¿ç”¨äº†è·¨å¹³å°çš„æ–‡ä»¶ç³»ç»Ÿç›‘å¬åŒ… <a href="https://github.com/paulmillr/chokidar" target="_blank" rel="noopener noreferrer">chokidar<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼ŒåŸºäºå®ƒï¼Œä½ èƒ½åšç‚¹ä»€ä¹ˆæœ‰æ„æ€çš„äº‹æƒ…å‘¢ï¼Ÿ</p></blockquote> <blockquote><p><code>onchange</code> æœ‰ä¸ªä¸å¤ªé†’ç›®çš„ç‰¹æ€§æ˜¯ï¼Œæ–‡ä»¶ç³»ç»Ÿå‘ç”Ÿå˜åŒ–ä¹‹åï¼Œä»–åœ¨è¿è¡ŒæŒ‡å®šå‘½ä»¤ä¹‹å‰è¾“å‡ºå“ªä¸ªæ–‡ä»¶å‘ç”Ÿäº†å“ªäº›å˜åŒ–ï¼Œå¦‚ä¸‹å›¾çº¢æ¡†ä¸­çš„å†…å®¹ï¼š</p></blockquote> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/25.png" alt=""></p> <p>è¯»åˆ°è¿™é‡Œï¼Œæœ‰æ²¡æœ‰è§‰å¾— <code>onchange</code> å¯ä»¥å’Œ <code>gulp</code>ã€<code>grunt</code> çš„ <code>watch</code> ä¸€æ ·å¼ºå¤§ã€‚</p> <blockquote><p>é™¤äº†ä¸Šé¢çš„å•æµ‹é‡è·‘å’Œä»£ç æ£€æŸ¥ä¹‹å¤–ï¼Œä½ è¿˜æœ‰ä»€ä¹ˆéœ€æ±‚éœ€è¦æ”¾åœ¨ <code>onchange</code> é‡Œé¢ï¼Ÿæ¬¢è¿ç•™è¨€è®¨è®ºã€‚</p></blockquote> <blockquote><p>æœ¬èŠ‚ç”¨åˆ°çš„ä»£ç è§ <a href="https://github.com/wangshijun/automated-workflow-with-npm-script/tree/09-run-npm-script-with-onchange" target="_blank" rel="noopener noreferrer">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œæƒ³è¾¹çœ‹è¾¹åŠ¨æ‰‹ç»ƒä¹ çš„åŒå­¦å¯ä»¥æ‹‰ä¸‹æ¥è‡ªå·±æ”¹ï¼Œæ³¨æ„åˆ‡æ¢åˆ°æ­£ç¡®çš„åˆ†æ”¯ <code>09-run-npm-script-with-onchange</code>ã€‚</p></blockquote> <h2 id="_11-å®æˆ˜2-ç»“åˆ-live-reload-å®ç°è‡ªåŠ¨åˆ·æ–°"><a href="#_11-å®æˆ˜2-ç»“åˆ-live-reload-å®ç°è‡ªåŠ¨åˆ·æ–°" class="header-anchor">#</a> 11 å®æˆ˜2 ç»“åˆ live-reload å®ç°è‡ªåŠ¨åˆ·æ–°</h2> <p>å‰ç«¯å·¥ç¨‹å¸ˆæ—¥å¸¸å¼€å‘æœ€é¢‘ç¹ï¼ˆå®é™…ä¸Šæœ€æµªè´¹æ—¶é—´ï¼‰çš„æ“ä½œæ˜¯ä»€ä¹ˆï¼Ÿå¯èƒ½ä½ å·²ç»æƒ³åˆ°äº†ï¼Œå°±æ˜¯åˆ·æ–°é¡µé¢ï¼Œè¦è®©å˜æ›´ç”Ÿæ•ˆï¼Œéœ€è¦é‡æ–°åŠ è½½ï¼Œåˆ·æ–°é¡µé¢çš„æ“ä½œå°±å˜æˆäº†é‡å¤ä½æ•ˆçš„æ“ä½œã€‚</p> <p>äºæ˜¯ç¤¾åŒºé‡Œå‡ºç°äº† <a href="https://www.npmjs.com/package/livereload" target="_blank" rel="noopener noreferrer">LiveReload<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æ¥æŠŠè¿™ä¸ªè¿‡ç¨‹è‡ªåŠ¨åŒ–ï¼Œreact ç§å­é¡¹ç›®ç”Ÿæˆå·¥å…· <a href="https://github.com/facebookincubator/create-react-app" target="_blank" rel="noopener noreferrer">create-react-app<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ä¸­å°±ä½¿ç”¨äº†è¿™ç§æŠ€æœ¯ã€‚</p> <p>ä½†éšç€æŠ€æœ¯çš„æ¼”åŒ–ï¼Œåœ¨å•é¡µåº”ç”¨ä¸­åˆ·æ–°é¡µé¢æ„å‘³ç€å®¢æˆ·ç«¯çŠ¶æ€çš„å…¨éƒ¨ä¸¢å¤±ï¼Œç‰¹åˆ«æ˜¯å¤æ‚çš„å•é¡µåº”ç”¨åˆ·æ–°æ„å‘³ç€æ›´å¤§é‡çš„é‡å¤å·¥ä½œæ‰èƒ½å›åˆ°åˆ·æ–°å‰çš„çŠ¶æ€ï¼Œäºæ˜¯ç¤¾åŒºåˆæ£é¼“å‡ºäº† <a href="https://webpack.js.org/concepts/hot-module-replacement/" target="_blank" rel="noopener noreferrer">Hot Module Replacementï¼Œç®€ç§°ä¸º HMR<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œæ¯”å¦‚ä½¿ç”¨ <a href="https://github.com/vuejs/vue-cli" target="_blank" rel="noopener noreferrer">vue-cli<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> åˆ›å»ºçš„ <a href="https://github.com/vuejs-templates/webpack" target="_blank" rel="noopener noreferrer">webpack<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ç§å­é¡¹ç›®ä¸­å°±åŒ…å«è¿™ç§ç‰¹æ€§ï¼Œ<a href="https://facebook.github.io/react-native/blog/2016/03/24/introducing-hot-reloading.html" target="_blank" rel="noopener noreferrer">react-native<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ä¹Ÿå†…ç½®äº†è¿™ç§ç‰¹æ€§ï¼Œæ¥å¸®åŠ©å¼€å‘è€…æé«˜æ•ˆç‡ã€‚</p> <p>è¯»åˆ°è¿™é‡Œï¼Œä½ å¯èƒ½ä¼šå˜€å’•ï¼Œçœ‹èµ·æ¥ LiveReload å¹¶ä¸æ˜¯æœ€æ–°çš„æŠ€æœ¯ï¼Œè¿˜è®¨è®ºå®ƒå¹²å•¥ï¼Œå®é™…ä¸Šå®ƒæ˜¯è‡ªåŠ¨åˆ·æ–°æŠ€æœ¯çš„é¼»ç¥–ï¼Œåç»­çš„ HMRã€HR ç­‰éƒ½æ˜¯å®ƒçš„æ”¹è‰¯ç‰ˆï¼ŒåŠ¨æ‰‹é…ç½®ä¸‹è‡ªåŠ¨åˆ·æ–°ï¼Œä¹Ÿèƒ½è®©ä½ å¯¹è¿™äº›æŠ€æœ¯çš„åŸºæœ¬åŸç†ç•¥çŸ¥ä¸€äºŒã€‚</p> <p>ä¸‹é¢ä»‹ç»å¦‚ä½•åœ¨ç»å…¸çš„å‰ç«¯é¡¹ç›®ä¸­ï¼ˆå¼•ç”¨äº† cssã€js çš„ html é¡µé¢ï¼‰æ¥å…¥ LiveReload çš„è¯¦ç»†æ­¥éª¤ï¼š</p> <h3 id="å®‰è£…é¡¹ç›®ä¾èµ–"><a href="#å®‰è£…é¡¹ç›®ä¾èµ–" class="header-anchor">#</a> å®‰è£…é¡¹ç›®ä¾èµ–</h3> <p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å®‰è£… <a href="https://www.npmjs.com/package/livereload" target="_blank" rel="noopener noreferrer">livereload<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> å’Œ <a href="https://www.npmjs.com/package/http-server" target="_blank" rel="noopener noreferrer">http-server<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> åˆ°é¡¹ç›®ä¾èµ–ä¸­ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>npm i livereload http-server -D
# npm install livereload http-server --save-dev
# yarn add livereload http-server -D

</code></pre></div><h3 id="æ·»åŠ -npm-script"><a href="#æ·»åŠ -npm-script" class="header-anchor">#</a> æ·»åŠ  npm script</h3> <p>æŒ‰å¦‚ä¸‹æç¤ºæ·»åŠ å‘½ä»¤ï¼Œæ–¹ä¾¿æˆ‘ä»¬å¯åŠ¨ <code>LiveReload</code> æœåŠ¡å™¨å’Œé€šè¿‡ HTTP çš„æ–¹å¼è®¿é—®é¡µé¢ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>-    &quot;cover:open&quot;: &quot;scripty&quot;
+    &quot;cover:open&quot;: &quot;scripty&quot;,
+    &quot;client&quot;: &quot;npm-run-all --parallel client:*&quot;,
+    &quot;client:reload-server&quot;: &quot;livereload client/&quot;,
+    &quot;client:static-server&quot;: &quot;http-server client/&quot;

</code></pre></div><p>å…¶ä¸­ <code>client</code> å‘½ä»¤èƒ½åŒæ—¶å¯åŠ¨ <code>livereload</code> æœåŠ¡ã€é™æ€æ–‡ä»¶æœåŠ¡ã€‚</p> <blockquote><p><strong>TIP#16</strong>ï¼šå¯èƒ½æœ‰åŒå­¦ä¼šé—®ï¼Œä¸ºä»€ä¹ˆéœ€è¦å¯åŠ¨ä¸¤ä¸ªæœåŠ¡ï¼Œå…¶ä¸­ <code>http-server</code> å¯åŠ¨çš„æ˜¯é™æ€æ–‡ä»¶æœåŠ¡å™¨ï¼Œè¯¥æœåŠ¡å¯åŠ¨åå¯ä»¥é€šè¿‡ http çš„æ–¹å¼è®¿é—®æ–‡ä»¶ç³»ç»Ÿä¸Šçš„æ–‡ä»¶ï¼Œè€Œ <code>livereload</code> æ˜¯å¯åŠ¨äº†è‡ªåŠ¨åˆ·æ–°æœåŠ¡ï¼Œè¯¥æœåŠ¡è´Ÿè´£ç›‘å¬æ–‡ä»¶ç³»ç»Ÿå˜åŒ–ï¼Œå¹¶åœ¨æ–‡ä»¶ç³»ç»Ÿå˜åŒ–æ—¶é€šçŸ¥æ‰€æœ‰è¿æ¥çš„å®¢æˆ·ç«¯ï¼Œåœ¨ <code>client/index.html</code> ä¸­åµŒå…¥çš„é‚£æ®µ js å®é™…ä¸Šæ˜¯å’Œ <code>livereload-server</code> è¿æ¥çš„ä¸€ä¸ª livereload-clientã€‚</p></blockquote> <h3 id="åœ¨é¡µé¢ä¸­åµŒå…¥-livereload-è„šæœ¬"><a href="#åœ¨é¡µé¢ä¸­åµŒå…¥-livereload-è„šæœ¬" class="header-anchor">#</a> åœ¨é¡µé¢ä¸­åµŒå…¥ livereload è„šæœ¬</h3> <blockquote><p>ä¿®æ”¹ <code>client/index.html</code> åµŒå…¥ livereload è„šæœ¬ï¼ˆèƒ½å¤Ÿè¿æ¥æˆ‘ä»¬çš„ livereload æœåŠ¡ï¼‰ï¼Œdiff å¦‚ä¸‹ï¼š</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code> &lt;body&gt;
   &lt;h2&gt;LiveReload Demo&lt;/h2&gt;
+  &lt;script&gt;
+    document.write('&lt;script src=&quot;http://' + (location.host || 'localhost').split(':')[0] +
+      ':35729/livereload.js?snipver=1&quot;&gt;&lt;/' + 'script&gt;')
+  &lt;/script&gt;
 &lt;/body&gt;

</code></pre></div><blockquote><p><strong>TIP#17</strong>ï¼šlivereload æ˜¯æ”¯æŒåœ¨å¯åŠ¨æ—¶è‡ªå®šä¹‰ç«¯å£çš„ï¼Œå¦‚æœä½ ä½¿ç”¨äº†è‡ªå®šä¹‰ç«¯å£ï¼Œåœ¨é¡µé¢ä¸­åµŒå…¥çš„è¿™æ®µ js é‡Œé¢çš„ <code>35729</code> ä¹Ÿéœ€è¦æ›¿æ¢æˆå¯¹åº”çš„ç«¯å£ã€‚</p></blockquote> <h3 id="å¯åŠ¨æœåŠ¡å¹¶æµ‹è¯•"><a href="#å¯åŠ¨æœåŠ¡å¹¶æµ‹è¯•" class="header-anchor">#</a> å¯åŠ¨æœåŠ¡å¹¶æµ‹è¯•</h3> <p>æœ€åï¼Œè¿è¡Œ <code>npm run client</code> ä¹‹åï¼Œæˆªå›¾å¦‚ä¸‹ï¼Œæ³¨æ„ä¸¤ä¸ªçº¢æ¡†é‡Œé¢çš„è¾“å‡ºè¡¨ç¤ºæœåŠ¡å¯åŠ¨æˆåŠŸï¼š</p> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/26.png" alt=""></p> <p>ç„¶åï¼Œæ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š<code>http://localhost:8080</code>ï¼Œæ¥ç€ä¿®æ”¹ <code>client/main.css</code> å¹¶ä¿å­˜ï¼ˆ<strong>åˆ«å¿˜äº†ä¿å­˜</strong>ï¼‰ï¼Œä½ ä¼šå‘ç°æµè§ˆå™¨è‡ªåŠ¨åˆ·æ–°äº†</p> <blockquote><p><strong>TIP#18</strong>ï¼šæœ‰ä»£ç æ´ç™–çš„åŒå­¦å¯èƒ½ä¼šé—®ï¼Œåœ¨é¡µé¢ä¸­åµŒå…¥çš„é‚£æ®µ js åœ¨çº¿ä¸Šç¯å¢ƒå’‹åŠï¼Ÿå®é™…ä¸Šåœ¨åµŒå…¥è¿™æ®µè„šæœ¬çš„æ—¶å€™å¯ä»¥é€šè¿‡ç®€å•çš„æ‰‹æ®µï¼ˆæ¯”å¦‚åˆ¤æ–­ <code>location.hostname</code>ï¼‰å»æ£€æŸ¥å½“å‰é¡µé¢è¿è¡Œç¯å¢ƒï¼Œå¦‚æœæ˜¯çº¿ä¸Šç¯å¢ƒå°±ä¸åµŒå…¥äº†ï¼Œæˆ–è€…ä½¿ç”¨æ‰“åŒ…å·¥å…·å¤„ç† html æ–‡ä»¶ï¼Œä¸Šçº¿å‰ç›´æ¥å»æ‰å³å¯ã€‚</p></blockquote> <blockquote><p>æœ¬èŠ‚ç”¨åˆ°çš„ä»£ç è§ <a href="https://github.com/wangshijun/automated-workflow-with-npm-script/tree/10-livereload-with-npm-script" target="_blank" rel="noopener noreferrer">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œæƒ³è¾¹çœ‹è¾¹åŠ¨æ‰‹ç»ƒä¹ çš„åŒå­¦å¯ä»¥æ‹‰ä¸‹æ¥è‡ªå·±æ”¹ï¼Œæ³¨æ„åˆ‡æ¢åˆ°æ­£ç¡®çš„åˆ†æ”¯ <code>10-livereload-with-npm-script</code>ã€‚</p></blockquote> <h2 id="_12-å®æˆ˜3-åœ¨-git-hooks-ä¸­è¿è¡Œ-npm-script"><a href="#_12-å®æˆ˜3-åœ¨-git-hooks-ä¸­è¿è¡Œ-npm-script" class="header-anchor">#</a> 12 å®æˆ˜3 åœ¨ git hooks ä¸­è¿è¡Œ npm script</h2> <p>ä¸¥è‚ƒçš„ç ”å‘å›¢é˜Ÿéƒ½ä¼šä½¿ç”¨ Git ä¹‹ç±»çš„ç‰ˆæœ¬ç®¡ç†ç³»ç»Ÿæ¥ç®¡ç†ä»£ç ï¼Œéšç€ GitHub çš„å¹¿å—æ¬¢è¿ï¼Œç›¸ä¿¡å¤§å®¶å¯¹ Git å¹¶ä¸é™Œç”Ÿã€‚Git åœ¨ä»£ç ç‰ˆæœ¬ç®¡ç†ä¹‹å¤–ï¼Œä¹Ÿæä¾›äº†ç±»ä¼¼ <code>npm script</code> é‡Œ <code>pre</code>ã€<code>post</code> çš„é’©å­æœºåˆ¶ï¼Œå«åš <a href="https://git-scm.com/book/gr/v2/Customizing-Git-Git-Hooks" target="_blank" rel="noopener noreferrer">Git Hooks<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œé’©å­æœºåˆ¶èƒ½è®©æˆ‘ä»¬åœ¨ä»£ç  commitã€push ä¹‹å‰ï¼ˆåï¼‰åšè‡ªå·±æƒ³åšçš„äº‹æƒ…ã€‚</p> <blockquote><p>Git Hooks èƒ½ç»™æˆ‘ä»¬çš„å¼€å‘å·¥ä½œæµå¸¦æ¥å“ªäº›å¯èƒ½å‘¢ï¼Ÿæˆ‘å¸¦çš„å›¢é˜Ÿä¸­ï¼Œå¤§éƒ¨åˆ†é¡¹ç›®é€šè¿‡ npm script ä¸ºæœ¬åœ°ä»“åº“é…ç½®äº† <code>pre-commit</code>ã€<code>pre-push</code> é’©å­æ£€æŸ¥ï¼Œä¸”æ­£è®¡åˆ’ä¸ºè¿œç¨‹ä»“åº“ï¼ˆ<a href="https://git-scm.com/book/en/v1/Git-Basics-Working-with-Remotes" target="_blank" rel="noopener noreferrer">Remotes<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼‰é…ç½® <code>pre-receive</code> é’©å­æ£€æŸ¥ã€‚ä¸¤ç§é’©å­çš„æ£€æŸ¥ç›®çš„å„ä¸ç›¸åŒï¼Œæœ¬åœ°æ£€æŸ¥æ˜¯ä¸ºäº†å°½æ—©ç»™æäº¤ä»£ç çš„åŒå­¦åé¦ˆï¼Œå“ªäº›åœ°æ–¹ä¸ç¬¦åˆè§„èŒƒï¼Œå“ªäº›åœ°æ–¹éœ€è¦æ³¨æ„ï¼›è€Œè¿œç¨‹æ£€æŸ¥æ˜¯ä¸ºäº†ç¡®ä¿è¿œç¨‹ä»“åº“æ”¶åˆ°çš„ä»£ç æ˜¯ç¬¦åˆå›¢é˜Ÿçº¦å®šçš„è§„èŒƒçš„ï¼Œå› ä¸ºå¦‚æœæ²¡æœ‰è¿œç¨‹æ£€æŸ¥ç¯èŠ‚ï¼Œç†Ÿæ‚‰ Git çš„åŒå­¦ä½¿ç”¨ <code>--no-verify</code>ï¼ˆç®€å†™ä¸º <code>-n</code>ï¼‰ å‚æ•°è·³è¿‡æœ¬åœ°æ£€æŸ¥æ—¶ï¼Œæœ¬åœ°æ£€æŸ¥å°±å½¢åŒè™šè®¾ã€‚</p></blockquote> <p>å¯èƒ½æœ‰åŒå­¦ä¼šå˜€å’•ï¼Œåœ¨ IDE é‡Œé¢é…ç½®å„ç§æ£€æŸ¥éš¾é“è¿˜ä¸å¤Ÿä¹ˆï¼Ÿå¯¹ä¸ªäººå¼€å‘è€…æ¥è¯´è¶³å¤Ÿäº†ï¼Œä½†å¯¹äºå›¢é˜Ÿï¼Œå¦‚æœå¯¹ä»£ç é‡Œé¢çš„åå‘³é“å¬ä¹‹ä»»ä¹‹ï¼Œä¹…è€Œä¹…ä¹‹æ•´ä¸ªå›¢é˜Ÿçš„ä»£ç è´¨é‡æ ‡å‡†éƒ½ä¼šè¢«æ‹‰ä½ï¼Œåˆ°æœ€åå‘çš„è¿˜æ˜¯å›¢é˜Ÿçš„æ¯ä¸ªæˆå‘˜ï¼Œä¸æ˜¯ä¹ˆï¼Ÿä¹‹å‰æ²¡æƒ³åˆ°è¿™å±‚çš„åŒå­¦å»ºè®®å»çœ‹çœ‹ç ´çª—ç†è®ºã€‚</p> <p>é‚£ä¹ˆå¢åŠ  <code>Git Hooks</code> çš„å¿…è¦æ€§èŠæ¸…æ¥šäº†ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨ <code>Git Hooks</code> é‡Œé¢åšå“ªäº›äº‹æƒ…å‘¢ï¼Ÿé€šå¸¸æ¥è¯´ï¼šæ£€æŸ¥ç¼–ç è§„èŒƒï¼ŒæŠŠä½çº§é”™è¯¯è¶æ—©æŒ–å‡ºæ¥ä¿®å¥½ï¼›è¿è¡Œæµ‹è¯•ï¼Œç”¨è‡ªåŠ¨åŒ–çš„æ–¹æ³•åšåŠŸèƒ½å›å½’ï¼Œæµ‹è¯•æœ¬èº«å°±åŒ…å«å¾ˆå¤šè¯é¢˜ï¼Œä¸”æŒ‰ä¸‹ä¸è¡¨ã€‚</p> <blockquote><p>å‰ç«¯ç¤¾åŒºé‡Œæœ‰å¤šç§ç»“åˆ <code>npm script</code> å’Œ <code>git-hooks</code> çš„æ–¹æ¡ˆï¼Œæ¯”å¦‚ <a href="https://github.com/observing/pre-commit" target="_blank" rel="noopener noreferrer">pre-commit<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€<a href="https://github.com/typicode/husky" target="_blank" rel="noopener noreferrer">husky<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œç›¸æ¯”è¾ƒè€Œè¨€ <code>husky</code> æ›´å¥½ç”¨ï¼Œå®ƒæ”¯æŒæ›´å¤šçš„ <code>Git Hooks</code> ç§ç±»ï¼Œå†ç»“åˆ <a href="https://github.com/okonet/lint-staged" target="_blank" rel="noopener noreferrer">lint-staged<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> è¯•ç”¨å°±æ›´æºœã€‚</p></blockquote> <p>æ¥ä¸‹æ¥æˆ‘ä»¬é€æ­¥ç»™ç¤ºä¾‹é¡¹ç›®é…ç½®æœ¬åœ°çš„ <code>Git Hooks</code>ï¼Œè€Œåœ¨é’©å­ä¸­è¿è¡Œçš„æ˜¯å·²æœ‰çš„ <code>npm script</code>ï¼Œæ¯”å¦‚ <code>lint</code>ã€<code>test</code>ï¼š</p> <h3 id="å®‰è£…é¡¹ç›®ä¾èµ–-2"><a href="#å®‰è£…é¡¹ç›®ä¾èµ–-2" class="header-anchor">#</a> å®‰è£…é¡¹ç›®ä¾èµ–</h3> <p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å®‰è£… <code>husky</code>ã€<code>lint-staged</code> åˆ°é¡¹ç›®ä¾èµ–ä¸­ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>npm i husky lint-staged -D
# npm install husky lint-staged --save-dev
# yarn add husky lint-staged -D

</code></pre></div><blockquote><p><code>husky</code> çš„åŸºæœ¬å·¥ä½œåŸç†å¯ä»¥ç¨ä½œè§£é‡Šä¸‹ï¼Œç¿»çœ‹ <code>husky</code> çš„ <a href="https://github.com/typicode/husky/blob/master/package.json" target="_blank" rel="noopener noreferrer">package.json<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œæ³¨æ„å…¶ä¸­çš„ <code>scripts</code> å£°æ˜ï¼š</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>  &quot;scripts&quot;: {
    &quot;test&quot;: &quot;jest&quot;,
    &quot;format&quot;: &quot;prettier --single-quote --no-semi --write **/*.js&quot;,
    &quot;install&quot;: &quot;node ./bin/install.js&quot;,
    &quot;uninstall&quot;: &quot;node ./bin/uninstall.js&quot;
  },

</code></pre></div><p>è¿™é‡Œé¢çš„ <code>install</code> å°±æ˜¯ä½ åœ¨é¡¹ç›®ä¸­å®‰è£… <code>husky</code> æ—¶æ‰§è¡Œçš„è„šæœ¬ï¼ˆæ‰€æœ‰çš„é­”æ³•éƒ½è—åœ¨åœ¨è¿™é‡Œäº†ï¼Œå“ˆå“ˆï¼‰ã€‚</p> <p>ç„¶åå†æ£€æŸ¥æˆ‘ä»¬ä»“åº“çš„ <code>.git/hooks</code> ç›®å½•ï¼Œä¼šå‘ç°é‡Œé¢çš„é’©å­éƒ½è¢« <code>husky</code> æ›¿æ¢æ‰äº†ï¼Œæ³¨æ„ä¸‹å›¾ä¸­ä¸‰ä¸ªçº¢è‰²æ¡†ä¸­çš„å†…å®¹ï¼š</p> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/27.png" alt=""></p> <h3 id="æ·»åŠ -npm-script-2"><a href="#æ·»åŠ -npm-script-2" class="header-anchor">#</a> æ·»åŠ  npm script</h3> <p>æ¥ä¸‹æ¥éœ€è¦åœ¨ <code>scripts</code> å¯¹è±¡ä¸­å¢åŠ  <code>husky</code> èƒ½è¯†åˆ«çš„ <code>Git Hooks</code> è„šæœ¬ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>   &quot;scripts&quot;: {
+    &quot;precommit&quot;: &quot;npm run lint&quot;,
+    &quot;prepush&quot;: &quot;npm run test&quot;,
     &quot;lint&quot;: &quot;npm-run-all --parallel lint:*&quot;,
     &quot;lint:js&quot;: &quot;eslint *.js&quot;,

</code></pre></div><blockquote><p>è¿™ä¸¤ä¸ªå‘½ä»¤çš„ä½œç”¨æ˜¯åœ¨ä»£ç æäº¤å‰è¿è¡Œæ‰€æœ‰çš„ä»£ç æ£€æŸ¥ <code>npm run lint</code>ï¼›åœ¨ä»£ç  <code>push</code> åˆ°è¿œç¨‹ä¹‹å‰ï¼Œè¿è¡Œ <code>lint</code> å’Œè‡ªåŠ¨åŒ–æµ‹è¯•ï¼ˆ<strong>è¨€å¤–ä¹‹æ„ï¼Œå¦‚æœæµ‹è¯•å¤±è´¥ï¼Œpush å°±ä¸ä¼šæˆåŠŸ</strong>ï¼‰ï¼Œè™½ç„¶è¿è¡Œçš„æ˜¯ <code>npm run test</code>ï¼Œä½†æ˜¯ lint ä¹Ÿé…ç½®åœ¨äº† <code>pretest</code> é‡Œé¢ã€‚</p></blockquote> <p>ç„¶åå°è¯•æäº¤ä»£ç ï¼š<code>git commit -am 'add husky hooks'</code>ï¼Œèƒ½çœ‹åˆ° <code>pre-commit</code> é’©å­å·²ç»ç”Ÿæ•ˆï¼š</p> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/28.png" alt=""></p> <h3 id="ç”¨-lint-staged-æ”¹è¿›-pre-commit"><a href="#ç”¨-lint-staged-æ”¹è¿›-pre-commit" class="header-anchor">#</a> ç”¨ lint-staged æ”¹è¿› pre-commit</h3> <p>å¦‚ä¸Šçš„é…ç½®ä¹çœ‹èµ·æ¥æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œä½†æ˜¯åœ¨å¤§å‹é¡¹ç›®ã€é—ç•™é¡¹ç›®ä¸­æ¥å…¥è¿‡ lint å·¥ä½œæµçš„åŒå­¦å¯èƒ½æ·±æœ‰ä½“ä¼šï¼Œæ¯æ¬¡æäº¤ä»£ç ä¼šæ£€æŸ¥æ‰€æœ‰çš„ä»£ç ï¼Œå¯èƒ½æ¯”è¾ƒæ…¢å°±ä¸è¯´äº†ï¼Œæ¥å…¥åˆæœŸ lint å·¥å…·å¯èƒ½ä¼šæŠ¥å‘Šå‡ ç™¾ä¸Šåƒä¸ªé”™è¯¯ï¼Œè¿™æ—¶å€™ä¼°è®¡å¤§å¤šæ•°äººå†…å¿ƒæ˜¯å´©æºƒçš„ï¼Œå°¤å…¶æ˜¯å½“ä½ æ˜¯æ–°è§„èŒƒçš„æ¨è¿›è€…ï¼Œé‡åˆ°çš„é˜»åŠ›ä¼šå¢å¤§å¥½å‡ å€ï¼Œæ¯•ç«Ÿå¤§å¤šæ•°äººä¸æ„¿æ„èƒŒåˆ«äººçš„é”…ï¼Œåç¬‘ã€‚</p> <p>å¥½åœ¨ï¼Œæˆ‘ä»¬æœ‰ <code>lint-staged</code> æ¥ç¯èŠ‚è¿™ä¸ªé—®é¢˜ï¼Œæ¯ä¸ªå›¢é˜Ÿæˆå‘˜æäº¤çš„æ—¶å€™ï¼Œåªæ£€æŸ¥å½“æ¬¡æ”¹åŠ¨çš„æ–‡ä»¶ï¼Œå…·ä½“æ”¹åŠ¨å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>   &quot;scripts&quot;: {
-    &quot;precommit&quot;: &quot;npm run lint&quot;,
+    &quot;precommit&quot;: &quot;lint-staged&quot;,
     &quot;prepush&quot;: &quot;npm run test&quot;,
     &quot;lint&quot;: &quot;npm-run-all --parallel lint:*&quot;,
   },
+  &quot;lint-staged&quot;: {
+    &quot;*.js&quot;: &quot;eslint&quot;,
+    &quot;*.less&quot;: &quot;stylelint&quot;,
+    &quot;*.css&quot;: &quot;stylelint&quot;,
+    &quot;*.json&quot;: &quot;jsonlint --quiet&quot;,
+    &quot;*.md&quot;: &quot;markdownlint --config .markdownlint.json&quot;
+  },
   &quot;keywords&quot;: [],

</code></pre></div><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ•…æ„åœ¨ <code>index.js</code> ä¸­å¼•å…¥é”™è¯¯ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>-  return NaN;
+  return NaN

</code></pre></div><p>ç„¶åå°è¯•æäº¤è¿™ä¸ªæ–‡ä»¶ï¼š<code>git commit -m 'try to add eslint error' index.js</code>ï¼Œç»“æœå¦‚ä¸‹å›¾ï¼š</p> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/29.png" alt=""></p> <p>ä¸Šå›¾ä¸­å¸¦æœ‰ <code>Running Tasks</code> å­—æ ·çš„åˆ—è¡¨å°±æ˜¯ <code>lint-staged</code> æ ¹æ®å½“å‰è¦æäº¤çš„æ–‡ä»¶å’Œ <code>package.json</code> ä¸­é…ç½®çš„æ£€æŸ¥å‘½ä»¤å»æ‰§è¡Œçš„åŠ¨æ€è¾“å‡ºã€‚çº¢è‰²æ¡†é‡Œé¢æç¤º <code>husky</code> çš„ <code>pre-commit</code> é’©å­æ‰§è¡Œå¤±è´¥ï¼Œæäº¤ä¹Ÿå°±æ²¡æœ‰æˆåŠŸã€‚</p> <p>å…³äº <code>lint-staged</code> è¿˜æœ‰äº›é«˜çº§çš„ç”¨æ³•ï¼Œæ¯”å¦‚å¯¹å•ä¸ªæ–‡ä»¶æ‰§è¡Œå¤šæ¡å‘½ä»¤ï¼Œå¯¹å•ä¸ªæ–‡ä»¶åŠ¨æ€è‡ªåŠ¨ä¿®å¤ï¼Œè‡ªåŠ¨æ ¼å¼åŒ–ç­‰ç­‰ï¼Œç•™å¾…å¤§å®¶è‡ªå·±å»æ¢ç´¢å¥½äº†ã€‚</p> <p>æ’¤é”€æ‰æœ‰é”™è¯¯çš„ä¿®æ”¹ï¼Œæäº¤ä¹‹åï¼Œæˆ‘ä»¬å¾€è¿œç¨‹ <code>push</code> æ–°åˆ†æ”¯ï¼Œç»“æœå¦‚ä¸‹å›¾ï¼š</p> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/30.png" alt=""></p> <blockquote><p>è¯»è¿‡æˆ‘å…¶ä»–æ–‡ç« çš„åŒå­¦å¯èƒ½å·²ç»æƒ³åˆ°ï¼Œæœ¬å°èŠ‚çš„å†…å®¹éƒ¨åˆ†å’Œæˆ‘æ—©æœŸçš„æ–‡ç« <a href="https://juejin.im/post/592615580ce463006bf19aa0" target="_blank" rel="noopener noreferrer">ã€Šç”¨ husky å’Œ lint-staged æ„å»ºè¶…æºœçš„ä»£ç æ£€æŸ¥å·¥ä½œæµã€‹<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>æœ‰éƒ¨åˆ†å†…å®¹æ˜¯é‡å çš„ã€‚</p></blockquote> <blockquote><p>æœ¬èŠ‚ç”¨åˆ°çš„ä»£ç è§ <a href="https://github.com/wangshijun/automated-workflow-with-npm-script/tree/11-run-npm-script-in-git-hooks" target="_blank" rel="noopener noreferrer">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œæƒ³è¾¹çœ‹è¾¹åŠ¨æ‰‹ç»ƒä¹ çš„åŒå­¦å¯ä»¥æ‹‰ä¸‹æ¥è‡ªå·±æ”¹ï¼ˆ<strong>è®°å¾—å®‰è£… npm ä¾èµ–ä¹‹åå†è¿è¡Œè„šæœ¬</strong>ï¼‰ï¼Œæ³¨æ„åˆ‡æ¢åˆ°æ­£ç¡®çš„åˆ†æ”¯ <code>11-run-npm-script-in-git-hooks</code>ã€‚</p></blockquote> <h2 id="_13-å®æˆ˜4-ç”¨-npm-script-å®ç°æ„å»ºæµæ°´çº¿"><a href="#_13-å®æˆ˜4-ç”¨-npm-script-å®ç°æ„å»ºæµæ°´çº¿" class="header-anchor">#</a> 13 å®æˆ˜4 ç”¨ npm script å®ç°æ„å»ºæµæ°´çº¿</h2> <p>åœ¨ç°ä»£å‰ç«¯é¡¹ç›®çš„äº¤ä»˜å·¥ä½œæµä¸­ï¼Œéƒ¨ç½²å‰æœ€å…³é”®çš„ç¯èŠ‚å°±æ˜¯æ„å»ºï¼Œæ„å»ºç¯èŠ‚è¦å®Œæˆçš„äº‹æƒ…é€šå¸¸åŒ…æ‹¬ï¼š</p> <ul><li>æºä»£ç é¢„ç¼–è¯‘ï¼šæ¯”å¦‚ <code>less</code>ã€<code>sass</code>ã€<code>typescript</code>ï¼›</li> <li>å›¾ç‰‡ä¼˜åŒ–ã€é›ªç¢§å›¾ç”Ÿæˆï¼›</li> <li>JSã€CSS åˆå¹¶ã€å‹ç¼©ï¼›</li> <li>é™æ€èµ„æºåŠ ç‰ˆæœ¬å·å’Œå¼•ç”¨æ›¿æ¢ï¼›</li> <li>é™æ€èµ„æºä¼  CDN ç­‰ã€‚</li></ul> <p>ç°åœ¨å¤§å¤šæ•°åŒå­¦æ‰€æ¥è§¦çš„é¡¹ç›®æ„å»ºè¿‡ç¨‹å¯èƒ½éƒ½æ˜¯åˆ«äººé…ç½®å¥½çš„ï¼Œä½†æ˜¯å¯¹äºæ„å»ºè¿‡ç¨‹ä¸­çš„æŸäº›è€ƒé‡å¯èƒ½å¹¶ä¸æ˜¯å¾ˆæ¸…æ¥šã€‚</p> <p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ç»„åˆ npm script å’Œç®€å•çš„å‘½ä»¤è¡Œå·¥å…·ä¸ºå®é™…é¡¹ç›®æ·»åŠ æ„å»ºè¿‡ç¨‹ï¼Œä»¥åŠ æ·±å¯¹æ„å»ºè¿‡ç¨‹çš„ç†è§£ï¼ŒåŒæ—¶ä¹Ÿä¼šç”¨åˆ°å‰é¢å¾ˆå¤šç« èŠ‚çš„çŸ¥è¯†ç‚¹ã€‚</p> <h3 id="é¡¹ç›®ç›®å½•ç»“æ„"><a href="#é¡¹ç›®ç›®å½•ç»“æ„" class="header-anchor">#</a> é¡¹ç›®ç›®å½•ç»“æ„</h3> <p>å¯¹ä¹‹å‰çš„ç¤ºä¾‹é¡¹ç›®åšç®€å•æ”¹é€ ï¼Œè®©ç›®å½•ç»“æ„åŒ…æ‹¬å…¸å‹çš„å‰ç«¯é¡¹ç›®èµ„æºå¼•ç”¨æƒ…å†µï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>client
â”œâ”€â”€ images
â”‚Â Â  â””â”€â”€ schedule.png
â”œâ”€â”€ index.html
â”œâ”€â”€ scripts
â”‚Â Â  â””â”€â”€ main.js
â””â”€â”€ styles
    â””â”€â”€ main.css

</code></pre></div><p>å¯èƒ½çš„èµ„æºä¾èµ–å…³ç³»å¦‚ä¸‹ï¼š</p> <ul><li><code>css</code>ã€<code>html</code> æ–‡ä»¶ä¸­å¼•ç”¨äº†å›¾ç‰‡ï¼›</li> <li><code>html</code> æ–‡ä»¶ä¸­å¼•ç”¨äº† <code>css</code>ã€<code>js</code>ï¼›</li></ul> <p>æ˜¾è€Œæ˜“è§ï¼Œæˆ‘ä»¬çš„æ„å»ºè¿‡ç¨‹å¿…é¡»éµå¾ªä¸‹é¢çš„æ­¥éª¤æ‰èƒ½ä¸å‡ºé”™ï¼š</p> <ol><li>å‹ç¼©å›¾ç‰‡ï¼›</li> <li>ç¼–è¯‘ lessã€å‹ç¼© cssï¼›</li> <li>ç¼–è¯‘ã€å‹ç¼© jsï¼›</li> <li>ç»™å›¾ç‰‡åŠ ç‰ˆæœ¬å·å¹¶æ›¿æ¢ jsã€css ä¸­çš„å¼•ç”¨ï¼›</li> <li>ç»™ jsã€css åŠ ç‰ˆæœ¬å·å¹¶æ›¿æ¢ html ä¸­çš„å¼•ç”¨ï¼›</li></ol> <h3 id="æ·»åŠ æ„å»ºè¿‡ç¨‹"><a href="#æ·»åŠ æ„å»ºè¿‡ç¨‹" class="header-anchor">#</a> æ·»åŠ æ„å»ºè¿‡ç¨‹</h3> <p>ä¸‹é¢ä»‹ç»å¦‚ä½•ç»“åˆ <code>npm script</code> æ­£ç¡®çš„ç»™è¿™æ ·çš„é¡¹ç›®ç»“æ„åŠ ä¸Šæ„å»ºè¿‡ç¨‹ã€‚</p> <p><strong>1. å‡†å¤‡æ„å»ºç›®å½•</strong></p> <p>æˆ‘ä»¬çº¦å®šæ„å»ºäº§ç”Ÿçš„ç»“æœä»£ç ï¼Œæ”¾åœ¨ <code>dist</code> ç›®å½•ä¸‹ï¼Œä¸ <code>client</code> çš„ç»“æ„å®Œå…¨ç›¸åŒï¼Œæ¯æ¬¡æ„å»ºå‰ï¼Œæ¸…ç©ºä¹‹å‰çš„æ„å»ºç›®å½•ï¼Œåˆ©ç”¨ npm çš„é’©å­æœºåˆ¶æ·»åŠ  <code>prebuild</code> å‘½ä»¤å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>-    &quot;client:static-server&quot;: &quot;http-server client/&quot;
+    &quot;client:static-server&quot;: &quot;http-server client/&quot;,
+    &quot;prebuild&quot;: &quot;rm -rf dist &amp;&amp; mkdir -p dist/{images,styles,scripts}&quot;,

</code></pre></div><h3 id="å‡†å¤‡è„šæœ¬ç›®å½•"><a href="#å‡†å¤‡è„šæœ¬ç›®å½•" class="header-anchor">#</a> å‡†å¤‡è„šæœ¬ç›®å½•</h3> <p>æ„å»ºè¿‡ç¨‹éœ€è¦çš„å‘½ä»¤ç¨é•¿ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>scripty</code> æ¥æŠŠè¿™äº›è„šæœ¬å‰¥ç¦»åˆ°å•ç‹¬çš„æ–‡ä»¶ä¸­ï¼Œä¸ºæ­¤éœ€è¦å‡†å¤‡å•ç‹¬çš„ç›®å½•ï¼Œå¹¶ä¸”æˆ‘ä»¬çš„æ„å»ºè¿‡ç¨‹åˆ†ä¸ºï¼š<code>images</code>ã€<code>styles</code>ã€<code>scripts</code>ã€<code>hash</code> å››ä¸ªæ­¥éª¤ï¼Œæ¯ä¸ªæ­¥éª¤å‡†å¤‡å•ç‹¬çš„æ–‡ä»¶ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>mkdir scripts/build
touch scripts/build.sh
touch scripts/build/{images,styles,scripts}.sh
chmod -R a+x scripts

</code></pre></div><p><strong>è„šæœ¬æ–‡ä»¶çš„å¯æ‰§è¡Œæƒé™å¿…é¡»æ·»åŠ æ­£ç¡®ï¼Œå¦åˆ™ scripty ä¼šç›´æ¥æŠ¥é”™</strong>ï¼Œä¸Šé¢å‘½ä»¤æ‰§è¡Œå®Œä¹‹åï¼Œ<code>scripts</code> ç›®å½•åŒ…å«å¦‚ä¸‹å†…å®¹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>scripts
â”œâ”€â”€ build
â”‚Â Â  â”œâ”€â”€ hash.sh
â”‚Â Â  â”œâ”€â”€ images.sh
â”‚Â Â  â”œâ”€â”€ scripts.sh
â”‚Â Â  â””â”€â”€ styles.sh
â”œâ”€â”€ build.sh

</code></pre></div><h3 id="å›¾ç‰‡æ„å»ºè¿‡ç¨‹"><a href="#å›¾ç‰‡æ„å»ºè¿‡ç¨‹" class="header-anchor">#</a> å›¾ç‰‡æ„å»ºè¿‡ç¨‹</h3> <p>å›¾ç‰‡æ„å»ºçš„ç»å…¸å·¥å…·æ˜¯ <a href="https://github.com/imagemin/imagemin" target="_blank" rel="noopener noreferrer">imagemin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œå®ƒä¹Ÿæä¾›äº†å‘½ä»¤è¡Œç‰ˆæœ¬ <a href="https://github.com/imagemin/imagemin-cli" target="_blank" rel="noopener noreferrer">imagemin-cli<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œé¦–å…ˆå®‰è£…ä¾èµ–ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>npm i imagemin-cli -D
# npm install imagemin-cli --save-dev
# yarn add imagemin-cli -D

</code></pre></div><p>ç„¶ååœ¨ scripts/build/images.sh ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>imagemin client/images/* --out-dir=dist/images

</code></pre></div><p>ç„¶ååœ¨ <code>package.json</code> ä¸­æ·»åŠ  <code>build:images</code> å‘½ä»¤ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>+    &quot;build:images&quot;: &quot;scripty&quot;,

</code></pre></div><p>å°è¯•è¿è¡Œ <code>npm run prebuild &amp;&amp; npm run build:images</code>ï¼Œç„¶åè§‚å¯Ÿ <code>dist</code> ç›®å½•çš„å˜åŒ–ã€‚</p> <h3 id="æ ·å¼æ„å»ºè¿‡ç¨‹"><a href="#æ ·å¼æ„å»ºè¿‡ç¨‹" class="header-anchor">#</a> æ ·å¼æ„å»ºè¿‡ç¨‹</h3> <p>æˆ‘ä»¬ä½¿ç”¨ <a href="http://lesscss.org/usage/" target="_blank" rel="noopener noreferrer">less<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ç¼–å†™æ ·å¼ï¼Œæ‰€ä»¥éœ€è¦é¢„ç¼–è¯‘æ ·å¼ä»£ç ï¼Œå¯ä»¥ä½¿ç”¨ less å®˜æ–¹åº“è‡ªå¸¦çš„å‘½ä»¤è¡Œå·¥å…· lesscï¼Œä½¿ç”¨ sass çš„åŒå­¦å¯ä»¥ç›´æ¥ä½¿ç”¨ <a href="https://github.com/sass/node-sass" target="_blank" rel="noopener noreferrer">node-sass<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚æ­¤å¤–ï¼Œæ ·å¼é¢„ç¼–è¯‘å®Œæˆä¹‹åï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ <a href="https://www.npmjs.com/package/cssmin" target="_blank" rel="noopener noreferrer">cssmin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æ¥å®Œæˆä»£ç é¢„å‹ç¼©ã€‚é¦–å…ˆå®‰è£…ä¾èµ–ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>npm i cssmin -D
# npm install cssmin --save-dev
# yarn add cssmin -D

</code></pre></div><blockquote><p>ç„¶ååœ¨ <code>scripts/build/styles.sh</code> ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨åˆ°äº† <code>shell</code> é‡Œé¢çš„ç®¡é“æ“ä½œç¬¦ <code>|</code> å’Œè¾“å‡ºé‡å®šå‘ <code>&gt;</code>ï¼š</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>for file in client/styles/*.css
do
  lessc $file | cssmin &gt; dist/styles/$(basename $file)
done

</code></pre></div><p>ç„¶ååœ¨ <code>package.json</code> ä¸­æ·»åŠ  <code>build:styles</code> å‘½ä»¤ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>+    &quot;build:styles&quot;: &quot;scripty&quot;,

</code></pre></div><p>å°è¯•è¿è¡Œ <code>npm run prebuild &amp;&amp; npm run build:styles</code>ï¼Œç„¶åè§‚å¯Ÿ <code>dist</code> ç›®å½•çš„å˜åŒ–ï¼Œåº”è¯¥èƒ½çœ‹åˆ° <code>less</code> ç¼–è¯‘ä¹‹åå†è¢«å‹ç¼©çš„ <code>css</code> ä»£ç ã€‚</p> <h3 id="js-æ„å»ºè¿‡ç¨‹"><a href="#js-æ„å»ºè¿‡ç¨‹" class="header-anchor">#</a> JS æ„å»ºè¿‡ç¨‹</h3> <p>æˆ‘ä»¬ä½¿ç”¨ <code>ES6</code> ç¼–å†™ <code>JS</code> ä»£ç ï¼Œæ‰€ä»¥éœ€è¦ <a href="https://github.com/mishoo/UglifyJS2/tree/harmony" target="_blank" rel="noopener noreferrer">uglify-es<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æ¥è¿›è¡Œä»£ç å‹ç¼©ï¼Œå¦‚æœä½ ä¸ä½¿ç”¨ ES6ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ <a href="https://github.com/mishoo/UglifyJS2" target="_blank" rel="noopener noreferrer">uglify-js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æ¥å‹ç¼©ä»£ç ï¼Œé¦–å…ˆå®‰è£…ä¾èµ–ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>npm i uglify-es -D
# npm install uglify-es --save-dev
# yarn add uglify-es -D

</code></pre></div><blockquote><p>ç„¶ååœ¨ <code>scripts/build/scripts.sh</code>ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼Œ<strong>éœ€è¦é¢å¤–æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æŒ‡å®š uglify-es ç›®å½•ä¸‹çš„ bin æ–‡ä»¶ï¼Œå¦åˆ™è¯†åˆ«ä¸äº† ES6 è¯­æ³•</strong>ï¼Œå› ä¸º <code>uglify-es</code> åœ¨ <code>npm install</code> è¿‡ç¨‹è‡ªåŠ¨åˆ›å»ºçš„è½¯é“¾æ˜¯é”™è¯¯çš„ã€‚</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>for file in client/scripts/*.js
do
  ./node_modules/uglify-es/bin/uglifyjs $file --mangle &gt; dist/scripts/$(basename $file)
done

</code></pre></div><p>ç„¶ååœ¨ <code>package.json</code> ä¸­æ·»åŠ  <code>build:scripts</code> å‘½ä»¤ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>+    &quot;build:scripts&quot;: &quot;scripty&quot;,

</code></pre></div><blockquote><p>å°è¯•è¿è¡Œ <code>npm run prebuild &amp;&amp; npm run build:scripts</code>ï¼Œç„¶åè§‚å¯Ÿ <code>dist</code> ç›®å½•çš„å˜åŒ–ï¼Œåº”è¯¥èƒ½çœ‹åˆ°è¢« <code>uglify-es</code> å‹ç¼©åçš„ä»£ç ã€‚</p></blockquote> <blockquote><p><strong>TIP#19</strong>ï¼šuglify-es æ”¯æŒå¾ˆå¤šå…¶ä»–çš„é€‰é¡¹ï¼Œä»¥åŠ sourcemapï¼Œå¯¹ JS ä»£ç åšæè‡´çš„ä¼˜åŒ–ï¼Œè¯¦ç»†<a href="https://github.com/mishoo/UglifyJS2/tree/harmony#command-line-options" target="_blank" rel="noopener noreferrer">å‚è€ƒ<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <h3 id="èµ„æºç‰ˆæœ¬å·å’Œå¼•ç”¨æ›¿æ¢"><a href="#èµ„æºç‰ˆæœ¬å·å’Œå¼•ç”¨æ›¿æ¢" class="header-anchor">#</a> èµ„æºç‰ˆæœ¬å·å’Œå¼•ç”¨æ›¿æ¢</h3> <p>ç»™é™æ€èµ„æºåŠ ç‰ˆæœ¬å·çš„åŸå› æ˜¯çº¿ä¸Šç¯å¢ƒçš„é™æ€èµ„æºé€šå¸¸éƒ½æ”¾åœ¨ CDN ä¸Šï¼Œæˆ–è€…è®¾ç½®äº†å¾ˆé•¿æ—¶é—´çš„ç¼“å­˜ï¼Œæˆ–è€…ä¸¤è€…å…¼æœ‰ï¼Œå¦‚æœèµ„æºæ›´æ–°äº†ä½†æ²¡æœ‰æ›´æ–°ç‰ˆæœ¬å·ï¼Œæµè§ˆå™¨ç«¯æ˜¯æ‹¿ä¸åˆ°æœ€æ–°å†…å®¹çš„ï¼Œæ‰‹åŠ¨åŠ ç‰ˆæœ¬å·çš„è¿‡ç¨‹å¾ˆç¹çå¹¶ä¸”å®¹æ˜“å‡ºé”™ï¼Œä¸ºæ­¤è‡ªåŠ¨åŒ–è¿™ä¸ªè¿‡ç¨‹å°±æ˜¾å¾—éå¸¸æœ‰ä»·å€¼ï¼Œé€šå¸¸çš„åšæ³•æ˜¯åˆ©ç”¨æ–‡ä»¶å†…å®¹åšå“ˆå¸Œï¼Œæ¯”å¦‚ md5ï¼Œç„¶åä»¥è¿™ä¸ªå“ˆå¸Œå€¼ä½œä¸ºç‰ˆæœ¬å·ï¼Œç‰ˆæœ¬å·é™„ç€åœ¨æ–‡ä»¶åé‡Œé¢ï¼Œçº¿ä¸Šç¯å¢ƒçš„èµ„æºå¼•ç”¨å…¨éƒ¨æ˜¯å¸¦ç‰ˆæœ¬å·çš„ã€‚</p> <p>ä¸ºäº†å®ç°è¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥ä¸¤ä¸ªå°å·¥å…·ï¼š</p> <ul><li><a href="https://github.com/keithamus/hashmark" target="_blank" rel="noopener noreferrer">hashmark<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œè‡ªåŠ¨æ·»åŠ ç‰ˆæœ¬å·ï¼›</li> <li><a href="https://github.com/songkick/replaceinfiles" target="_blank" rel="noopener noreferrer">replaceinfiles<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œè‡ªåŠ¨å®Œæˆå¼•ç”¨æ›¿æ¢ï¼Œå®ƒéœ€è¦å°†ç‰ˆæœ¬å·è¿‡ç¨‹çš„è¾“å‡ºä½œä¸ºè¾“å…¥ï¼›</li></ul> <p>é¦–å…ˆå®‰è£…ä¾èµ–ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>npm i hashmark replaceinfiles -D
# npm install hashmark replaceinfiles --save-dev
# yarn add hashmark replaceinfiles -D

</code></pre></div><p>ç„¶ååœ¨ <code>scripts/build/hash.sh</code> ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code># ç»™å›¾ç‰‡èµ„æºåŠ ä¸Šç‰ˆæœ¬å·ï¼Œå¹¶ä¸”æ›¿æ¢å¼•ç”¨
hashmark -c dist -r -l 8 '**/*.{png,jpg}' '{dir}/{name}.{hash}{ext}' | replaceinfiles -S -s 'dist/**/*.css' -d '{dir}/{base}'

# ç»™ jsã€css èµ„æºåŠ ä¸Šç‰ˆæœ¬å·ï¼Œå¹¶ä¸”æ›¿æ¢å¼•ç”¨
hashmark -c dist -r -l 8 '**/*.{css,js}' '{dir}/{name}.{hash}{ext}' | replaceinfiles -S -s 'client/index.html' -d 'dist/index.html'

</code></pre></div><p>ç„¶ååœ¨ <code>package.json</code> ä¸­æ·»åŠ  <code>build:hash</code> å‘½ä»¤ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>+    &quot;build:hash&quot;: &quot;scripty&quot;,

</code></pre></div><p>è¿™ä¸ªæ­¥éª¤éœ€è¦ä¾èµ–å‰å‡ ä¸ªæ­¥éª¤ï¼Œä¸èƒ½å•ç‹¬è¿è¡Œï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦å¢åŠ å®Œæ•´çš„ <code>build</code> å‘½ä»¤æŠŠä¸Šé¢å‡ ä¸ªæ­¥éª¤ä¸²èµ·æ¥ã€‚</p> <h3 id="å®Œæ•´çš„æ„å»ºæ­¥éª¤"><a href="#å®Œæ•´çš„æ„å»ºæ­¥éª¤" class="header-anchor">#</a> å®Œæ•´çš„æ„å»ºæ­¥éª¤</h3> <p>æœ€åæˆ‘ä»¬åœ¨ <code>package.json</code> ä¸­æ·»åŠ  <code>build</code> å‘½ä»¤æŠŠæ‰€æœ‰çš„æ­¥éª¤ä¸²èµ·æ¥ï¼Œå®Œæ•´çš„ <code>diff</code> å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>-    &quot;client:static-server&quot;: &quot;http-server client/&quot;
+    &quot;client:static-server&quot;: &quot;http-server client/&quot;,
+    &quot;prebuild&quot;: &quot;rm -rf dist &amp;&amp; mkdir -p dist/{images,styles,scripts}&quot;,
+    &quot;build&quot;: &quot;scripty&quot;,
+    &quot;build:images&quot;: &quot;scripty&quot;,
+    &quot;build:scripts&quot;: &quot;scripty&quot;,
+    &quot;build:styles&quot;: &quot;scripty&quot;,
+    &quot;build:hash&quot;: &quot;scripty&quot;

</code></pre></div><p>å…¶ä¸­ <code>scripts/build.sh</code> çš„å†…å®¹å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>for step in 'images' 'scripts' 'styles' 'hash'
do
  npm run build:$step
done

</code></pre></div><p>ç„¶åæˆ‘ä»¬å°è¯•è¿è¡Œ <code>npm run build</code>ï¼Œå®Œæ•´çš„è¿‡ç¨‹è¾“å‡ºå¦‚ä¸‹ï¼š</p> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/31.png" alt=""></p> <p>æ„å»ºå®Œæˆçš„ <code>dist</code> ç›®å½•å†…å®¹å¦‚ä¸‹ï¼š</p> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/32.png" alt=""></p> <p>å¯ä»¥çœ‹åˆ°ï¼Œæ‰€æœ‰çš„é™æ€èµ„æºéƒ½åŠ ä¸Šäº†ç‰ˆæœ¬å·ã€‚</p> <p>æ„å»ºå®Œæˆçš„ <code>dist/index.html</code> å†…å®¹å¦‚ä¸‹ï¼š</p> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/33.png" alt=""></p> <blockquote><p>å¯ä»¥çœ‹åˆ°ï¼Œé™æ€èµ„æºçš„ç‰ˆæœ¬å·è¢«æ­£ç¡®æ›¿æ¢äº†ï¼Œä¸ºäº†éªŒè¯æ„å»ºå‡ºæ¥çš„é¡µé¢æ˜¯å¦æ­£å¸¸è¿è¡Œï¼Œå¯ä»¥è¿è¡Œ <code>./node_modules/.bin/http-server dist</code>ï¼Œç„¶åæµè§ˆå™¨æ‰“å¼€ï¼š<code>http://127.0.0.1:8080</code></p></blockquote> <blockquote><p>æœ¬èŠ‚ç”¨åˆ°çš„ä»£ç è§ <a href="https://github.com/wangshijun/automated-workflow-with-npm-script/tree/12-use-npm-script-as-build-pipeline" target="_blank" rel="noopener noreferrer">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œæƒ³è¾¹çœ‹è¾¹åŠ¨æ‰‹ç»ƒä¹ çš„åŒå­¦å¯ä»¥æ‹‰ä¸‹æ¥è‡ªå·±æ”¹ï¼Œæ³¨æ„åˆ‡æ¢åˆ°æ­£ç¡®çš„åˆ†æ”¯ <code>12-use-npm-script-as-build-pipeline</code>ã€‚</p></blockquote> <h2 id="_14-å®æˆ˜5-ç”¨-npm-script-å®ç°æœåŠ¡è‡ªåŠ¨åŒ–è¿ç»´"><a href="#_14-å®æˆ˜5-ç”¨-npm-script-å®ç°æœåŠ¡è‡ªåŠ¨åŒ–è¿ç»´" class="header-anchor">#</a> 14 å®æˆ˜5 ç”¨ npm script å®ç°æœåŠ¡è‡ªåŠ¨åŒ–è¿ç»´</h2> <p>éœ€è¦äº‹å…ˆè¯´æ˜çš„æ˜¯ï¼Œæœ¬èŠ‚éƒ¨åˆ†å†…å®¹æ¶‰åŠåˆ°éå‰ç«¯çš„è¯é¢˜ï¼Œæ¯”å¦‚æœåŠ¡çš„éƒ¨ç½²ã€æ—¥å¿—ï¼Œä½†ä¼šä»å‰ç«¯é¡¹ç›®ç®¡ç†å¼€å§‹ï¼Œæ¯”å¦‚ä¾èµ–ç®¡ç†ã€ç‰ˆæœ¬ç®¡ç†ç­‰ã€‚å³ä½¿å¯¹è‡ªå·±å®šä½æ˜¯çº¯ç²¹å‰ç«¯å¼€å‘çš„åŒå­¦ï¼Œä¹Ÿå»ºè®®é˜…è¯»ä¸‹ï¼Œå› ä¸ºæŠ€ä¸å‹èº«ï¼Œäº†è§£æ•´ä¸ªå‰ç«¯é¡¹ç›®äº¤ä»˜æµç¨‹ä¸­éœ€è¦è€ƒé‡çš„ç‚¹èƒ½è®©æˆ‘ä»¬æ›´æœ‰å¤§å±€è§‚ã€‚</p> <p>é€šå¸¸æ¥è¯´ï¼Œé¡¹ç›®æ„å»ºå®Œæˆä¹‹åï¼Œå°±æˆä¸ºå¾…å‘å¸ƒçš„ç‰ˆæœ¬ï¼Œå› æ­¤ç‰ˆæœ¬ç®¡ç†éœ€è¦è€ƒè™‘ï¼Œç”šè‡³åšæˆè‡ªåŠ¨åŒ–çš„ï¼Œç„¶åï¼Œæœ€æ–°çš„ä»£ç éœ€è¦éƒ¨ç½²åˆ°çº¿ä¸Šæœºå™¨æ‰èƒ½è®©æ‰€æœ‰ç”¨æˆ·è®¿é—®åˆ°ï¼Œéƒ¨ç½²ç¯èŠ‚æ¶‰åŠåˆ°æœåŠ¡çš„å¯åŠ¨ã€é‡å¯ã€æ—¥å¿—ç®¡ç†ç­‰éœ€è¦è€ƒè™‘ã€‚</p> <p>ä¸‹é¢æˆ‘ä»¬ä»‹ç» npm script åœ¨æœåŠ¡è¿ç»´æ—¶çš„å‡ ä¸ªç”¨é€”ï¼š</p> <h3 id="ä½¿ç”¨-npm-script-è¿›è¡Œç‰ˆæœ¬ç®¡ç†"><a href="#ä½¿ç”¨-npm-script-è¿›è¡Œç‰ˆæœ¬ç®¡ç†" class="header-anchor">#</a> ä½¿ç”¨ npm script è¿›è¡Œç‰ˆæœ¬ç®¡ç†</h3> <p>æ¯æ¬¡æ„å»ºå®Œçš„ä»£ç éƒ½åº”è¯¥æœ‰æ–°çš„ç‰ˆæœ¬å·ï¼Œä¿®æ”¹ç‰ˆæœ¬å·ç›´æ¥ä½¿ç”¨ npm å†…ç½®çš„ version è‡ªå‘½ä»¤å³å¯ï¼Œå¦‚æœæ˜¯ç®€å•ç²—æš´çš„ç‰ˆæœ¬ç®¡ç†ï¼Œå¯ä»¥åœ¨ <code>package.json</code> ä¸­æ·»åŠ å¦‚ä¸‹ <code>scripts</code>ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>+    &quot;release:patch&quot;: &quot;npm version patch &amp;&amp; git push &amp;&amp; git push --tags&quot;,
+    &quot;release:minor&quot;: &quot;npm version minor &amp;&amp; git push &amp;&amp; git push --tags&quot;,
+    &quot;release:major&quot;: &quot;npm version major &amp;&amp; git push &amp;&amp; git push --tags&quot;,
     &quot;precommit&quot;: &quot;lint-staged&quot;,

</code></pre></div><p>è¿™ 3 æ¡å‘½ä»¤éµå¾ª <a href="https://semver.org" target="_blank" rel="noopener noreferrer">semver<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> çš„ç‰ˆæœ¬å·è§„èŒƒæ¥æ–¹ä¾¿ä½ ç®¡ç†ç‰ˆæœ¬ï¼Œ<code>patch</code> æ˜¯æ›´æ–°è¡¥ä¸ç‰ˆæœ¬ï¼Œ<code>minor</code>æ˜¯æ›´æ–°å°ç‰ˆæœ¬ï¼Œmajor æ˜¯æ›´æ–°å¤§ç‰ˆæœ¬ã€‚åœ¨å¿…è¦çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡è¿è¡Œ <code>npm run version:patch</code> æ¥å‡è¡¥ä¸ç‰ˆæœ¬ï¼Œè¿è¡Œè¾“å‡ºå¦‚ä¸‹ï¼š</p> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/34.png" alt=""></p> <blockquote><p>å¦‚æœè¦æ±‚æ‰€æœ‰çš„ç‰ˆæœ¬å·ä¸è¶…è¿‡ <code>10</code>ï¼Œå³ <code>0.0.9</code> çš„ä¸‹ä¸ªç‰ˆæœ¬æ˜¯ <code>0.1.0</code> è€Œä¸æ˜¯ <code>0.0.10</code>ï¼Œå¯ä»¥ç¼–å†™ç®€å•çš„ shell è„šæœ¬æ¥å®ç°ï¼ˆ<strong>æ³¨æ„è¿™æ ·ä¼šç ´å semver çš„çº¦å®š</strong>ï¼‰ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p></blockquote> <p>é¦–å…ˆï¼Œåœ¨ <code>scripts</code> ç›®å½•ä¸‹æ–°å¢ <code>bump.sh</code>ï¼ˆ<strong>åˆ«å¿˜äº†æ–‡ä»¶çš„å¯æ‰§è¡Œæƒé™</strong>ï¼š<code>chmod a+x scripts/bump.sh</code>ï¼‰ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>#!/usr/bin/env bash

# get major/minor/patch version to change
version=`cat package.json| grep version | grep -v release | awk -F\&quot; '{print $4}'`
components=($(echo $version | tr '.' '\n'))
major=${components[0]}
minor=${components[1]}
patch=${components[2]}

release='patch';

# decide which version to increment
if [ $patch -ge 9 ]; then
    if [ $minor -ge 9 ]; then
        release='major'
    else
        release='minor'
    fi
else
    release='patch'
fi

echo &quot;major=$major, minor=$minor, patch=$patch, release=$release&quot;

# upgrade version
npm run release:$release

</code></pre></div><p>ç„¶åï¼Œåœ¨ <code>package.json</code> ä¸­æ–°å¢ <code>bump</code> å­å‘½ä»¤ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>     &quot;release:major&quot;: &quot;npm version major &amp;&amp; git push &amp;&amp; git push --tags&quot;,
+    &quot;bump&quot;: &quot;scripty&quot;,
     &quot;precommit&quot;: &quot;lint-staged&quot;,

</code></pre></div><p>åœ¨å¿…è¦çš„æ—¶å€™æ‰§è¡Œ <code>npm run bump</code>ï¼Œè¾“å‡ºç¤ºä¾‹å¦‚ä¸‹ï¼š</p> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/35.png" alt=""></p> <h3 id="ä½¿ç”¨-npm-script-è¿›è¡ŒæœåŠ¡è¿›ç¨‹å’Œæ—¥å¿—ç®¡ç†"><a href="#ä½¿ç”¨-npm-script-è¿›è¡ŒæœåŠ¡è¿›ç¨‹å’Œæ—¥å¿—ç®¡ç†" class="header-anchor">#</a> ä½¿ç”¨ npm script è¿›è¡ŒæœåŠ¡è¿›ç¨‹å’Œæ—¥å¿—ç®¡ç†</h3> <p>åœ¨ç”Ÿäº§ç¯å¢ƒçš„æœåŠ¡è¿›ç¨‹å’Œæ—¥å¿—ç®¡ç†é¢†åŸŸï¼Œ<a href="http://pm2.keymetrics.io" target="_blank" rel="noopener noreferrer">pm2<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æ˜¯å½“ä¹‹æ— æ„§çš„é¦–é€‰ï¼ŒåŠŸèƒ½å¾ˆå¼ºå¤§ï¼Œä½¿ç”¨ç®€å•ï¼Œå¼€å‘ç¯å¢ƒå¸¸ç”¨çš„æ˜¯ <a href="https://www.npmjs.com/package/nodemon" target="_blank" rel="noopener noreferrer">nodemon<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p> <p>åœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­ä½¿ç”¨ <code>npm script</code> è¿›è¡ŒæœåŠ¡è¿›ç¨‹å’Œæ—¥å¿—ç®¡ç†çš„åŸºæœ¬æ­¥éª¤å¦‚ä¸‹ï¼š</p> <p><strong>1. å‡†å¤‡ http æœåŠ¡</strong></p> <p>åœ¨ä½¿ç”¨ <code>npm script</code> ä½œä¸ºæ„å»ºæµæ°´çº¿çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬åœ¨é¡¹ç›®ä¸­å¼•å…¥äº† <a href="https://www.npmjs.com/package/express" target="_blank" rel="noopener noreferrer">express<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> å’Œ <a href="https://www.npmjs.com/package/morgan" target="_blank" rel="noopener noreferrer">morgan<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œå¹¶ä½¿ç”¨å¦‚ä¸‹è„šæœ¬å¯åŠ¨ http æœåŠ¡å™¨æ–¹ä¾¿ç”¨æˆ·è®¿é—®æˆ‘ä»¬çš„ç½‘é¡µï¼ˆmorgan ä½¿ç”¨æ¥è®°å½•ç”¨æˆ·çš„è®¿é—®æ—¥å¿—çš„ï¼‰ï¼š</p> <p>å…ˆå®‰è£…ä¾èµ–ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>npm i express morgan -D
# npm install express morgan --save-dev
# yarn add express morgan -D

</code></pre></div><p>ç„¶ååœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶ server.jsï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>const express = require('express');
const morgan = require('morgan');

const app = express();
const port = process.env.PORT || 8080;

app.use(express.static('./dist'));
app.use(morgan('combined'));

app.listen(port, err =&gt; {
  if (err) {
    console.error('server start error', err); // eslint-disable-line
    process.exit(1);
  }

  console.log(`server started at port ${port}`);  // eslint-disable-line
});

</code></pre></div><p><strong>2. å‡†å¤‡æ—¥å¿—ç›®å½•</strong></p> <p>ä¸ºç®€å•èµ·è§ï¼Œæˆ‘ä»¬é¡¹ç›®ä¸­åˆ›å»ºæ—¥å¿—å­˜å‚¨ç›®å½• <code>logs</code>ï¼Œæœ‰äº›å…¬å¸å¯èƒ½ä¸ä¼šæŠŠæ—¥å¿—å­˜åœ¨é¡¹ç›®éƒ¨ç½²ç›®å½•ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>mkdir logs
touch logs/.gitkeep
git add logs/.gitkeep
git commit -m 'add logs folder'

</code></pre></div><p>å¹¶ä¸”è®¾ç½®è¯¥ç›®å½•ä¸º git å¿½ç•¥çš„ï¼Œå†æ”¹åŠ¨ .gitignoreï¼š</p> <div class="language- extra-class"><pre class="language-text"><code> dist
+logs

</code></pre></div><blockquote><p><strong>TIP#21</strong>ï¼šè¿™é‡ŒåŠ  <code>logs/.gitkeep</code> ç©ºæ–‡ä»¶çš„ç›®çš„æ˜¯ä¸ºäº†èƒ½æŠŠ <code>logs</code> ç›®å½•æäº¤åˆ° <code>git</code> é‡Œé¢ï¼Œä½†æ˜¯æˆ‘ä»¬æ•…æ„å¿½ç•¥ <code>logs</code> ç›®å½•é‡Œé¢çš„å†…å®¹ï¼Œè¿™æ˜¯åœ¨ <code>git</code> ä¸­æäº¤ç›®å½•ç»“æ„è€Œå¿½ç•¥å…¶ä¸­å†…å®¹çš„å¸¸è§åšæ³•ã€‚</p></blockquote> <p><strong>3. å®‰è£…å’Œé…ç½® pm2</strong></p> <p>å®‰è£… <code>pm2</code> ä½œä¸ºä¾èµ–ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>npm i pm2 -D
# npm install pm2 --save-dev
# yarn add pm2 -D

</code></pre></div><p>ç„¶åæ·»åŠ æœåŠ¡å¯åŠ¨é…ç½®åˆ°é¡¹ç›®æ ¹ç›®å½•ä¸‹ <code>pm2.json</code>ï¼Œæ›´å¤šé…ç½®é¡¹å¯ä»¥å‚ç…§<a href="http://pm2.keymetrics.io/docs/usage/application-declaration" target="_blank" rel="noopener noreferrer">æ–‡æ¡£<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;apps&quot;: [
    {
      &quot;name&quot;: &quot;npm-script-workflow&quot;,
      &quot;script&quot;: &quot;./server.js&quot;,
      &quot;out_file&quot;: &quot;./logs/stdout.log&quot;,
      &quot;error_file&quot;: &quot;./logs/stderr.log&quot;,
      &quot;log_date_format&quot;: &quot;YYYY-MM-DD HH:mm:ss&quot;,
      &quot;instances&quot;: 0,
      &quot;exec_mode&quot;: &quot;cluster&quot;,
      &quot;max_memory_restart&quot;: &quot;800M&quot;,
      &quot;merge_logs&quot;: true,
      &quot;env&quot;: {
        &quot;NODE_ENV&quot;: &quot;production&quot;,
        &quot;PORT&quot;: 8080,
      }
    }
  ]
}

</code></pre></div><p>ä¸Šé¢çš„é…ç½®æŒ‡å®šäº†æœåŠ¡è„šæœ¬ä¸º <code>server.js</code>ï¼Œæ—¥å¿—è¾“å‡ºæ–‡ä»¶è·¯å¾„ï¼Œæ—¥å¿—æ—¶é—´æ ¼å¼ï¼Œè¿›ç¨‹æ•°é‡ = CPU æ ¸æ•°ï¼Œå¯åŠ¨æ–¹å¼ä¸º clusterï¼Œä»¥åŠä¸¤ä¸ªç¯å¢ƒå˜é‡ã€‚</p> <p><strong>4. é…ç½®æœåŠ¡éƒ¨ç½²å‘½ä»¤</strong></p> <p>åœ¨æ²¡æœ‰é›†æˆ CI æœåŠ¡ä¹‹å‰ï¼Œæˆ‘ä»¬çš„éƒ¨ç½²å‘½ä»¤åº”è¯¥æ˜¯ä¸‹é¢è¿™æ ·çš„ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>     &quot;release:major&quot;: &quot;npm version major &amp;&amp; git push &amp;&amp; git push --tags&quot;,
+    &quot;predeploy&quot;: &quot;yarn &amp;&amp; npm run build&quot;,
+    &quot;deploy&quot;: &quot;pm2 restart pm2.json&quot;,
     &quot;bump&quot;: &quot;scripty&quot;,

</code></pre></div><p>å³åœ¨éƒ¨ç½²å‰éœ€è¦å®‰è£…æœ€æ–°çš„ä¾èµ–ï¼Œé‡æ–°æ„å»ºï¼Œç„¶åä½¿ç”¨ <code>pm2</code> é‡æ–°å¯åŠ¨æœåŠ¡å³å¯ï¼Œå¦‚æœä½ æœ‰å¤šå°æœºå™¨è·‘é€š1ä¸ªæœåŠ¡ï¼Œå»ºè®®æœ‰ä¸ªé›†ä¸­çš„ CI æœåŠ¡å™¨ä¸“é—¨è´Ÿè´£æ„å»ºï¼Œè€Œéƒ¨ç½²æ—¶å°±ä¸éœ€è¦è¿è¡Œ <code>build</code> äº†ã€‚</p> <p>æ¯æ¬¡éœ€è¦éƒ¨ç½²æœåŠ¡æ—¶åªéœ€è¦è¿è¡Œ <code>npm run deploy</code> å°±è¡Œäº†ï¼Œè¿è¡ŒæˆåŠŸè¾“å‡ºå¦‚ä¸‹ï¼š</p> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/36.png" alt=""></p> <p><strong>5. é…ç½®æ—¥å¿—æŸ¥çœ‹å‘½ä»¤</strong></p> <p>è‡³äºæ—¥å¿—ï¼Œè™½ç„¶ <code>pm2</code> æä¾›äº†å†…ç½®çš„ <code>logs</code> ç®¡ç†å‘½ä»¤ï¼Œå¦‚æœæŸå°æœåŠ¡å™¨ä¸Šå¯åŠ¨äº†å¤šä¸ªä¸åŒçš„æœåŠ¡è¿›ç¨‹ï¼Œé‚£ä¹ˆ <code>pm2 logs</code> ä¼šå±•ç¤ºæ‰€æœ‰æœåŠ¡çš„æ—¥å¿—ï¼Œä¸ªäººå»ºè®®ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹å½“å‰æœåŠ¡çš„æ—¥å¿—ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>+    &quot;logs&quot;: &quot;tail -f logs/*&quot;,
     &quot;bump&quot;: &quot;scripty&quot;,

</code></pre></div><p>éœ€è¦æŸ¥çœ‹æ—¥å¿—æ—¶ï¼Œç›´æ¥è¿è¡Œ <code>npm run logs</code>ï¼Œè¿è¡Œè¾“å…¥å¦‚ä¸‹ï¼š</p> <p><img src="https://poetries1.gitee.io/img-repo/2020/07/npm/37.png" alt=""></p> <p>å½“ç„¶å¦‚æœä½ æœ‰æ›´å¤æ‚çš„æ—¥å¿—æŸ¥çœ‹éœ€æ±‚ï¼Œç›´æ¥ç”¨ <code>cat</code>ã€<code>grep</code> ä¹‹ç±»çš„å‘½ä»¤å¥½äº†ã€‚</p> <blockquote><p>æœ¬èŠ‚ç”¨åˆ°çš„ä»£ç è§ <a href="https://github.com/wangshijun/automated-workflow-with-npm-script/tree/13-use-npm-script-for-devops" target="_blank" rel="noopener noreferrer">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œæƒ³è¾¹çœ‹è¾¹åŠ¨æ‰‹ç»ƒä¹ çš„åŒå­¦å¯ä»¥æ‹‰ä¸‹æ¥è‡ªå·±æ”¹ï¼Œæ³¨æ„åˆ‡æ¢åˆ°æ­£ç¡®çš„åˆ†æ”¯ <code>13-use-npm-script-for-devops</code>ã€‚</p></blockquote></div> <!---->  </div> <footer class="page-edit"><!----> <!----></footer> <!---->  <div class="el-dialog__wrapper" style="display:none;"><div role="dialog" aria-modal="true" aria-label="è¯·å…ˆé˜…è¯»è´­ä¹°åè®®" class="el-dialog el-dialog--center" style="margin-top:15vh;width:30%;"><div class="el-dialog__header"><span class="el-dialog__title">è¯·å…ˆé˜…è¯»è´­ä¹°åè®®</span><button type="button" aria-label="Close" class="el-dialog__headerbtn"><i class="el-dialog__close el-icon el-icon-close"></i></button></div><!----><div class="el-dialog__footer"><span class="dialog-footer"><button disabled="disabled" type="button" class="el-button el-button--danger is-disabled" style="width:100%;"><!----><!----><span>æˆ‘å·²é˜…è¯»ï¼ˆ8sï¼‰</span></button></span></div></div></div> <div class="el-dialog__wrapper" style="display:none;"><div role="dialog" aria-modal="true" aria-label="ä»˜è´¹é˜…è¯»" class="el-dialog" style="margin-top:15vh;width:30%;"><div class="el-dialog__header"><span class="el-dialog__title">ä»˜è´¹é˜…è¯»</span><button type="button" aria-label="Close" class="el-dialog__headerbtn"><i class="el-dialog__close el-icon el-icon-close"></i></button></div><!----><div class="el-dialog__footer"><span class="dialog-footer"><button disabled="disabled" type="button" class="el-button el-button--danger is-disabled" style="width:100%;"><!----><!----><span>ç¡® å®š</span></button></span></div></div></div> <div class="el-dialog__wrapper" style="display:none;"><div role="dialog" aria-modal="true" aria-label="dialog" class="el-dialog" style="margin-top:15vh;width:30%;"><div class="el-dialog__header"><span class="el-dialog__title"></span><button type="button" aria-label="Close" class="el-dialog__headerbtn"><i class="el-dialog__close el-icon el-icon-close"></i></button></div><!----><!----></div></div> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAU9ElEQVR4Xu1da5Ac1XX+TnfPa1crrQQiMY9YGGHAD6SdEWUjIdjVPiQgNhJa4VRBAgSIXZRRodgJOPED7DiACxts4yoHu0BKVaiYnVkJAkKPfQkBDgnSSmUIhKeEISSW0AO0O6/ue1K3R/uY2Xl0z3TPY3fuH6l2zj3n3HO+vn373nPPIdSbZQtEfnb4BmbxPRAtADAkDN5wzYbT9llmUIWEVIU6VaVKmx84usBQ9XcylBvqXj+/rSoVtqhUHQAWDdXz80OtxBjMJO9eP7+mbVjTylv0nSNkOQBwsHv9fPk6qNlW9QDg4e6rIHCEQuHdlbZyz08PbSHCVWN6EOjGtetP3VhpvUqRX5UA4Dcu9+GjxhsAbADhPAhxOi3p/aCUgTrVV84EkpemawfWbJh7wCm+leJTVQDgV9ecgqiyHky3gnCqaRTGHgqFl1TKQNNdblUAgPevOw8GfxOM60DwZxj9uxQM/2C6O6JS46soAHh4dTOE+iMQbgYouy4aXUgX9vyuUgaa7nIrBgDe030jAOn81FSftfEBCkbOnu5OqOT4yg4A3rvuM4D4FUBLCw6c8SCFwhsK0tUJirZAWQHAe6++F1DusK6tuIyCvc9ap69T2rVAWQBgru5Hlc0gWm5DQYGWsIcIwkafOqlNC7gOAN67ZhGgPAXQmbZ0Y36ZQpHP2+pTJ7ZtAVcBwHuv/nOA5PveZ1sz8GMUjFxrv1+9hx0LuAIA5lYNe0/9KQi32lEmg/ZOCobvK6F/vasFCzgOgJTz524Dqe0W5OcmIb6SWiJbS+JR71zQAo4CgN9p9esfND6v+QPBgpILEajiLFrU+14hsvrvpVnAMQDIA5zE+/yKd3bjOUCpbPkYBSNzSxtavbcVC5TqKVOGfPLjB72ve2fNOosUxYrcQjT7KBhuKURU/710C5QMAH7h4kAsNusdb2PgjxSPt3SNUhy2UTB8uVPM6nzyLLVKMQ4z1Nhg50HV6znD09BQCquMvryJghEZD1BvLlugpBkgvqvrtyz4i745cxxWU9xHwd47HWZaZ5fFAkUDIL571T1GPHlnoHkO4Mx7f0I9xt9TKPyPdY+5b4GiABAb6vqSSOhPepsaofqK2OQrPK5vUjD848JkxVPw3rUylu8qgJrBvBGKsYFathwrnmNt9rQNgNHdy/4Ecf9biqJqvubZbo16PQXDP3eLOe/pvh2EB9L4MzZQKPygWzKrla9tAEQHOt5nQ5zumzMbiqa5My7G1ygU/id3mAOpp5+uz+D/BAXDq92SWS18j3bf3AoiRjJ5cO6WjQdsASC2q+uXIqF/VfV64G1qcnNM7s4Ae7uHAFyWMYBdFAybEb/TtX247qZ9AC0aGx8LXmMZAMnnu1YkR/R+2dk/bw5IUd2zE+FvqCV8v1sCeAYCQD75gqbcbNpnGQCxgc4TwjAaNb8PnsZGt3yT4sv8bQpFfuiWkJkIgMNrb1pNCm3OsOlxSwCID3U+YiQNGcSJwLxmgBzZ7s3jX/EDCvZ+tw4A5yxwdN0tiwV4eDJHZjxREAD87PJPROOe9wFQWZ7+1BTwEAUjtzk3/HROM3EGkBY4vO4vbyCmu0D0Sel8leiuggCIDXXuFknjEvPd3zwHpLr47p/wUy8Fw2udAEBiR+tiHSTjEccvcfpmN0HxeNLYi2QS8Y8+nvgb8wENvMbbNeTY/f/L73vrdgJ/D0AzM4ZIUTds/duzHeNfjL3yAiCxe+UiPZY0FZSffPLTryyN+UUKRb7ohKzRnW1bABq/0Cl5WgJAai1yoKFr0JF7CavueWeBohhp+QUkCJ65c2FF8wvkBUBssOtVoevnS1t4Gxuh+l3Z9cvm5/cpGLYXRJoDLaM7V3DmT5YBAKChc6DgLGkFqKvueaNVUWhKfoGtdyx0hL8VHbLR5BSe3L2yIxlN7hyL7QicIuMzyqirFp1HFz59tNiBjfUb2dG2j2ji29fODMDA8cbOgeZSdZD9cwDg4NY7FlY0v0BOj8YGut4Uhn6OVF7u93tnufzpl2llRaygxb1Tnhi7zhjpa11NrKR9/lidAYhxY6BrwLH7/1fc++YWTMovAIEbt35roWP87dpG0mcFQHxXxwVGwvivsZ+zGawYYbb6OLg3Hx1sXQAdE4vAufMeJEUZ3xEzX/dC7I8fPXL7uI4aDgTahhy//y9ngpQM7cC2b53tOH9bNs4FgNhg14DQdXNxIkO8/HMdmQXt6ca8kUIRc+/B6TZTPwMtrQF4sNUf1dURgM3dHk9jAJo/4LQPCvNjHqZQpPTo4iyS6gCYMMqUV0Di2ZU/1uPJvx4j8c91ed8/NxQSaAkH3LgbWAdAHgDEBjqOCkOk5nwiBOZVMDpbNT5Piza/XHi6sEdRB0AOACSfv7wrORrfPvZzGY5983uO+TYKRR6y597C1Ly3e0sqGiitTfvj4IJrgNhg13NC15eNEXoaAtACFXj/j2vKfRSMdBZ2qT0K3tN9FwhyS3ZymxEBIZmWSlsDRPvbR1nwuMd9c5qgaOl75vZMXSI1wwDTKbSk53iJnNK683B3KzKzfhLaqCUsA0VmVBsHQLyv/UKDef/E6BmBU06pvDFIXEstvY85rQgPr14AoaXuHij6RmrZUvFvcqfHaIXfBAAGOh8xjNSZv2kTTYXz8f5WVMqgYX6cQpGvFNGz3sWCBcYBEB3oeI8NccZYn/Kd/RfQknkUPmUufa4nYWE8dRKbFjABwC+FGqJH5oxM3hg2Y/69ZTv9y682G5dTaPM2m2Ork1uwgAmAxLMrb9HjyYcn05cx+MOCmvwIBSM3WSCsk9i0gAmA+K6VTxiJ5Jcn9y378W8hxUV8Pi35t8OFyOq/27OACYDYYMebQhfm0a/ZSAZ/zrPHyW1qxt0UCt/ltpiZxt8EQOb3P2kq/I7f+C3ZtEfQNHI6nftMvGROdQYTz7pM8BAdCYxOtoni1eBrKlP8nx1nsPgqhXrT1ip2utc6rRngSsr1AC8G85aAB5uobaikC60U7busjVkdmGwc1eeFd9as6rMX89sIRhYSYUqcX/Up66xGPNjaPKrTOyRvM59szLypsWuwpEQaFBvsvF/oxjcmq6v5vfA0ViEApJKML1Eo/JSz5q1+btGdra0MJS1EjsHHGjsHSzqupdhQ13aR1LvSABDww9mUL44aeEae2mUDgLRqqVHLcgYYFrqxuIYAIOP1V1EoMn5s7Si8qpSZawCIDnS+zYaRdvnB0+CHFnAy6ZPTVuX3MF/5NJ3VE3Was1V+rcObmwPMZmBplGj/UMuakhZjheS6CICO/2NDnDZZgeoHgLkY+AkFI2lrl0JGdOr3VcObFzDEMAHmgoyBYwSlZVvLGtdOFN0DQH/7xyw4bcWnVfcaIOVHGSugGYvdCBkrBJRVwxG5IZUZUHL3tpa1rm1UuQaA0Z0rkjJIvWa+AiYrytiDIH2BqMco5DQnf181HJ6SYobBT2xv6XYsxYwZrwDtejDMewRscDMLPW2tJv+ueDwTQSzMx6BgE7VEZMibpUajO1Zw5vUQ1euFt6lKPwMzh+XgBRJLFgOwcjhyOyE9yRQDG7a3rHUkyZRZTY214q/FkX621QAXynZ5suLBoFY9kXoXxKEpF5W7tNzK4fCDxGQ+8Uy8ZXtL98StIlv6TyXm4atvACuPFs3GxrkJje5s48wbYopHg292FW4F57II410wXeh07GDRDiixIw+vXQ2eks7FOlcbs6KcAeT7My3nS9WEg1kfslwU7qBQeKWdLtVMy3u6j4FQXA5eO6+AaF97gpnTQ38VQmBuSTuMFbItf5+CkczVeYV0KU1sqqqqGbRqfmoKXV8gksnM3IYybP/ulCSWyZuOQaEt1NJjOesIRfvaTzDzlLvf5o2gHNVcSxuam72ZAe6iYG+fm1Iqwdu9z8D+9sMQPCX+2zd7FhzM/18+mzGOg/UQLdnyVvmEui/JNQBE+9rfZeazMofgaWyA5s8s5O3+QJ2RwAeg8vLpVHPINQDEBjr2CENMuYat+XzwlDsriDPeP8lleoHATQBEhCGuzrR9zX0KZgXP9AGBawCIDnX+kJPG3021HyEVGVzrbXqAQKa5YV1JSzMH5l0NXYMlJbim+K6Oa4yE+E02N9fsQnDKYKYHCDJzHjKJNY0dQ5b3/bP5mLIi6ySlvBour4hPi8b8FthYWetfB9JfwsDiBhVDpQaESr+aYeHZTgTl32tyRzAfWhkfAbh2JsYU5jLLyXsBHa+zEOdOJeLUBZGa2xDKiwJ59nEvWsLfdiP/UK3NlqmrYf2djxrCyBpeLBNEulQYqrK2YgygwbiGLtj8YWUVqaz01NWwXW1XiAQ9nU2Vqr0j4Ijd+D2wsppCPXscYVeDTFLXw+XtoBOB0ax5QyudKcxtozKSINyPuYe/T2cPxdwWV238xxNEjPa3H4LgU7MpOG1fA5MHy/x7ALfMtHDzcQDEBjufErpxZTYATLuvgfxfCptBia9T8Mn/qban1Q19xgGQ3N3RmoyJnNm5qythhBumSOMps6XchcX0QLkDTl0fWYaA9DRxfR0nmEXWvPC1fzhUjGn5VRDuo5bIpmJ610KfNADEdnVtEQk9M4NmahwyaYSMEppWewKWXSRfBz+DoF9Ol7jDsZGnASAxdNlFelL9j1xm8QQC0KbL1rBl36cRngD4kdStpN6DxbGorl5TsoVH+zqOM4scIcEyefScMtQNrC4jZdWGeTcIYajiX2nR5j9Uu8b8yrp5iOmLKbQ5LRfEFADEBzo2GYb4i1wDmplrgbzuFQA/B0YPNPF4NYGB9375dMAry+9dDcZyKPgatYR/PXk0UwDA25eeFlX8/5uvQpSsICIridRbNgvwswAiUNBPiyOvlNNGvH/NadDVS0AsE34vB+iicfmMwxQKz8/UJ2vNoOhg57+zbnwhl/LTe3vYUZfJyiv7wPSfIAxDNfY6cZmVX143C0kshOBPQcGnwCxD+pYC9Mmc2ueox5y9aFRf+2cMFq/kKxPnb54NUtPulDpquWnLjBEDZFJuOg5CDMwxEKIATfyfKQ7CLMAM128EqBEydJ9oLpjPAZG9LN5Spp/OoM/2HLE0A0iiWH/ny0IYn83liKrNJDZtkVPCwJh/QaHI17NxyFk3MLq7o5Xz7AxKZhWvJ1CCTWZQVwGVFtKinvR4wpMGyFsKNNrf8QYLsTCXsVIl5eT1tTJWFJ1BnnNmqByhYKQ7pw/zCUnsbgvpUXopn3/rC0Jn3OQKF2YdmvI5WtTz30UBQHaKDna9wLp+cT4Fqyq1vCuWrFmm/0DB8HfyaV9w7rayLyAF1PcGqgwkzG9TKDKRADyHegUBYH4RDLb/Suh8c14kqSrkp2F9PVAlQLBYBMsSAE6Wk/0Q4LzJA6umzEyV+KByavBjFIxca0W+JQBIRqN9rd1gpacQU+/sWVA93kJk9d9dswAfQ0AstBrtbBkA5qugf0VECEy5SJo2FoKZX0jR6ruErvk4L2O+iYKRR6zKtgWA1KtAeRfAlEOFTBDIghOkqlb1qNM5YQHm31Ao8md2WNkCgGQc39VxgZEw5DlB/r5E8M+R5wV1ENhxSNG0zMOYPXqx3YoqtgFgrgcGO+6ELu4pqGwdBAVN5BDBIQixiJb0fmCXX1EAkEKi/Sv6WKC9oEATBE31k8OChiqSQOZMVmkpLe7JGcqX9/O9SLFmscnYseZhZv50YR4Ef3MdBIXtVAQF820UijxURE+zS9EzgOws69hEhfI7CJxZUIH666CgiWwTFLHoy5RREgBMEMgQMq3hNQhROJ8MEXxNjbWZfs62d9ztYCQTL6pJdNIlT35ciqSSAWAuCrdfehapnteY8+8UjimaCiyVm4qOiC9l/LXXl4FkLPqah/RltHT7lAgfuwNyzAOxXZeey7pnDwtusqKE/Dz0zW6qB5daMdZJGhYCydGRd71GPERtQ46U0XUMABOvg8B+CP5jq+OSdQlkfYJ6y28BI5FEcnT0iF/TzqdLnznklL0cBYAJgueWNcXi/t+y4JzxhJnKyzL13qb6KyGrU1kgcWIUwjA+9FPyfKee/DFZjgNgjHG0r2OQWVjOYSfDy+S6oH6QNAEDoSeR+HgEikd73XfptvOceuon83ENAMyg6ED74xCcMx4t24DkIZJMSDGzt5AZyZFR6NE4tAbfv3gveeY6N5wveboGgDGFYwPt64WOn4DY1qGAGWvY0ADMsBtIRjyO5GgUzGxoAc/N3mXbNrrl/LIAQAqJ7bj0XKF4BsF8ht3BmCXsAoGCZ092+VYbvZFMIDkSBRsGSFMPKz5a7lu64zW39XR9BhgbAL8U8sQ+mvsoG8a1ticeuT5oCEDuH0y3ZiTkEx8zHS+b6vf2+pZvkxc6y9LKBoCx0cQH2q4SQn2MWdivTaso0Lxes44BqTV8OZUF9HjCnOohi5yksrIeU31qt2fptv6yeP6kkLIDQMqVgSUJ8vyzkTTWFTtYuUiUMYiaz1sz+QrkRo4+GoUej08aNrPi8f7a37r9r4q1RSn9KgKAMYUTz3cuFnH0CMPIefuo8ODYPFuQYDA/ISs6oqnayk85I6FDJBMQ+uQCpwzyaC/5VV5Ly/tklFVFWlWYKz60ap1hJB6GSFXIKqXJz0jF44HqUaFonjIvHhkiqZuOFskkjKSeKi2d0RSP9nvVo13nWbZV5hKoaKsKAIxZIDbQtV6w8Z1cCSuLsZR8VaiaCsXrMQNVSbH1NZpHJMvdObB0tq6bzh5byOXqRKp2SPVpd3iXbS2+KmgxRsjTp6oAMKZnfLDrK8x0nzCSuRMelGQIAilkzg4kQxvH/5X/VfLMGpxyuHS8EJY1UDR1P0Hc5WvrL6m4g2WBNgirEgDja4QXr1giRo17ha4vB7imToyIKK54tIiXlNudPLyx4VtLpFUNgMkjiO1u/1MY2jfkRVVmrsoNAVLUjxRVeUFV+Rfa8h1PWfJAhYlqBgBjdpJnDImhrquY+FaRFMsKXVdz2b5Mmvo+KbQVuv4jf/tAzRWrrDkAZDpUbjMzeS+GSlcCfBELcSYY6bWQHUIBESVIUQ4pqvqaIPG0L4qHaeWOEYfYV4RNzQMgm9VknGJc84dIURaBcYEgkpm0PsECTTI2Fcw+BlQwT76/ppNCMXmISQqNEHACjD8A/CYxDXlZ7KCO/mlXXeT/AQOtWhTnoNDfAAAAAElFTkSuQmCC" class="theme-float-btn"></main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.f60bfc341.js" defer></script><script src="/assets/js/6.7f8a8777.js" defer></script><script src="/assets/js/3.9d86cf58.js" defer></script><script src="/assets/js/17.59c81a6b.js" defer></script><script src="/assets/js/11.fb060006.js" defer></script>
  </body>
</html>
